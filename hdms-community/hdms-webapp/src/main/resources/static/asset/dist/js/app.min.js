/*! Hdms - v0.1.0 - 2019-03-28 Copyright www.honvay.com */
var app=angular.module("app",["ngAnimate","ngResource","ui.router","ui.bootstrap","ui.validate","pascalprecht.translate","messager","toaster","hc.util","hc.ui","hc.common","ui.codemirror"]);app.config(["$controllerProvider","$compileProvider","$filterProvider","$provide",function(t,e,n,r){app.controller=t.register,app.directive=e.directive,app.filter=n.register,app.factory=r.factory,app.service=r.service,app.constant=r.constant,app.value=r.value}]),window.require&&function(t){"function"==typeof define&&define.amd?(require.config({paths:{app:"/asset/src/app"},urlArgs:"_dc="+(new Date).getTime()}),define(["app/app.config","app/services/fileSystem","app/services/webUploader","app/services/dropbox","app/services/fileOperation","app/controllers/app","app/controllers/directory","app/controllers/document","app/controllers/authorize","app/controllers/favorites","app/controllers/recents","app/controllers/recycle","app/controllers/share","app/controllers/changePassword","app/controllers/selectUser","app/controllers/profile","app/controllers/dropbox","app/controllers/messages","app/controllers/search"],t)):t()}(function(){}),app.config(["$translateProvider",function(t){t.useStaticFilesLoader({prefix:"asset/l10n/",suffix:".json"}),t.preferredLanguage("zh_CN")}]).factory("responseObserver",["$q","$window",function(t,e){return{responseError:function(n){switch(n.status){case 401:e.location.href="/login"}return t.reject(n)}}}]).config(["$httpProvider",function(t){t.interceptors.push("responseObserver");var e={"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"};e[crsf.headerName]=crsf.token,t.defaults.headers.post=e,t.defaults.headers.get={"X-Requested-With":"XMLHttpRequest"}}]),app.run(["$rootScope","$state","$stateParams","$http","Messager",function(t,e,n,r,s){t.$state=e,t.$stateParams=n}]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(t,e,n){n.html5Mode(!0),e.otherwise("/index/directory/enterprise"),e.when("/index/document/{document}",["$state","$match","$rootScope",function(t,e,n){n.fid=e.document}]),t.state("favorites",{url:"/index/favorites",templateUrl:"asset/tpl/app/favorites.html",controller:"FavoritesCtrl"}).state("recycle",{url:"/index/recycle",templateUrl:"asset/tpl/app/recycle.html",controller:"RecycleCtrl"}).state("recent",{url:"/index/recent",templateUrl:"asset/tpl/app/recent.html",controller:"RecentsCtrl"}).state("share",{url:"/index/share",templateUrl:"asset/tpl/app/shares.html",controller:"ShareCtrl"}).state("search",{url:"/index/search/{keyword}",templateUrl:"asset/tpl/app/search.html",controller:"SearchCtrl"}).state("directory",{url:"/index/directory/{directory}",templateUrl:"asset/tpl/app/directory.html",controller:"DirectoryCtrl"}).state("file",{url:"/index/directory/{directory}/{file}"}).state("changePassword",{url:"/index/changePassword",templateUrl:"asset/tpl/app/change_password.html",controller:"ChangePasswordCtrl"}).state("profile",{url:"/index/profile",templateUrl:"asset/tpl/app/profile.html",controller:"ProfileCtrl"}).state("messages",{url:"/index/messages",templateUrl:"asset/tpl/app/messages.html",controller:"MessagesCtrl"})}]),app.controller("AppCtrl",["$rootScope","$scope","toaster","FileSystem","Messager","$http","$modal","$location","$state","environment","WebUploader","Dropbox","FileOperation",function(t,e,n,r,s,i,o,l,a,c,d,p,u){e.ie9=/msie 9/.test(window.navigator.userAgent.toLowerCase()),e.supportWebkitDirectory="webkitdirectory"in HTMLInputElement.prototype,e.showQueue=!1,t.toaster=n,t.files=[],t.permissions=c.permissions,t.space=c.space,t.resourceServerUrl="/",t.staticResourceServerUrl="/",t.openDetail=!0,t.appSetting=c.appSetting,t.toggleDetail=function(){t.openDetail=!t.openDetail,t.$apply()},d.init(t),p.init(e),u.init(e),t.user=c.user,t.organization=c.user.organization,t.space=c.space,t.space.quotaPrecent=t.space.used/t.space.quota,t.mounts=c.mounts,t.mountAliases={};for(var g in e.mounts){var m=e.mounts[g];t.mountAliases[m.id]=m.alias}if(e.$on("$stateChangeStart",function(n,r,s,i){t.module=r.name,!0===e.user.changePassword&&"changePassword"!==r.name&&(n.preventDefault(),a.go("changePassword"))}),t.mediaType={avi:{icon:"asset/img/file/file_video.png",type:"video"},bmp:{icon:"asset/img/file/file_pic.png",type:"image"},png:{icon:"asset/img/file/file_pic.png",type:"image"},jpg:{icon:"asset/img/file/file_pic.png",type:"image"},gif:{icon:"asset/img/file/file_pic.png",type:"image"},csv:{icon:"asset/img/file/file_csv.png",type:"office"},doc:{icon:"asset/img/file/file_word.png",type:"office"},docx:{icon:"asset/img/file/file_word.png",type:"office"},xls:{icon:"asset/img/file/file_excel.png",type:"office"},xlsx:{icon:"asset/img/file/file_excel.png",type:"office"},ppt:{icon:"asset/img/file/file_ppt.png",type:"office"},pptx:{icon:"asset/img/file/file_ppt.png",type:"office"},pdf:{icon:"asset/img/file/file_pdf.png",type:"pdf"},exe:{icon:"asset/img/file/file_exe.png",type:"unknown"},html:{icon:"asset/img/file/file_code.png",type:"code"},xml:{icon:"asset/img/file/file_code.png",type:"code"},sql:{icon:"asset/img/file/file_code.png",type:"code"},java:{icon:"asset/img/file/file_code.png",type:"code"},js:{icon:"asset/img/file/file_code.png",type:"code"},jsp:{icon:"asset/img/file/file_code.png",type:"code"},md:{icon:"asset/img/file/file_code.png",type:"code"},cs:{icon:"asset/img/file/file_code.png",type:"code"},cpp:{icon:"asset/img/file/file_code.png",type:"code"},go:{icon:"asset/img/file/file_code.png",type:"code"},php:{icon:"asset/img/file/file_code.png",type:"code"},py:{icon:"asset/img/file/file_code.png",type:"code"},css:{icon:"asset/img/file/file_css.png",type:"code"},mp4:{icon:"asset/img/file/file_video.png",type:"video"},webm:{icon:"asset/img/file/file_video.png",type:"video"},mp3:{icon:"asset/img/file/file_music.png",type:"audio"},ogg:{icon:"asset/img/file/file_music.png",type:"audio"},wav:{icon:"asset/img/file/file_music.png",type:"audio"},txt:{icon:"asset/img/file/file_txt.png",type:"txt"},rar:{icon:"asset/img/file/file_zip.png",type:"unknown"},zip:{icon:"asset/img/file/file_zip.png",type:"unknown"},chm:{icon:"asset/img/file/file_chm.png",type:"unknown"}},e.onSearchKeyDown=function(t){13===t.keyCode&&e.search()},e.search=function(t){e.keyword&&a.go("search",{keyword:e.keyword})},e.authorize=function(t,n){if(e.isAdmin()||"my"===e.mountAlias)return!0;if("enterprise"===e.router)return"download"===t;if(e.current)return!(s=e.current.permission)||0===s.length||s.indexOf(t)>=0;var r=n?[n]:e.selection;if(!r)return!1;var s=e.permissions,i=r.length;if(!s)return!0;for(var o=0;o<i;o++){var l=s[r[o].id];if(l&&l.indexOf(t)<0)return!1}return!0},t.getMountAlias=function(e){return t.mountAliases[e]},t.setCurrent=function(e){e?(t.mountAlias=t.mountAliases[e.mount],t.mount=t.mounts[t.mountAlias],t.router=e.id,t.driectoryName=e.name):"my"===t.mountAlias?t.driectoryName="个人文档":t.driectoryName="企业文档",t.current=e},t.isAdmin=function(){return["SYS_ADMIN","DOC_ADMIN"].indexOf(t.user.role)>=0},e.$on("$locationChangeSuccess",function(e,n,r){t.fid?t.openFile():t.closeFile()}),t.getExt=function(t){if(t){var e=t.name;if(e)return e.substring(e.lastIndexOf(".")+1,e.length)}},t.getIcon=function(e){var n;if(!e)return null;if("directory"===e.type)n=Util.isPrivate(e)?"asset/img/private_folder.png":"asset/img/public_folder.png";else{var r=t.getExt(e);if(!r)return;r=r.toLowerCase();var s=t.mediaType[r];n=s?s.icon:"asset/img/file/file_unknown.png"}return n},e.updateUser=function(){i.post("/user/set",{name:e.user.name,mode:e.user.mode,sortField:e.user.sortField,sortDesc:e.user.sortDesc})},e.sortField=e.user.sortField||"name",e.sortFields=["type",e.sortField],e.sortDesc=e.user.sortDesc||!1,e.mode=e.user.mode||"list",e.showTags=!0,e.switchShowTag=function(){e.showTags=!e.showTags},e.switchMode=function(t){e.mode=t||("list"===e.mode?"block":"list"),e.user.mode=e.mode},e.changeSort=function(t){e.sortField===t?e.sortDesc=!e.sortDesc:(e.sortField=t,e.sortDesc=!0),e.sortFields=["type",t],e.user.sortField=e.sortField,e.user.sortDesc=e.sortDesc},e.changeDesc=function(){e.sortDesc=!e.sortDesc,e.user.sortDesc=e.sortDesc},t.open=function(e,n){"directory"===e.type?a.go("directory",{directory:e.id}):(t.fid=e.id,l.path("/index/document/"+e.id),n&&n.stopPropagation())},c.notice){var f=c.notice;s.alert(f.title,f.content)}t.started=!0}]),angular.element(document).ready(function(){function t(){angular.bootstrap(document,["app"]),window.clearInterval(window.preloadInterval)}$.ajax({url:"/environment",method:"get"}).success(function(e){e.success?(delete e.success,app.value("environment",e.data),t()):alert("加载用户信息失败，请重新刷新页面再试")}).error(function(){alert("加载用户信息失败，请重新刷新页面再试")})}),app.controller("AuthorizePublicCtrl",["$rootScope","$scope","$http","$modal","$modalInstance","data",function(t,e,n,r,s,i){e.permission=i.permission;var o=t.toaster.wait("正在加载权限...");n.get("/conf/permission").success(function(t){t.success?(e.permissions=t.permissions,o.doSuccess("权限已加载")):o.doError("加载权限列表失败:"+t.message)}).error(function(t,e){o.doError("加载权限列表失败:"+(t.mesage||e))}),e.ok=function(){var r={permission:e.permission,id:i.id};e.saving=!0;var o=t.toaster.wait("正在设置权限");n.post("/fs/permission/set",r).success(function(t){e.saving=!1,t.success?(o.doSuccess("权限已设置"),s.close()):o.doError("权限设置失败:"+t.message)}).error(function(t,n){e.saving=!1,o.doError("权限设置失败:"+(t.message||n))})},e.close=function(){s.dismiss("cancel")}}]),app.controller("AuthorizeCtrl",["$rootScope","$scope","$http","Messager","$modal","$modalInstance","id",function(t,e,n,r,s,i,o){e.permissionMap={};for(var l=0;l<e.permissions.length;l++)e.permissionMap[e.permissions[l].id]=e.permissions[l].name;e.select=function(t,n){n.stopPropagation(),e.current!==t?e.current=t:e.current=null},e.condition={},e.changeConditionPermission=function(t){e.condition.permission=t},e.load=function(){e.loading=!0,n.get("/fs/authorize/list",{params:{documentId:o}}).success(function(t,n,r,s){e.loading=!1,t.success?e.authorizes=t.data:(e.toaster.pop("error",t.message),e.error=t.message)}).error(function(t,n){e.loading=!1,e.error=t.message,e.toaster.pop("error","加载失败："+n)})},e.count=function(t){if(!e.authorize||0===e.authorize.length)return!1;var n=0;return e.authorize.forEach(function(e){e.type===t&&n++}),n>0},e.add=function(){s.open({templateUrl:"asset/tpl/app/authorize_add.html",controller:"AuthorizeAddCtrl",size:"lg",backdrop:"static",resolve:{permissions:function(){return e.permissions},id:function(){return o}}}).result.then(function(t){e.load()},function(){})},e.update=function(t){function s(){var r=e.toaster.wait("正在更新权限...");if(!0===t.inherited){var s={documentId:o,permission:e.permissionId};1===e.current.ownerType?s.userIds=[e.current.owner]:s.departmentIds=[e.current.owner],n.post("/fs/authorize/add",s).success(function(t){t.success?(r.doSuccess("权限已更新"),e.load()):r.doError("权限更新失败:"+t.message)}).error(function(t,e){r.doError("权限更新失败:"+(t.message||e))})}else n.post("/fs/authorize/update",{id:t.id,permissionId:e.permissionId}).success(function(t){t.success?(e.load(),r.doSuccess("权限已更新")):r.doError("权限更新失败:"+t.message)}).error(function(t,e){r.doError("权限更新失败:"+(t.message||e))})}e.permissionId!==t.permissionId&&r.confirm("提示","确定要修改权限?").then(function(){s()})},e.remove=function(t,s){function i(t){var r=e.toaster.wait("正在删除权限...");n.post("/fs/authorize/remove/"+t.id,{}).success(function(t){t.success?(e.load(),e.current=null,r.doSuccess("权限已删除")):r.doError("删除权限失败:"+t.message)}).error(function(t,e){r.doError("权限删除失败:"+(result.message||e))})}s.stopPropagation(),r.confirm("提示","确定要删除?").then(function(){i(t)})},e.ok=function(){i.close(result)},e.close=function(){i.dismiss("cancel")},e.load()}]),app.controller("AuthorizeAddCtrl",["$rootScope","$scope","$http","$modal","$modalInstance","permissions","id",function(t,e,n,r,s,i,o){e.loading=!1,e.tree={},e.permissions=i,e.onTreeInit=function(){var t=e.tree.getRoot();e.tree.select(t)},e.clear=function(){e.searching=!1,e.condition=null},e.selectedUsers=[],e.selectedUserIds=[],e.selectedDepartments=[],e.selectedDepartmentIds=[],e.addDepartment=function(t){e.selectedDepartmentIds.indexOf(t.id)>=0||(e.selectedDepartments.push(t),e.selectedDepartmentIds.push(t.id))},e.removeDepartment=function(t){e.selectedDepartmentIds.indexOf(t.id)<0||(e.selectedDepartments.splice(e.selectedDepartments.indexOf(t),1),e.selectedDepartmentIds.splice(e.selectedDepartmentIds.indexOf(t.id),1))},e.addUser=function(t){e.selectedUserIds.indexOf(t.id)>=0||(e.selectedUsers.push(t),e.selectedUserIds.push(t.id))},e.removeUser=function(t){e.selectedUserIds.indexOf(t.id)<0||(e.selectedUsers.splice(e.selectedUsers.indexOf(t),1),e.selectedUserIds.splice(e.selectedUserIds.indexOf(t.id),1))},e.search=function(){e.condition&&(e.searching=!0,e.loading=!0,n.get("/member/search",{params:{condition:e.condition}}).success(function(t,n,r,s){e.loading=!1,t.success?e.searchResult=t.data:e.toaster.pop("error","提示",t.message)}).error(function(t,n){e.loading=!1,e.toaster.pop("error","提示","加载失败："+n)}))},e.ok=function(){var t={documentId:o,userIds:e.selectedUserIds,departmentIds:e.selectedDepartmentIds,permission:e.permission},r=e.toaster.wait("正在添加权限...");e.saving=!0,n.post("/fs/authorize/add",t).success(function(t){e.saving=!1,t.success?(r.doSuccess("权限已添加"),s.close()):r.doError("添加权限失败："+t.message)}).error(function(t,n){e.saving=!1,r.doError("添加权限失败："+(t.message||n))})},e.loadMember=function(t){e.loading=!0,n.get("/member/list",{params:{departmentId:t.id}}).success(function(t,n,r,s){e.loading=!1,t.success?(e.users=t.data.users,e.departments=t.data.departments):e.toaster.pop("error",t.message)}).error(function(t,n){e.loading=!1,e.toaster.pop("error","加载失败："+n)})},e.close=function(){s.dismiss("cancel")}}]),app.controller("ChangePasswordCtrl",["$scope","$http",function(t,e){t.check=function(){var e=0;if(t.newPassword.length<1)return e;/\d/.test(t.newPassword)&&e++,/[a-z]/.test(t.newPassword)&&e++,/[A-Z]/.test(t.newPassword)&&e++,/\W/.test(t.newPassword)&&e++,t.strength=e},t.submit=function(){e.post("/user/change/password",{oldPassword:t.oldPassword,newPassword:t.newPassword,confirmPassword:t.confirmPassword}).success(function(e){e.success?(t.newPassword=null,t.oldPassword=null,t.confirmPassword=null,t.success=!0,t.cause=null,t.user.changePassword=!1):(t.cause=e.message,t.success=!1)}).error(function(e,n){t.error=e.message||n,t.success=!1})}}]),app.controller("DirectoryCtrl",["$rootScope","$scope","$http","$state","$location","$modal","$stateParams","Messager","FileSystem",function(t,e,n,r,s,i,o,l,a){function c(t){angular.element("#directoryOperationContextMenu").hide(),angular.element("#containerContextMenu").hide(),angular.element("#permissionContextMenu").hide()}function d(t){116===t.keyCode&&(t.preventDefault(),e.reload())}e.ie9&&e.webUploader.addButton({id:"#filePicker",innerHTML:'<i class="glyphicon glyphicon-cloud-upload"></i> 上传文件'}),t.module="directory";var p=o.directory,u=t.mounts[p];u&&(t.mount=u,t.mountAlias=p,p=null),e.$on("$viewContentLoaded",function(){e.load(p)}),e.reload=function(){e.current?e.load(e.current.id):e.load()},e.load=function(n){e.loading=!0,e.reset();var r=e.mount?e.mount.id:null;a.load(r,n).then(function(n){e.files=n.files,e.path=n.path,e.activities=n.activities,e.authorizes=n.authorizes,n.current&&(n.current.permissions=n.permissions),t.setCurrent(n.current),e.loading=!1},function(t){e.error=t,e.toaster.pop("error","加载文件失败",t),e.loading=!1})},e.checkPermission=function(n){if("my"===e.mountAlias)return!0;if("create"===n&&!t.current&&"enterprise"===e.mountAlias)return!0;if("upload"===n&&!t.current&&"enterprise"===e.mountAlias)return!1;if(e.current){if(e.current.creationBy.id===t.user.id)return!0;if(e.current.permissions)return e.current.permissions.indexOf(n)>=0}return!1},e.loadAuthorizes=function(){n.get("/fs/authorize/list",{params:{documentId:e.current.id}}).success(function(t,n,r,s){e.loading=!1,t.success?e.authorizes=t.data:e.toaster.pop("error",t.message)}).error(function(t,n){e.loading=!1,e.toaster.pop("error","加载失败："+n)})},e.$on("$fileUploaded",function(t,n){e.current?(n.parent=e.current.id)&&e.reload():n.mount===e.mount.id&&e.reload()}),e.$on("$currentFolderReload",function(t,n){e.reload()}),e.addFavorite=function(e,n){n.stopPropagation(),a.addFavorite(e).then(function(n){t.toaster.success({title:"已收藏"}),e.favoriteId=n.data},function(){t.toaster.error({title:"收藏失败"})})},e.removeFavorite=function(e,n){n.stopPropagation(),a.removeFavorite(e).then(function(n){t.toaster.success({title:"收藏已取消"}),e.favoriteId=null},function(){t.toaster.error({title:"取消收藏失败"})})},e.canShowAuthorizer=function(t){return null!=t&&(a.isDirectory(t)&&"my"!==e.mountAlias)},e.canEditPermission=function(e){return null!=e&&e.creationBy.id===t.user.id},e.isNonLocked=function(t){return 0===e.lockedSelectionCount},e.authorizeUnlock=function(t){if(!1===e.hasPermission("lock"))return!1;for(var n=e.selection,r=0;r<n.length;r++)if(!0!==(t=n[r]).locked||t.lockedBy&&t.lockedBy.id===e.user.id)return!1;return!0},e.isSelectAll=!1,e.selection=[],e.lockedSelectionCount=0,e.selectAll=function(){e.isSelectAll=!e.isSelectAll;for(var t=e.files.length,n=0;n<t;n++)e.select(e.files[n],e.isSelectAll)},e.addSelection=function(t){e.selection.push(t),t.selected=!0,!0===t.locked&&e.lockedSelectionCount++,e.selection.length===e.files.length&&(e.isSelectAll=!0)},e.removeSelection=function(t){e.selection.splice(e.selection.indexOf(t),1),t.selected=!1,!0===t.locked&&e.lockedSelectionCount++,e.isSelectAll=!1},e.clearSelection=function(){e.selection.forEach(function(t){t.selected=!1}),e.selection=[],e.isSelectAll=!1},e.select=function(t,n,r){if(r&&"block"===e.mode&&!r.ctrlKey&&e.clearSelection(),r&&r.stopPropagation(),!t.selected||n!==t.selected)return $(".app-ctrl").scrollTop(0),!1===(n=n||!t.selected||!t.selected)?e.removeSelection(t):e.addSelection(t)},e.removeAuthorize=function(t,r){function s(t){var r=e.toaster.wait("正在删除..."),s=n.post("/fs/authorize/remove/"+t.id,{});s.success(function(t){t.success?(e.loadAuthorizes(),r.doSuccess("已删除")):r.doError("删除失败:"+t.message)}),s.error(function(t,e){r.doError("删除失败:"+(t.message||e))})}r.stopPropagation(),l.confirm("提示","确定要删除?").then(function(){s(t)})},e.addAuthorize=function(){i.open({templateUrl:"asset/tpl/app/authorize_add.html",controller:"AuthorizeAddCtrl",size:"lg",backdrop:"static",resolve:{permissions:function(){return e.permissions},id:function(){return e.current.id}}}).result.then(function(t){e.loadAuthorizes()},function(){})},e.updatePermission=function(t){function r(){var r=e.toaster.wait("正在修改权限...");if(!0===e.selectedAuthorize.inherited){var s={documentId:e.current.id,permission:t.id};1===e.selectedAuthorize.ownerType?s.userIds=[e.selectedAuthorize.owner]:s.departmentIds=[e.selectedAuthorize.owner],n.post("/fs/authorize/add",s).success(function(t){t.success?(r.doSuccess("权限已更新"),e.loadAuthorizes()):r.doError("权限更新失败:"+t.message)}).error(function(t,e){r.doError("权限更新失败:"+(t.message||e))})}else n.post("/fs/authorize/update",{id:e.selectedAuthorize.id,permissionId:t.id}).success(function(t){t.success?(r.doSuccess("权限已更新"),e.loadAuthorizes()):r.doError("权限更新失败:"+t.message)}).error(function(t,e){r.doError("权限更新失败:"+(t.message||e))})}t.id!==e.selectedAuthorize.permissionId&&l.confirm("提示","确定要修改协作者的权限?").then(function(){r()})},e.onContainerClick=function(){"block"===e.mode&&e.clearSelection()},e.filterTag=function(t,n){e.condition=t,n.stopPropagation()},e.download=function(n){n||(n=e.selection[0]),t.download(n)},e.remove=function(n){n||0===(n=e.selection).length&&l.alert("提示","请选择要删除的文件"),t.remove(n,function(){e.reload()})},e.lock=function(n){n||(n=e.selection[0])||l.alert("提示","请选择要锁定的文件"),t.lock(n,function(){e.reload()})},e.unlock=function(n){n||(n=e.selection[0])||l.alert("提示","请选择要解锁的文件"),t.unlock(n,function(){e.reload()})},e.rename=function(n){n||(n=e.selection[0]),n||l.alert("提示","请选择要重命名的文件"),t.rename(n,function(t,e){n.name=e})},e.showAuthorizer=function(t){t=t||e.selection[0];var n;n={templateUrl:"asset/tpl/app/authorize.html",controller:"AuthorizeCtrl",backdrop:"static",size:"lg",resolve:{id:function(){return t.id}}},i.open(n).result.then(function(t){e.reload()})},e.move=function(){t.move(e.selection,e.mount,function(t){e.reload()})},e.copy=function(){t.copy(e.selection,e.mount,function(t){e.reload()})},e.updateDesc=function(){t.updateDescription(e.current,function(){},function(){})},e.createDirectory=function(){l.prompt("新建文件夹","","").then(function(n){var r=e.toaster.wait({title:"正在新建文件夹"}),s={mount:t.mount.id,name:n};e.current&&(s.parent=e.current.id),a.createDirectory(s).then(function(){r.doSuccess({type:"success",title:"新建文件夹成功"}),e.reload()},function(t){r.doError({type:"error",title:"新建文件夹失败："+t})})})},e.showContextMenu=function(t,n){var r=angular.element("#directoryOperationContextMenu"),s=angular.element(window.document);e.selected=t,e.select(t,!0,n);var i=n.pageY,o=n.pageX;i+r.height()>s.height()&&(i-=r.height()),o+r.width()>s.width()&&(o-=r.width()),r.css({top:i,left:o}),r.show(),n.stopPropagation()},e.showDirectoryContextMenu=function(t,n){var r=angular.element("#directoryOperationContextMenu"),s=angular.element(window.document);e.selected=t;var i=n.pageY,o=n.pageX;i+r.height()>s.height()&&(i-=r.height()),o+r.width()>s.width()&&(o-=r.width()),r.css({top:i,left:o}),r.show(),n.stopPropagation()},e.showPermissionContextMenu=function(t,n){var r=angular.element("#permissionContextMenu"),s=angular.element(window.document);e.selectedAuthorize=t;var i=n.pageY,o=n.pageX;i+r.height()>s.height()&&(i-=r.height()),o+r.width()>s.width()&&(o-=r.width()),r.css({top:i,left:o}),r.show(),n.stopPropagation()},e.showContainerContextMenu=function(t){var e=angular.element("#containerContextMenu"),n=angular.element(window.document),r=t.pageY,s=t.pageX;r+e.height()>n.height()&&(r-=e.height()),s+e.width()>n.width()&&(s-=e.width()),e.css({top:r,left:s}),e.show(),t.stopPropagation()},e.reset=function(){e.selection=[],e.isSelectAll=!1,e.lockedSelectionCount=!1},$(document).on("keydown",d),$(window).on("click",c),e.$on("$destroy",function(){$(window).unbind("click",c),$(document).unbind("keydown",d),t.setCurrent(null)})}]),app.controller("DirectoryFormCtrl",["$rootScope","$scope","$modalInstance",function(t,e,n){e.ok=function(){var t={name:e.name,type:e.type};n.close(t)},e.allowPrivate=function(){return"enterprise"===t.mountAlias&&e.isAdmin()&&!t.current},e.close=function(){n.dismiss("cancel")}}]),app.controller("FileDetailCtrl",["$rootScope","$scope","$http","FileSystem","Messager","$location","$modal","$modalInstance","id",function(t,e,n,r,s,i,o,l,a){var c=document.body,d=c.requestFullScreen||c.webkitRequestFullScreen||c.mozRequestFullScreen||c.msRequestFullScreen;e.supportFullScreen=d,e.fullScreen=function(){var t=document.getElementById("file-preview-container");(t.requestFullScreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||t.msRequestFullScreen).call(t),e.hiddenDetail=!0},e.deg=0,e.rotate=function(){e.deg+=90,360===e.deg&&(e.deg=0)},e.addReview=function(t){var r=e.toaster.wait("正在发表评论");n.post("/review/add",{content:t,documentId:e.file.id}).success(function(t){if(t.success){r.doSuccess("评论发表成功");var n=t.data;n.name=e.user.name,n.avatar=e.user.avatar,e.reviews.push(n)}else r.doError("发表评论失败: "+t.message)}).error(function(t,e){r.doError("发表评论失败: "+(t.message||e))})},e.removeReview=function(t){s.confirm("提示","确定要删除评论?").then(function(){var r=e.toaster.wait("正在删除评论");n.post("/review/delete",{id:t.id}).success(function(n){n.success?(r.doSuccess("评论已删除"),e.reviews.splice(e.reviews.indexOf(t),1)):r.doError("删除评论失败: "+n.message)}).error(function(t,e){r.doError("删除评论失败: "+(t.message||e))})})},e.addFavorite=function(){r.addFavorite(e.file).then(function(){t.toaster.success({title:"已收藏"}),e.favorited=!0},function(){t.toaster.error({title:"收藏失败"})})},e.removeFavorite=function(){r.removeFavorite(e.file).then(function(){t.toaster.success({title:"收藏已取消"}),e.favorited=!1},function(){t.toaster.error({title:"取消收藏失败"})})},e.remove=function(){t.remove(e.file,function(){e.close(!0)})},e.rename=function(){t.rename(e.file,function(t,n){e.file.name=n})},e.move=function(){t.move([e.file],e.file.mount,function(t){e.close(!0)})},e.lock=function(){t.lock(e.file,function(t){e.load(a)})},e.unlock=function(){t.unlock(e.file,function(t){e.load(a)})},e.copy=function(){t.copy([e.file])},e.download=function(n){n||(n=e.file),t.download(n)},e.load=function(r){e.loading=!0,n.get("/fs/document/"+r).success(function(n){e.loading=!1,n.success?(e.file=n.data.document,e.favorited=null!=n.data.document.favoriteId,e.permissions=n.data.permissions,e.activities=n.data.activities,e.reviews=n.data.reviews,e.token=n.data.token,e.setCurrent(e.file),t.mount||(t.mountAlias=t.mountAliases[e.file.mount],t.mount=t.mounts[t.mountAlias])):e.error=n.message||"加载失败"}).error(function(t,n){e.loading=!1,e.error=n})},e.setVersion=function(r){s.confirm("提示","确定将该版本设置为最新版本?").then(function(){var s=t.toaster.wait("正在设置新版本...");n.post("/fs/version/set",{id:r.id}).success(function(t){t.success?(s.doSuccess("设置最新版本成功"),e.load(t.file.id)):s.doError("设置最新版本失败:"+t.message)}).error(function(t,e){s.doError("设置最新版本失败:"+(t.message||e))})})},e.deleteVersion=function(r){s.confirm("提示","版本删除之后不可恢复，确定删除该版本?").then(function(){var s=t.toaster.wait("正在删除...");n.post("/fs/version/delete/"+r.id).success(function(t){t.success?(s.doSuccess("删除版本成功"),e.load(e.file.id)):s.doError("删除版本失败:"+t.message)}).error(function(t,e){s.doError("删除版本失败:"+(t.message||e))})})},e.setCurrent=function(r){e.current=r,e.current.media=e.getMediaType(e.current),e.current.icon=t.getIcon(e.current),"code"===e.current.media&&(e.cmOption={lineNumbers:!0,indentWithTabs:!0,mode:e.getExt(r),readOnly:!0,onLoad:function(t){t.setOption("css","height:100%")}},n.get("/fs/raw?token="+e.token).success(function(t){e.raw=t}))},e.checkPermission=function(t){return"my"===e.mountAlias||(!(e.permissions&&e.permissions.length>0)||e.permissions.indexOf(t)>=0)},e.getMediaType=function(t){var n=e.getExt(t);if(n){var r=e.mediaType[n.toLowerCase()];return r?r.type:"unknow"}},e.geImageSrc=function(t){return"/fs/raw?token="+e.token},e.getPdfViewerUrl=function(t){return"asset/pdfjs/viewer.html?token="+e.token},e.getPreviewUrl=function(t){return"/fs/office?id="+e.current.id},e.close=function(n){l.close(n);var r="/index/";if(t.module)switch(t.module){case"search":r+="search/"+t.keyword;break;case"directory":case void 0:r+="directory/"+(-1!==e.file.parent?e.file.parent:t.getMountAlias(e.file.mount));break;default:r+=t.module}else r+="directory/enterprise";i.path(r)},e.onContainerClick=function(){angular.element("#documentOperationContextMenu").hide()},e.load(a),e.showDocumentContextMenu=function(t,n){var r=angular.element("#documentOperationContextMenu"),s=angular.element(window.document);e.selected=t;var i=n.pageY,o=n.pageX;i+r.height()>s.height()&&(i-=r.height()),o+r.width()>s.width()&&(o-=r.width()),r.css({top:i,left:o}),r.show(),n.stopPropagation()}}]),app.controller("FileMoveCtrl",["$rootScope","$scope","Messager","$modalInstance","data",function(t,e,n,r,s){Util.Array.copyProperty(s.files,"id",function(t){return"directory"===t.type});e.isRepeat=!1,e.ok=function(){n.confirm("提示","是否确定要移动?").then(function(){r.close(e.target)})},e.setParam=function(t,e){e.mount=t.mount,e.excludes},e.setTarget=function(t){var n=s.files[0].parent,r=s.files[0].mount;if(n&&n===t.id?e.isRepeat=!0:n||t.id||r!==t.mount?e.isRepeat=!1:e.isRepeat=!0,!0===e.isRepeat)return e.target=null,void(e.paths=null);var i=[];for(e.target=t,i.push(t.name);t.$parent&&!t.$parent.$root;)t=t.$parent,i.push(t.name);i.reverse(),e.paths=i.join(" / ")},e.updateDesc=function(){t.updateDescription(e.current,function(){},function(){})},e.close=function(){r.dismiss()}}]),app.controller("FileCopyCtrl",["$rootScope","$scope","Messager","$modalInstance","data",function(t,e,n,r,s){e.ok=function(){n.confirm("提示","是否确定要复制?").then(function(){r.close(e.target)})},e.setParam=function(t,e){e.mount=t.mount},e.setTarget=function(t){var n=[];for(e.target=t,n.push(t.name);t.$parent&&!t.$parent.$root;)t=t.$parent,n.push(t.name);n.reverse(),e.paths=n.join(" / ")},e.close=function(){r.dismiss()}}]),app.controller("FileTagCtrl",["$scope","$http","$modalInstance","Messager","FileSystem","file",function(t,e,n,r,s,i){t.tags=[],t.file=i,i.tags&&(t.tags=i.tags.split(",")),t.remove=function(e){t.tags.splice(t.tags.indexOf(e),1),i.tags=t.tags.join(","),t.save()},t.add=function(){t.tags.indexOf(t.tag)>=0?t.toaster.pop("error","存在相同的标签"):(t.tags.push(t.tag),t.tag=null,i.tags=t.tags.join(","),t.save())},t.save=function(){s.setTag(t.file).then(function(t){})},t.cancel=function(){n.dismiss("cancel")}}]),app.controller("FileSendCtrl",["$scope","$http","files","$modal","$modalInstance","Messager",function(t,e,n,r,s,i){t.files=n,t.remove=function(e){t.files.splice(t.files.indexOf(e),1),0===t.files.length&&s.dismiss("cancel")},t.users=[],t.userIds={},t.addReceiver=function(){r.open({templateUrl:"asset/tpl/app/user_select.html",controller:"SelectUserCtrl",backdrop:"static",resolve:{options:function(){return{multiple:!0}}}}).result.then(function(e){e.forEach(function(e){t.userIds[e.id]||(t.users.push(e),t.userIds[e.id]=e)})})},t.removeReceiver=function(e){t.users.splice(t.users.indexOf(e),1),delete t.userIds[e.id]},t.ok=function(){var n=t.toaster.wait("正在发送");t.sending=!0;var r=Util.Array.copyProperty(t.files,"id"),i=Util.Array.copyProperty(t.users,"id");e.post("/message/send",{files:r,receivers:i,content:t.content}).success(function(e){t.sending=!1,e.success?(n.doSuccess("发送成功"),s.close()):n.doError("发送失败:"+e.message)}).error(function(t,e){n.doError("发送失败:"+(t.message||e))})},t.cancel=function(){s.dismiss("cancel")}}]),app.controller("DropboxCtrl",["$scope","$http","data","$modalInstance","Messager",function(t,e,n,r,s){t.files=[];for(var i=0;i<n.files.length;i++)console.log(n.files),t.files.push(n.files[i]);t.treeConfig={"load-url":"/fs/folder","load-asyn":!0,"open-folder-icon":"fa fa-users","folder-icon":"fa fa-users","leaf-icon":"fa fa-folder"},t.setParam=function(t,e){e.mount=t.mount,e.permission="upload"},t.directory=n.directory,t.directory||(t.directory={mountAlias:"my",mount:t.mounts.my,name:"我的文档",fullName:"我的文档"}),t.onChange=function(e){e.id||e.mount!==t.mounts.enterprise?t.allowed=!0:t.allowed=!1},t.remove=function(e){t.files.splice(t.files.indexOf(e),1),0===t.files.length&&r.dismiss("cancel")},t.ok=function(){var e={mountAlias:t.directory.id||t.mountAliases[t.directory.mount],parent:t.directory.id,path:t.directory.name,mount:t.directory.mount};r.close({files:t.files,uploadContext:e})},t.cancel=function(){s.confirm("提示","是否确定放弃上传?").then(function(t){r.dismiss("cancel")},function(){})}}]),app.controller("FavoritesCtrl",["$rootScope","$scope","$http","$state","$location","$modal","Messager","FileSystem",function(t,e,n,r,s,i,o,l){function a(t){116===t.keyCode&&(t.preventDefault(),e.load())}t.module="favorites",e.load=function(){e.loading=!0,n.get("/fs/favorites").success(function(t){e.loading=!1,t.success?e.files=t.data:e.error=t.message}).error(function(t,n){e.error=t.message||n,e.toaster.pop("error",t.message||n),e.loading=!1})},e.$on("$viewContentLoaded",function(){e.load()}),e.removeFavorite=function(){o.confirm("提示","确定要删除?").then(function(){var n=t.toaster.wait("正在删除...");l.removeFavorite(e.selection).then(function(t){n.doSuccess("已删除"),e.load()},function(t){n.doError("删除失败:"+t)})})},e.isSelectAll=!1,e.selection=[],e.selectAll=function(){e.isSelectAll=!e.isSelectAll;for(var t=e.files.length,n=0;n<t;n++)e.select(e.files[n],e.isSelectAll)},e.addSelection=function(t){e.selection.push(t),t.selected=!0,e.selection.length===e.files.length&&(e.isSelectAll=!0)},e.removeSelection=function(t){e.selection.splice(e.selection.indexOf(t),1),t.selected=!1,e.isSelectAll=!1},e.clearSelection=function(){e.selection.forEach(function(t){t.selected=!1}),e.selection=[],e.isSelectAll=!1},e.select=function(t,n,r){if(r&&"block"==e.mode&&!r.ctrlKey&&e.clearSelection(),r&&r.stopPropagation(),!t.selected||n!==t.selected)return!1===(n=n||!t.selected||!t.selected)?e.removeSelection(t):e.addSelection(t)},e.onContainerClick=function(){"block"==e.mode&&e.clearSelection()},e.remove=function(n){n||0===(n=e.selection).length&&o.alert("提示","请选择要删除的文件"),t.remove(n,function(){e.reload()})},e.reset=function(){e.selection=[],e.isSelectAll=!1},$(document).on("keydown",a),e.$on("$destroy",function(){$(document).unbind("keydown",a)})}]),app.controller("MessagesCtrl",["$scope","$http","$rootScope","$location","$state",function(t,e,n,r,s){t.message||t.$on("$viewContentLoaded",function(){t.load()}),t.load=function(){t.loading=!0,e.get("/message/list").success(function(e){t.loading=!1,e.success?n.messages=e.data:t.error="加载消息失败:"+e.message}).error(function(e,n){t.loading=!1,t.error="加载消息失败:"+(e.message||n)})}}]),app.controller("ProfileCtrl",["$scope","$http",function(t,e){t.save=function(){var n=t.toaster.wait("正在保存");e.post("/user/updateProfile",{avatar:t.user.avatar,name:t.user.name,mode:t.user.mode,sortField:t.user.sortField,sortDesc:t.user.sortDesc}).success(function(e){e.success?(t.userSettingForm.$setPristine(),t.userSettingForm.$setUntouched(),n.doSuccess("个人设置已保存")):n.doError("保存失败："+e.message)}).error(function(t,e){n.doError("保存失败："+(t.message||e))})},t.selectAvatar=function(){angular.element("#avatarInput").click()},t.upload=function(){var e=angular.element("#avatarInput")[0].files,n=new FormData;n.append("avatar",e[0]);var r=new XMLHttpRequest;r.onload=function(e){if(t.uploading=!1,200!==r.status)t.result={success:!1,message:"上传失败：请稍候再试："+r.status};else{var n=angular.fromJson(r.response);if(t.result=n,n.success){t.user.avatar=n.avatar;var s=angular.element(".avatar-img");s.attr("src",s.attr("src")+"?_dc="+(new Date).getTime())}else t.message="上传失败："+n.message}t.$apply()},r.onerror=function(e){t.uploading=!1,t.result={success:!1,message:"上传失败：请稍候再试："+r.status}},r.open("POST","/user/upload/avatar"),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader(crsf.headerName,crsf.token),t.uploading=!0,r.send(n)}}]),app.controller("RecentsCtrl",["$rootScope","$scope","$http","$state","$location","$modal","Messager","FileSystem",function(t,e,n,r,s,i,o,l){function a(t){116===t.keyCode&&(t.preventDefault(),e.load())}t.module="recent",e.load=function(){e.loading=!0,n.get("/fs/recent").success(function(t){e.loading=!1,t.success?e.files=t.data:e.error=t.message}).error(function(t,n){e.error=t.message||n,e.toaster.pop("error",t.message||n),e.loading=!1})},e.$on("$viewContentLoaded",function(){e.load()}),e.removeRecent=function(){o.confirm("提示","确定要删除?").then(function(){var r=t.toaster.wait("正在删除..."),s=Util.Array.copyProperty(e.selection,"id").join(",");n.post("/recent/remove",{hcoId:s}).success(function(t){t.success?(r.doSuccess("已删除"),e.load()):r.doError("删除失败:"+t.message)}).error(function(t,e){r.doError("删除失败:"+t.message||e)})})},e.clear=function(){o.confirm("提示","确定要清除所有记录?").then(function(){var r=t.toaster.wait("正在清除...");n.post("/recent/clear").success(function(t){t.success?(r.doSuccess("已清除"),e.load()):r.doError("清除失败:"+t.message)}).error(function(t,e){r.doError("清除失败:"+t.message||e)})})},e.isSelectAll=!1,e.selection=[],e.selectAll=function(){e.isSelectAll=!e.isSelectAll;for(var t=e.files.length,n=0;n<t;n++)e.select(e.files[n],e.isSelectAll)},e.addSelection=function(t){e.selection.push(t),t.selected=!0,e.selection.length===e.files.length&&(e.isSelectAll=!0)},e.removeSelection=function(t){e.selection.splice(e.selection.indexOf(t),1),t.selected=!1,e.isSelectAll=!1},e.clearSelection=function(){e.selection.forEach(function(t){t.selected=!1}),e.selection=[],e.isSelectAll=!1},e.select=function(t,n,r){r&&"block"==e.mode&&!r.ctrlKey&&e.clearSelection(),r&&($(".app-ctrl").scrollTop(0),r.stopPropagation()),t.selected&&n===t.selected||(!1===(n=n||!t.selected||!t.selected)?e.removeSelection(t):e.addSelection(t))},e.onContainerClick=function(){"block"===e.mode&&e.clearSelection()},e.remove=function(n){n||0===(n=e.selection).length&&o.alert("提示","请选择要删除的文件"),t.remove(n,function(){e.reload()})},e.reset=function(){e.selection=[],e.isSelectAll=!1},$(document).on("keydown",a),e.$on("$destroy",function(){$(document).unbind("keydown",a)})}]),app.controller("RecycleCtrl",["$rootScope","$scope","$http","$state","$location","$modal","Messager",function(t,e,n,r,s,i,o){function l(t){116===t.keyCode&&(t.preventDefault(),e.load())}t.module="recycle",e.load=function(){e.reset(),e.loading=!0,n.get("/recycle/list").success(function(t){e.loading=!1,t.success?e.files=t.data:e.error=t.message}).error(function(t,n){e.error=t.message||n,e.toaster.pop("error",t.message||n),e.loading=!1})},e.$on("$viewContentLoaded",function(){e.load()}),e.sortField="name",e.sortFields=["type","name"],e.sortDesc=!1,e.changeSort=function(t){e.sortField===t?e.sortDesc=!e.sortDesc:(e.sortField=t,e.sortDesc=!0),e.sortFields=["type",t]},e.changeDesc=function(){e.sortDesc=!e.sortDesc},e.revert=function(){o.confirm("提示","确定要恢复?").then(function(){var r=t.toaster.wait("正在恢复..."),s=Util.Array.copyProperty(e.selection,"id");n.post("/recycle/revert",{documentIds:s}).success(function(t){t.success?(r.doSuccess("文件已恢复"),e.load()):r.doError("恢复失败:"+t.message)}).error(function(t,e){r.doError("恢复失败:"+(t.message||e))})})},e.destroy=function(){o.confirm("提示","确定要彻底删除?").then(function(){var r=Util.Array.copyProperty(e.selection,"id"),s=t.toaster.wait("正在删除...");n.post("/recycle/delete",{documentIds:r}).success(function(t){t.success?(s.doSuccess("文件已彻底删除"),e.load()):s.doError("删除失败:"+t.message)}).error(function(t,e){s.doError("删除失败:"+(t.message||e))})})},e.clear=function(){o.confirm("提示","确定要清空回收站?").then(function(){var r=t.toaster.wait("正在清空...");n.post("/recycle/clear").success(function(t){t.success?(r.doSuccess("回收站已清空"),e.load()):r.doError("清空回收站失败:"+t.message)}).error(function(t,e){r.doError("清空回收站失败:"+(t.message||e))})})},e.isSelectAll=!1,e.selection=[],e.selectAll=function(){e.isSelectAll=!e.isSelectAll;for(var t=e.files.length,n=0;n<t;n++)e.select(e.files[n],e.isSelectAll)},e.addSelection=function(t){e.selection.push(t),t.selected=!0,e.selection.length===e.files.length&&(e.isSelectAll=!0)},e.removeSelection=function(t){e.selection.splice(e.selection.indexOf(t),1),t.selected=!1,e.isSelectAll=!1},e.clearSelection=function(){e.selection.forEach(function(t){t.selected=!1}),e.selection=[],e.isSelectAll=!1},e.select=function(t,n,r){r&&"block"===e.mode&&!r.ctrlKey&&e.clearSelection(),r&&r.stopPropagation(),t.selected&&n===t.selected||(!1===(n=n||!t.selected||!t.selected)?e.removeSelection(t):e.addSelection(t))},e.onContainerClick=function(){"block"===e.mode&&e.clearSelection()},e.remove=function(n){n||0===(n=e.selection).length&&o.alert("提示","请选择要删除的文件"),t.remove(n,function(){e.reload()})},e.reset=function(){e.selection=[],e.isSelectAll=!1},$(document).keydown(l),e.$on("$destroy",function(){$(document).unbind("keydown",l)})}]),app.controller("SearchCtrl",["$rootScope","$scope","$http","$state","$stateParams","$location","$modal","Messager","FileSystem",function(t,e,n,r,s,i,o,l,a){t.module="search",e.keyword=s.keyword,t.keyword=e.keyword,e.load=function(){e.loading=!0,e.result=[],n.get("/fs/search",{params:e.buildParam()}).success(function(t){e.loading=!1,t.success?(e.result=t.data,e.pagination.pages=t.data.pages):e.error=t.message}).error(function(t,n){e.error=t.message||n,e.toaster.pop("error",t.message||n),e.loading=!1})},e.$on("$viewContentLoaded",function(){e.load()}),e.reload=function(){e.pagination.page=1,e.load()},e.loadPage=function(t){e.pagination.page=t,e.load()},e.result={rows:[]},e.pagination={size:20,page:1,pages:0},e.onPageChange=function(){e.pagination.page>e.pagination.pages||e.reload()},e.buildParam=function(){return{size:e.pagination.size,page:e.pagination.page,keyword:e.keyword}},e.isSelectAll=!1,e.selection=[],e.selectAll=function(){e.isSelectAll=!e.isSelectAll;for(var t=e.result.records,n=t.length,r=0;r<n;r++)e.select(t[r],e.isSelectAll)},e.addSelection=function(t){e.selection.push(t),t.selected=!0,e.selection.length===e.result.records.length&&(e.isSelectAll=!0)},e.removeSelection=function(t){e.selection.splice(e.selection.indexOf(t),1),t.selected=!1,e.isSelectAll=!1},e.clearSelection=function(){e.selection.forEach(function(t){t.selected=!1}),e.selection=[],e.isSelectAll=!1},e.select=function(t,n,r){r&&"block"===e.mode&&!r.ctrlKey&&e.clearSelection(),r&&($(".app-ctrl").scrollTop(0),r.stopPropagation()),t.selected&&n===t.selected||(!1===(n=n||!t.selected||!t.selected)?e.removeSelection(t):e.addSelection(t))},e.onContainerClick=function(){"block"===e.mode&&e.clearSelection()},e.download=function(n){n||(n=e.selection),t.download(n)},e.reset=function(){e.selection=[],e.isSelectAll=!1},$(document).bind("keydown.hc",function(t){116===t.keyCode&&(t.preventDefault(),e.load())}),e.$on("$destroy",function(){$(document).unbind("keydown.hc")})}]),app.controller("SelectUserCtrl",["$rootScope","$scope","$http","$modal","$modalInstance","options",function(t,e,n,r,s,i){e.loading=!1,e.tree={},e.onTreeInit=function(){var t=e.tree.getRoot();e.tree.select(t)},e.multiple=i.multiple,e.clear=function(){e.searching=!1,e.condition=null},e.selected=[],e.selectedIds=[],e.select=function(t){e.selectedIds.indexOf(t.id)>=0||(!1===e.multiple&&(e.selected=[],e.selectedIds=[]),e.selected.push(t),e.selectedIds.push(t.id))},e.remove=function(t){e.selectedIds.indexOf(t.id)<0||(e.selected.splice(e.selected.indexOf(t),1),e.selectedIds.splice(e.selectedIds.indexOf(t.id),1))},e.search=function(){e.condition&&(e.searching=!0,e.loading=!0,n.get("/user/search",{params:{condition:e.condition}}).success(function(t,n,r,s){e.loading=!1,t.success?e.result=t.data:e.toaster.pop("error","提示",t.message)}).error(function(t,n){e.loading=!1,e.toaster.pop("error","提示","加载失败："+n)}))},e.ok=function(){s.close(e.selected)},e.loadUser=function(t){e.loading=!0,n.get("/user/list",{params:{departmentId:t.id}}).success(function(t,n,r,s){e.loading=!1,console.log(t),t.success?e.users=t.data:e.toaster.pop("error",t.message)}).error(function(t,n){e.loading=!1,e.toaster.pop("error","加载失败："+n)})},e.close=function(){s.dismiss("cancel")}}]),app.controller("ShareCtrl",["$rootScope","$scope","$http","$state","$location","$modal","Messager","FileSystem",function(t,e,n,r,s,i,o,l){t.module="share",e.load=function(){},e.$on("$viewContentLoaded",function(){e.error="非常抱歉，社区版暂不支持该功能"})}]),app.factory("Dropbox",["$rootScope","FileSystem","$modal",function(t,e,n){var r={};return r.init=function(t){function e(t){t.preventDefault(),t.stopImmediatePropagation()}var r=document.getElementById("dropbox"),s=!1;document.addEventListener("mousedown",function(){s=!0}),document.addEventListener("mouseup",function(){s=!1}),document.addEventListener("dragenter",function(t){s||(r.innerText="文件拖放到此处上传",r.style.display="block")},!1),r.addEventListener("dragenter",function(t){e(t)}),r.addEventListener("dragover",function(t){e(t)}),r.addEventListener("dragleave",function(t){e(t),r.style.display="none"}),r.addEventListener("drop",function(s){e(s),r.style.display="none";var i=s.dataTransfer.files;i&&i.length>0&&n.open({templateUrl:"asset/tpl/app/dropbox.html",backdrop:"static",controller:"DropboxCtrl",resolve:{data:function(){return{files:i}}}}).result.then(function(e){for(var n=e.files,r=0;r<n.length;r++){var s=n[r];s.uploadContext=e.uploadContext,t.webUploader.addFiles(s)}},function(){})})},r}]),app.factory("FileOperation",["$rootScope","FileSystem","$modal","Messager","$state",function(t,e,n,r,s){var i={};return i.init=function(i){i.openParent=function(t,e){s.go("directory",{directory:-1!==t.parent?t.parent:i.getMountAlias(t.mount)}),e.stopPropagation()},t.open=function(e,n){"directory"===e.type?s.go("directory",{directory:e.id}):(t.fid=e.id,$location.path("/index/document/"+e.id),n&&n.stopPropagation())},t.closeFile=function(e){t.fileModal&&(t.fileModal.dismiss("cancel"),t.fileModal=null)},t.share=function(t){r.alert("提示","非常抱歉，社区版暂不支持该功能")},t.sendFile=function(t){angular.isArray(t)||(t=[t]),n.open({templateUrl:"asset/tpl/app/file_send.html",backdrop:"static",keyboard:!1,controller:"FileSendCtrl",resolve:{files:function(){return t}}}).result.then(function(t){},function(){})},t.openFile=function(e){var r=n.open({templateUrl:"asset/tpl/app/document.html",backdrop:"static",controller:"FileDetailCtrl",size:"full",resolve:{id:function(){return t.fid}}});r.result.then(function(t){!0===t&&i.$broadcast("$currentFolderReload",t.file)},function(){}),t.fileModal=r,t.fid=null},t.remove=function(t,n,s){r.confirm("提示","文件删除之后可以在回收站内还原，是否确定删除选中的文件?").then(function(){var r=i.toaster.wait({title:"正在删除文件..."});e.remove(t).then(function(t){r.doSuccess("删除文件成功"),angular.isFunction(n)&&n(t)},function(t){r.doError("删除文件失败:"+t),angular.isFunction(s)&&s(t)})})},t.lock=function(t,n,s){r.confirm("提示","锁定文件后只能本人进行解锁，确定要锁定?").then(function(){var r=i.toaster.wait({title:"正在锁定..."});e.lock(t).then(function(t){r.doSuccess("文件已锁定"),angular.isFunction(n)&&n(t)},function(t){r.doError("锁定文件失败:"+t),angular.isFunction(s)&&s(t)})})},t.unlock=function(t,n,s){r.confirm("提示","确定要解锁文件?").then(function(){var r=i.toaster.wait({title:"正在解锁..."});e.unlock(t).then(function(t){r.doSuccess("文件已解锁"),angular.isFunction(n)&&n(t)},function(t){r.doError("解锁文件失败:"+t),angular.isFunction(s)&&s(t)})})},t.setTag=function(t,e,r){n.open({templateUrl:"asset/tpl/app/tags.html",controller:"FileTagCtrl",backdrop:"static",resolve:{file:function(){return t}}}).result.then(function(t){angular.isFunction(e)&&e(t)})},t.rename=function(t,n,s){r.prompt("重命名","",t.name).then(function(r){var o=i.toaster.wait({title:"正在重命名..."});e.rename(t.id,r).then(function(t){o.doSuccess({title:"重命名成功"}),angular.isFunction(n)&&n(t,r)},function(t){o.doError({title:"重命名失败",body:t}),angular.isFunction(s)&&s(t)})})},t.move=function(t,r,s,o){n.open({templateUrl:"asset/tpl/app/move.html",controller:"FileMoveCtrl",backdrop:"static",resolve:{data:function(){return{files:t,mount:r}}}}).result.then(function(n){var r=i.toaster.wait({title:"正在移动..."});e.move(t,n.id,n.mount).then(function(t){r.doSuccess({title:"移动成功"}),angular.isFunction(s)&&s(t)},function(t){r.doError({title:"移动失败",body:t}),angular.isFunction(o)&&o(t)})})},t.copy=function(t,r,s){n.open({templateUrl:"asset/tpl/app/copy.html",controller:"FileCopyCtrl",backdrop:"static",resolve:{data:function(){return{files:t,mount:r}}}}).result.then(function(n){var r=i.toaster.wait({title:"正在复制..."});e.copy(t,n.id,n.mount).then(function(t){r.doSuccess({title:"复制成功"}),angular.isFunction(success)&&success(t)},function(t){r.doError({title:"复制失败",body:t}),angular.isFunction(s)&&s(t)})})},t.updateDescription=function(t,n,r){var s=i.toaster.wait({title:"正在修改备注..."});e.updateDescription(t).then(function(t){s.doSuccess({title:"修改成功"}),angular.isFunction(n)&&n(t,name)},function(t){s.doError({title:"修改失败",body:t}),angular.isFunction(r)&&r(t)})},t.download=function(t){i.downloadURL="/fs/download?id="+t.id},t.uploadNewVersion=function(t){r.alert("提示","非常抱歉，社区版不支持文档多版本")}},i}]),app.factory("FileSystem",["$http","$q",function(t,e){var n={};return n.isPrivate=function(t){return"private"==t.accessiblity},n.isDirectory=function(t){return!!t&&"directory"==t.type},n.isRoot=function(t){return!t.root||t.root==t.id},n.download=function(n){var r=e.defer(),s=n.id;return angular.isArray(n)&&(s=Util.Array.copyProperty(n,"id").join(",")),t.get("/fs/download",{params:{id:s}}).success(function(){r.resolve()}),r.promise},n.createDirectory=function(n){var r=e.defer();return t.post("/fs/createDirectory",n).success(function(t){t.success?r.resolve(t):r.reject(t.message)}).error(function(t,e){r.reject(e)}),r.promise},n.load=function(n,r){var s=e.defer();return t.get("/fs/directory/",{params:{id:r,mount:n}}).success(function(t){t.success?s.resolve(t.data):s.reject(t.message)}).error(function(t,e){s.reject(e)}),s.promise},n.addFavorite=function(n){var r=e.defer();return t.post("/favorite/add",{documentId:n.id}).success(function(t){t.success?r.resolve(t):r.reject(t.message)}).error(function(t,e){r.reject(e)}),r.promise},n.removeFavorite=function(n){var r=e.defer(),s=n.id;return s=angular.isArray(n)?Util.Array.copyProperty(n,"id"):[s],t.post("/favorite/remove",{documentIds:s}).success(function(t){t.success?r.resolve(t):r.reject(t.message)}).error(function(t,e){r.reject(e)}),r.promise},n.setTag=function(n){var r=e.defer();return t.post("/fs/tag",{id:n.id,tags:n.tags}).success(function(t){t.success?r.resolve(t):r.reject(t.message)}).error(function(t,e){r.reject(e)}),r.promise},n.updateDescription=function(n){var r=e.defer();return t.post("/fs/updateDescription",{id:n.id,description:n.description}).success(function(t){t.success?r.resolve(t):r.reject(t.message)}).error(function(t,e){r.reject(e)}),r.promise},n.copy=function(n,r,s){var i=e.defer();return n=angular.isArray(n)?Util.Array.copyProperty(n,"id"):[n.id],t.post("/fs/copy",{documentIds:n,parent:r,mount:s}).success(function(t){t.success?i.resolve(t):i.reject(t.message)}).error(function(t,e){i.reject(e)}),i.promise},n.move=function(n,r,s){var i=e.defer();return n=angular.isArray(n)?Util.Array.copyProperty(n,"id"):[n.id],t.post("/fs/move",{documentIds:n,parent:r,mount:s}).success(function(t){t.success?i.resolve(t):i.reject(t.message)}).error(function(t,e){i.reject(e)}),i.promise},n.remove=function(n){var r=e.defer(),s=n.id;return s=angular.isArray(n)?Util.Array.copyProperty(n,"id"):[s],t.post("/fs/remove",{documentIds:s}).success(function(t){t.success?r.resolve(t):r.reject(t.message)}).error(function(t,e){r.reject(t.message||e)}),r.promise},n.lock=function(n){var r=e.defer();return t.post("/fs/lock",{documentIds:[n.id]}).success(function(t){t.success?r.resolve(t):r.reject(t.message)}).error(function(t,e){r.reject(t.message||e)}),r.promise},n.unlock=function(n){var r=e.defer();return t.post("/fs/unlock",{documentIds:[n.id]}).success(function(t){t.success?r.resolve(t):r.reject(t.message)}).error(function(t,e){r.reject(t.message||e)}),r.promise},n.rename=function(n,r){var s=e.defer();return t.post("/fs/rename",{id:n,name:r}).success(function(t){t.success?s.resolve(t):s.reject(t.message)}).error(function(t,e){s.reject(e)}),s.promise},n.verify=function(n){var r=e.defer();return t.post("/fs/upload/verify",{md5:n.md5,name:n.name,path:n.path,ext:n.ext,mount:n.mount,parent:n.parent,size:n.size,master:n.master}).success(function(t){t.success?r.resolve(t):r.reject(t)}).error(function(t,e){r.reject(t)}),r.promise},n}]),app.factory("SocketIO",["$rootScope","FileSystem","$modal",function(t,e,n){var r={};return r.init=function(t){if(window.WebSocket){var e=new WebSocket("ws://localhost:8080/socket.io");e.onopen=function(){},e.onclose=function(){},e.onerror=function(){}}},r}]),app.factory("WebUploader",["$rootScope","FileSystem",function(t,e){var n={};return n.init=function(n){function r(){n.uploadStats=n.webUploader.getStats()}if(t.onUploadFileChange=function(){var t=document.getElementById("uploadFile").files;if(t)for(var e=t.length,r=0;r<e;r++){var s=t[r],i=WebUploader.guid();n.webUploader.addFile(s,i)}},window.WebUploader){WebUploader.Uploader.register({"before-send-file":"beforeSendFile","before-send":"beforeSend","after-send-file":"afterSendFile"},{beforeSendFile:function(t){var r=WebUploader.Deferred();return t.setStatus("md5","正在校验文件"),n.webUploader.md5File(t,0,10485760).progress(function(e){t.md5Percentage=e}).then(function(n){t.md5=n,e.verify(t).then(function(e){e.success?r.resolve():t.setStatus("error",e.message||"文件校验失败")},function(e){t.setStatus("error",e.message),r.reject()})}),r.promise()}});var s={swf:"swf/Uploader.swf",server:"/fs/upload",auto:!0,duplicate:!1,compress:!1,chunked:!1,withCredentials:!0,fileSizeLimit:1024*parseInt(t.appSetting.maxUploadFileSize)*1024},i=WebUploader.create(s);i.on("uploadBeforeSend",function(t,e,n){e.md5=t.file.md5,e.parent=t.file.parent,e.mount=t.file.mount,e.master=t.file.master,n["X-Requested-With"]="XMLHttpRequest",n[crsf.headerName]=crsf.token}),i.on("fileQueued",function(e){if(e.source.source.uploadContext){var r=e.source.source.uploadContext;e.mount=r.mount,e.mount=r.mount,e.parent=r.parent,e.path=r.path,e.mountAlias=r.mountAlias}else e.mount=t.mount.id,t.current?(e.parent=t.current.id,e.path=t.current.name):"enterprise"===t.mountAlias?e.path="企业文档":e.path="我的文档",e.mountAlias=t.mountAlias;e.icon=n.getIcon(e),e.on("statuschange",function(t){e.status=t}),t.files.push(e),n.showQueue=!0,n.$apply()}),i.on("fileDequeued",function(e){var n=t.files;n.splice(n.indexOf(e),1)}),i.on("uploadProgress",function(t,e){t.uploadPercentage=e.toFixed(2),t.setStatus("progress","正在上传："+100*t.uploadPercentage+"%"),n.$apply()}),i.on("uploadSuccess",function(e,s){r(),!0===s.success?(n.$broadcast("$fileUploaded",s.data),e.setStatus("success","上传成功")):e.setStatus("error","上传失败"),t.$apply()}),i.on("uploadError",function(e,n){r(),e.setStatus("error",n?"系统异常，上传失败":e.statusText),n&&t.$apply()}),i.on("uploadStart",function(t){t.setStatus("progress","正在上传"),r()}),i.on("uploadComplete",function(t){r(),0===n.uploadStats.progressNum&&(n.showQueue=!1)}),n.webUploader=i}else console.error("没有找到WebUploader组件")},n}]),angular.module("app").run(["$templateCache",function(t){"use strict";t.put("asset/tpl/app/authorize_add.html",'<div class=m-c>\r\n    <div class=modal-header>\r\n        <div class="pull-right col-md-6 no-padder">\r\n            <div class=input-group>\r\n                <input class=form-control ng-model=condition placeholder=搜索:用户名/姓名/拼音>\r\n                <div class=input-group-btn>\r\n                    <button type=button class="btn btn-default" ng-show=condition ng-click=clear();>\r\n                        <i class="glyphicon glyphicon-remove"></i>\r\n                    </button>\r\n                    <button type=button class="btn btn-default" ng-click=search();>\r\n                        <i class="glyphicon glyphicon-search"></i>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <h4 class=modal-title style="line-height: 34px">\r\n            <i class="fa fa-user"></i>\r\n            添加协作者\r\n        </h4>\r\n\r\n    </div>\r\n    <div class="modal-body no-padder">\r\n        <div class=permission-user-body ng-show=!searching>\r\n            <div class="col-sm-6 permission-user-part b-r wrapper-sm">\r\n                <hc-tree tree-control=tree load-asyn=true on-init=onTreeInit() open-folder-icon="fa fa-users" folder-icon="fa fa-users" leaf-icon="fa fa-users" on-selection-change=loadMember(selection); load-url=/department/list></hc-tree>\r\n            </div>\r\n            <div class="col-sm-6 permission-user-part wrapper-sm">\r\n                <div class="wrapper-xl text-center" ng-show=loading>\r\n                    <img src=asset/img/loading.gif>\r\n                    <p class=m-t-sm>正在加载</p>\r\n                </div>\r\n                <div ng-repeat="dept in departments" class="wrapper-xs hover-bg" ng-show=!loading ng-click="addDepartment(dept,\'department\');">\r\n                    <img src=/asset/img/group.png class=img-circle style=height:30px alt=...>\r\n                    <span class=m-l-sm style="line-height: 30px">{{dept.name}}</span>\r\n                </div>\r\n                <div ng-repeat="user in users" class="wrapper-xs hover-bg" ng-show=!loading ng-click=addUser(user);>\r\n                    <img ng-src="{{user.avatar | resource}}" class=img-circle style=height:30px alt=...>\r\n                    <span class=m-l-sm style="line-height: 30px">{{user.name}}</span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="permission-user-body wrapper-sm" ng-show=searching>\r\n            <div class="col-md-4 wrapper-xs hover-bg" ng-repeat="department in searchResult.departments" ng-click=addDepartment(department);>\r\n                <img src=/asset/img/group.png class="img-circle pull-left" style=height:50px alt=...>\r\n                <div class=inline>\r\n                    <span class=m-l-sm style="line-height: 30px">{{department.name}}</span>\r\n                    <br>\r\n                    <span class="m-l-sm text-muted">{{department.code}}</span>\r\n                </div>\r\n            </div>\r\n            <div class="col-md-4 wrapper-xs hover-bg" ng-repeat="user in searchResult.users" ng-click=addUser(user);>\r\n                <img ng-src="{{user.avatar | resource}}" class="img-circle pull-left" style=height:50px alt=...>\r\n                <div class=inline>\r\n                    <span class=m-l-sm style="line-height: 30px">{{user.name}}</span>\r\n                    <br>\r\n                    <span class="m-l-sm text-muted">{{user.username}}</span>\r\n                </div>\r\n            </div>\r\n            <div class=col-sm-12 ng-show="(!searchResult.departments && !searchResult.users) || (searchResult.departments.length == 0 && searchResult.users.length == 0)">\r\n                <div class="wrapper-xs text-center">\r\n                    <i class="iconfont icon-empty"></i>\r\n                    <p class=m-t-sm>没有搜索匹配的结果</p>\r\n                </div>\r\n            </div>\r\n            <div class="col-sm-12 permission-user-part" ng-show=loading>\r\n                <div class="wrapper-xl text-center">\r\n                    <img ng-src="{{\'asset/img/loading.gif\' | resource}}">\r\n                    <p class=m-t-sm>正在加载</p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="wrapper-sm b-t" ng-hide="selectedUsers.length == 0 && selectedDepartments.length == 0">\r\n            <div class="permission-user-selected wrapper-sm text-center inline hover-bg" ng-repeat="department in selectedDepartments">\r\n                <button type=button class=close ng-click=removeDepartment(department)>\r\n                    <span aria-hidden=true>×</span>\r\n                </button>\r\n                <img src=/asset/img/group.png class=img-circle style=height:35px alt=...>\r\n                <div class="text-ellipsis m-t-xs" style="font-size: 12px">{{department.name}}</div>\r\n            </div>\r\n            <div class="permission-user-selected wrapper-sm text-center inline hover-bg" ng-repeat="user in selectedUsers">\r\n                <button type=button class=close ng-click=removeUser(user)>\r\n                    <span aria-hidden=true>×</span>\r\n                </button>\r\n                <img ng-src="{{user.avatar | resource}}" class=img-circle style=height:35px alt=...>\r\n                <div class="text-ellipsis m-t-xs" style="font-size: 12px">{{user.name}}</div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class=modal-footer>\r\n        <form class="form-inline inline">\r\n            <div class=input-group>\r\n                <span class=input-group-addon>权限</span>\r\n                <select class="form-control wrapper-xs" ng-model=permission>\r\n                    <option ng-repeat="permission in permissions" value={{permission.id}}>{{permission.name}}</option>\r\n                </select>\r\n            </div>\r\n        </form>\r\n        <button type=button class="btn btn-primary" ng-click=ok() style="margin-left: 5px" ng-disabled="(selectedUsers.length == 0 && selectedDepartments.length == 0)|| !permission || saving">\r\n            <span ng-show=!saving>提交</span>\r\n            <span ng-show=saving>正在提交</span>\r\n        </button>\r\n        <button type=button class="btn btn-default" ng-click=close()>取消</button>\r\n    </div>\r\n</div>'),t.put("asset/tpl/app/authorize_public.html",'<div class=m-c>\r\n\t<div class=modal-header>\r\n\t\t<h4 class=modal-title>设置权限</h4>\r\n\t</div>\r\n\t<div class="modal-body wrapper-lg">\r\n\t\t<div class=row>\r\n\t\t\t<div class=col-sm-12>\r\n\t\t\t\t<form name=permissionSetForm class="form-horizontal form-validation">\r\n\t\t\t\t\t<div class=form-group>\r\n\t\t\t\t\t\t<label class="col-sm-3 control-label">选择权限：</label>\r\n\t\t\t\t\t\t<div class=col-sm-9>\r\n\t\t\t\t\t\t\t\t<select class="form-control wrapper-xs" ng-model=permission>\r\n\t\t\t\t\t\t\t\t\t<option value="">所有权限</option>\r\n\t\t\t\t\t\t\t\t\t<option ng-repeat="permission in permissions" value={{permission.id}} ng-selected="permission.id == permission">{{permission.name}}</option>\r\n\t\t\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=col-sm-12>\r\n\t\t\t\t\t\t\t<div class="alert alert-info m-b-none m-t-sm">\r\n\t\t\t\t\t\t\t\t该文件夹所有成员可见，如果没有设置权限则全员可见\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class=modal-footer style="text-align: right">\r\n\t\t<button type=button class="btn btn-primary" ng-click=ok() style="margin-left: 5px" ng-disabled="!permissionSetForm.$dirty || saving">\r\n\t\t\t<span ng-show=!saving>提交</span>\r\n\t\t\t<span ng-show=saving>正在提交</span>\r\n\t\t</button>\r\n\t\t<button type=button class="btn btn-default" ng-click=close()>取消</button>\r\n\t</div>\r\n</div>'),t.put("asset/tpl/app/authorize.html",'<div class=m-c>\r\n\t<div class=modal-header>\r\n\t\t\r\n\t\t<div class="pull-right col-sm-6 no-padder">\r\n\t\t\t<div class=input-group>\r\n\t\t          <input class=form-control ng-model=condition.name placeholder=搜索>\r\n\t\t          <div class=input-group-btn dropdown is-open=isopen>\r\n\t\t          \t <button type=button class="btn btn-default dropdown-toggle" dropdown-toggle>\r\n\t\t          \t \t<span ng-if=!condition.permission>全部</span>\r\n\t\t          \t \t<span ng-if=condition.permission>{{condition.permission.name}}</span>\r\n\t\t          \t \t<span class=caret></span>\r\n\t\t          \t </button>\r\n\t\t\t         \t<ul class="dropdown-menu dropdown-menu-right">\r\n\t\t\t         \t  <li ng-click=changeConditionPermission()><a href=#>全部</a></li>\r\n\t\t\t              <li ng-click=changeConditionPermission(permission) ng-repeat="permission in permissions"><a href=#>{{permission.name}}</a></li>\r\n\t\t\t            </ul>\r\n\t\t            </div>\r\n\t\t        </div>\r\n\t\t</div>\r\n\t\t<h4 class=modal-title style="line-height: 34px">\r\n\t\t\t<i class="fa fa-users"></i>\r\n\t\t\t协作者\r\n\t\t</h4>\r\n\t</div>\r\n\t<div class="modal-body no-padder">\r\n\t\t<div class="permission-body wrapper-xs" ng-click="current = null">\r\n\t\t \t <div class="row m-n">\r\n\t\t \t \t<div class="col-md-3 permission-item wrapper-sm hover-bg" ng-class="{\'active\':current == authorize}" ng-repeat="authorize in authorizes | filter:{name:condition.name,permission:condition.permission.id,ownerType:2}" ng-click=select(authorize,$event)>\r\n\t\t\t\t\t<button type=button class=close ng-click=remove(authorize,$event)>\r\n\t\t\t\t\t\t<span aria-hidden=true>×</span>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<img src=asset/img/group.png class="img-circle pull-left" style=height:40px alt=...>\r\n\t\t\t\t\t<div class=inline>\r\n\t\t\t\t\t\t<div class=m-l-sm style="line-height: 25px">{{authorize.name}}</div>\r\n\t\t\t\t\t\t<div class=m-l-sm style="line-height: 10px;font-size:12px;color:#bbb">\r\n\t\t\t\t\t\t\t{{authorize.permissionName}}<span ng-if=authorize.inherited>(继承)</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class="row m-r-none m-l-none m-t-xs">\r\n\t\t \t \t<div class="col-md-3 permission-item wrapper-sm hover-bg" ng-class="{\'active\':current == authorize}" ng-repeat="authorize in authorizes | filter:{name:condition.name,permission:condition.permission.id,ownerType:1} " ng-click=select(authorize,$event)>\r\n\t\t\t\t\t<button type=button class=close ng-click=remove(authorize,$event)>\r\n\t\t\t\t\t\t<span aria-hidden=true>×</span>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<img ng-src="{{user.avatar | resource}}" class="img-circle pull-left" style=height:40px alt=...>\r\n\t\t\t\t\t<div class=inline>\r\n\t\t\t\t\t\t<div class=m-l-sm style="line-height: 25px">{{authorize.name}}</div>\r\n\t\t\t\t\t\t<div class=m-l-sm style="line-height: 10px;font-size:12px;color:#bbb">\r\n\t\t\t\t\t\t\t{{authorize.permissionName}}<span ng-if=authorize.inherited>(继承)</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t \t <div class="col-sm-12 permission-user-part" ng-show=loading>\r\n\t\t\t\t<div class="wrapper-xl text-center">\r\n\t\t\t\t\t<img ng-src="{{\'asset/img/loading.gif\' | resource}}">\r\n\t\t\t\t\t<p class=m-t-sm>正在加载</p>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=col-sm-12 ng-show="authorizes.length == 0">\r\n\t\t    \t<div class="wrapper-xs text-center">\r\n                    <i class="iconfont icon-empty" style="font-size: 150pt"></i>\r\n\t\t\t\t\t<p class=m-t-sm>没有配置权限</p>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=col-sm-12 ng-show=error>\r\n\t\t\t\t<div class="wrapper-xs text-center">\r\n\t\t\t\t\t<i class="iconfont icon-error" style="font-size: 150pt"></i>\r\n\t\t\t\t\t<p class=m-t-sm>加载失败:{{error}}</p>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n           </div>\r\n           <div class="modal-footer text-left">\r\n           <div class="col-sm-4 no-padder">\r\n           \t<div class=input-group>\r\n\t\t\t\t<span class=input-group-addon>权限</span>\r\n\t\t\t    <select class="form-control wrapper-xs" ng-model=permissionId ng-change=update(current) ng-disabled=!current>\r\n\t\t\t\t\t<option ng-repeat="(k,v) in permissionMap" value={{k}} ng-selected="k == current.permissionId">{{v}}</option>\r\n\t\t\t\t</select>\r\n\t\t     </div>\r\n\t\t     </div>\r\n\t\t\t<div class=pull-right>\r\n\t\t\t\t<button class="btn btn-primary" ng-click=add()>\r\n\t           \t\t<i class="fa fa-user"></i> 添加\r\n\t           \t</button>\r\n\t           \t<button class="btn btn-default" ng-click=close()>\r\n\t           \t\t关闭\r\n\t           \t</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("asset/tpl/app/change_password.html",'<div class=app-ctrl style="padding-top:76px;overflow: hidden">\r\n\t<div class="b-b app-title-fixed padder">\r\n\t\t<div class="row wrapper-md bg-light">\r\n\t\t\t<div class="col-sm-9 col-xs-9 padder-sm">\r\n          \t\t<span class="m-n directory-header h3">\r\n          \t\t\t<i class="fa fa-key"></i>\r\n          \t\t\t修改密码\r\n          \t\t</span>\r\n\t\t\t</div>\r\n\t</div>\r\n\t</div>\r\n\t<div class="bg-light wrapper-xl lter app-inner">\r\n\t\t<form name=form class=w-xl method=post style="margin: 0 auto">\r\n\t\t\t<div ng-show=user.changePassword class="alert alert-warning alert-dismissable">\r\n\t\t\t\t您的密码为不安全的密码，系统强制要求修改\r\n\t\t\t</div>\r\n\t\t\t<div ng-show=success class="alert alert-success alert-dismissable">\r\n\t\t\t\t密码修改成功，下次登录使用新密码登录\r\n\t\t\t</div>\r\n\t\t\t<div ng-show=cause class="alert alert-danger alert-dismissable">\r\n\t\t\t\t密码修改失败：{{cause}}\r\n\t\t\t</div>\r\n\t\t\t<div class="input-group-icon m-b">\r\n\t\t\t  \t<i class="glyphicon glyphicon-lock input-icon"></i>\r\n\t\t\t  \t<input type=password name=oldPassword ng-model=oldPassword class=form-control placeholder=旧密码 required autofocus>\r\n\t\t\t</div>\r\n\t\t\t<div class="input-group-icon m-b">\r\n\t\t\t \t<i class="glyphicon glyphicon-lock input-icon"></i>\r\n\t\t\t\t<input type=password name=newPassword ng-model=newPassword class=form-control ng-change=check() ng-model-options="{updateOn: \'blur\'}" placeholder=新密码 required>\r\n\t\t\t\t<span class="help-block m-b-none text-xs text-danger" ng-show="newPassword.length < appSetting.minLengthOfPassword">密码长度不能小于{{appConfig.minLengthOfPassword}}位</span>\r\n\t\t\t\t<span class="help-block m-b-none text-xs text-danger" ng-show="strength < appSetting.passwordStrength">\r\n\t\t\t\t\t<span ng-if="appSetting.passwordStrength == 2">密码必须为数字和字母组合</span>\r\n\t\t\t\t\t<span ng-if="appSetting.passwordStrength == 3">密码必须为数字和字母组合，且必须含有大小写字母</span>\r\n\t\t\t\t\t<span ng-if="appSetting.passwordStrength == 4">密码必须为数字和字母组合，且必须含有大小写字母和特殊字符</span>\r\n\t\t\t\t</span>\t\t\t\t\t\r\n\t\t\t</div>\r\n\t\t\t<div class="input-group-icon m-b">\r\n\t\t\t \t<i class="glyphicon glyphicon-lock input-icon"></i>\r\n\t\t\t\t<input type=password name=confirmPassword ng-model=confirmPassword ng-model-options="{updateOn: \'blur\'}" class=form-control placeholder=密码确认 required>\r\n\t\t\t\t<span ng-show="confirmPassword && confirmPassword != newPassword" class="help-block m-b-none text-xs text-danger">两次密码不一致</span>\r\n\t\t\t</div>\r\n\t\t\t<div class=row style="margin-top: 8px">\r\n\t\t\t\t<div class="col-xs-12 col-sm-12 col-md-12">\r\n\t\t\t\t\t<button class="btn btn-primary btn-block" ng-click=submit() type=button ng-disabled="strength < appSetting.passwordStrength || form.$invalid || !form.$dirty || confirmPassword != newPassword || newPassword.length < appSetting.minLengthOfPassword">\r\n\t\t\t\t\t确&nbsp;&nbsp;定</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t\t\t\t\r\n</div>\r\n'),t.put("asset/tpl/app/copy.html",'<div class=m-c>\r\n\t<div class=modal-header>\r\n\t\t<h4 class=modal-title>\r\n\t\t\t复制文件(夹)\r\n\t\t</h4>\r\n\t</div>\r\n\t<div class="modal-body no-padder">\r\n\t\t<div class=permission-user-body>\r\n\t\t\t<div class="col-sm-12 permission-user-part b-r wrapper-sm">\r\n\t\t\t\t<div class=wrapper-xs>\r\n\t\t\t\t\t选择要复制到的位置\r\n\t\t\t\t</div>\r\n\t\t\t\t<hc-tree tree-control=tree load-asyn=true leaf-icon="fa fa-folder" on-node-dbl-click=select(node); on-selection-change=setTarget(selection); on-before-load=setParam(node,params); load-url=fs/folder>\r\n\t\t\t\t</hc-tree>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="wrapper-sm b-t row m-l-none m-r-none" ng-show=target>\r\n\t\t\t<b>将复制到：</b><span>{{paths}}</span>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class=modal-footer>\r\n\t\t<button type=button class="btn btn-primary" ng-click=ok() ng-disabled=!target>\r\n\t\t\t确定\r\n\t\t</button>\r\n\t\t<button type=button class="btn btn-default" ng-click=close()>取消</button>\r\n\t</div>\r\n</div>'),t.put("asset/tpl/app/directory_form.html",'<div class=m-c>\r\n\t<div class=modal-header>\r\n\t\t<h4 class=modal-title>新建文件夹</h4>\r\n\t</div>\r\n\t<div class="modal-body wrapper-lg">\r\n\t\t<div class=row>\r\n\t\t\t<div class=col-sm-12>\r\n\t\t\t\t<form name=directoryForm class="form-horizontal form-validation">\r\n\t\t\t\t\t<div class=form-group>\r\n\t\t\t\t\t\t<label class="col-sm-2 control-label text-right" style=padding-left:5px;padding-right:5px>名称：</label>\r\n\t\t\t\t\t\t<div class=col-sm-10>\r\n\t\t\t\t\t\t\t<input name=name ng-model=name required class=form-control>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class="line line-dashed b-b line-xs" ng-show=allowPrivate();></div>\r\n\t\t\t\t\t<div class="form-group m-b-none" ng-show=allowPrivate();>\r\n\t\t\t\t\t\t<label class="col-sm-2 control-label" style=padding-left:5px;padding-right:5px>是否公开：</label>\r\n\t\t\t\t\t\t<div class=col-sm-10>\r\n\t\t\t\t\t\t\t<label class="checkbox-inline i-checks"> \r\n\t\t\t\t\t\t\t\t<input type=radio name=type value=public ng-model=type><i></i>\r\n\t\t\t\t\t\t\t\t公开\r\n\t\t\t\t\t\t\t</label> \r\n\t\t\t\t\t\t\t<label class="checkbox-inline i-checks"> \r\n\t\t\t\t\t\t\t\t<input type=radio name=type value=private ng-model=type><i></i> \r\n\t\t\t\t\t\t\t\t不公开\r\n\t\t\t\t\t\t\t</label> \r\n\t\t\t\t\t\t\t<div ng-show="type ==\'public\'" class="alert alert-info m-b-none m-t-sm" role=alert>对所有成员可见</div>\r\n\t\t\t\t\t\t\t<div ng-show="type == \'private\'" class="alert alert-info m-b-none m-t-sm" role=alert>只对已授权的成员可见</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class=modal-footer style="text-align: right">\r\n\t\t<button type=button class="btn btn-primary" ng-click=ok() ng-disabled="(directoryForm.$invalid || !directoryForm.$dirty)">确定</button>\r\n\t\t<button type=button class="btn btn-default" ng-click=close()>取消</button>\r\n\t</div>\r\n</div>'),t.put("asset/tpl/app/directory.html",'<div class=app-ctrl style="padding-top:90px;overflow: hidden" ng-show=!error>\r\n    <div class="b-b app-title-fixed padder">\r\n        <div class="row wrapper-xs b-b bg-light">\r\n            <div class="col-sm-10 col-xs-10 padder-sm file-path" ui-sref-active=active>\r\n                <a ng-if="mountAlias == \'enterprise\'" ui-sref=\'directory({directory:"enterprise"})\'>\r\n                    <i class="fa fa-users"></i>\r\n                    <span>企业文档</span>\r\n                    <i ng-if=current class="fa fa-angle-right"></i>\r\n                </a>\r\n                <a ng-if="mountAlias == \'my\'" ui-sref=\'directory({directory:"my"})\'>\r\n                    <i class="fa fa-user"></i>\r\n                    <span>我的文档</span>\r\n                    <i ng-if=current class="fa fa-angle-right"></i>\r\n                </a>\r\n                <a ng-repeat="document in path" ui-sref=directory({directory:document.id})>\r\n                    <i class="fa fa-folder"></i>\r\n                    <span>{{document.name}}</span>\r\n                    <i class="fa fa-angle-right"></i>\r\n                </a>\r\n                <a ng-if=current ng-click=showDirectoryContextMenu(current,$event)>\r\n                    <i class="fa fa-folder"></i>\r\n                    <span>{{current.name}}</span>\r\n                    <i class="fa fa-angle-down"></i>\r\n                </a>\r\n                <span class="text-sm m-l-xs" ng-show="files.length > 0">\r\n\t\t\t\t\t( <span ng-show="selection.length > 0">{{selection.length}} / </span>{{files.length}} )\r\n\t\t\t\t</span>\r\n            </div>\r\n            <div class="col-sm-2 col-xs-2 text-right" style="padding-left: 0px;padding-right: 5px">\r\n                <div class=pull-right>\r\n                    <button ng-if="mode == \'list\'" class="btn btn-md btn-default" ng-click=switchMode() tooltip=切换到图标视图 tooltip-placement=bottom>\r\n                        <i class="glyphicon glyphicon-th-large"></i>\r\n                    </button>\r\n                    <button ng-if="mode == \'block\'" class="btn btn-md btn-default" ng-click=switchMode() tooltip=切换到列表视图 tooltip-placement=bottom>\r\n                        <i class="glyphicon glyphicon-menu-hamburger"></i>\r\n                    </button>\r\n                    <button ng-if=showTags class="btn btn-md btn-default" ng-click=switchShowTag() tooltip=隐藏标签 tooltip-placement=bottom>\r\n                        <i class="fa fa-tags"></i>\r\n                    </button>\r\n                    <button ng-if=!showTags class="btn btn-md btn-default" ng-click=switchShowTag() tooltip=显示标签 tooltip-placement=bottom>\r\n                        <i class="fa fa-tags"></i>\r\n                    </button>\r\n                    <div class=btn-group dropdown is-open=openSortmenu>\r\n                        <button type=button class="btn btn-md btn-default" ng-click=changeDesc();>\r\n                            <i ng-class="{\'fa-long-arrow-down\' : sortDesc,\'fa-long-arrow-up\':!sortDesc}" class=fa></i>\r\n                            <span ng-show="sortField == \'name\'">名称</span>\r\n                            <span ng-show="sortField == \'size\'">大小</span>\r\n                            <span ng-show="sortField == \'creationBy.name\'">创建者</span>\r\n                            <span ng-show="sortField == \'updateDate\'">时间</span>\r\n                        </button>\r\n                        <button type=button class="btn btn-md btn-default dropdown-toggle" dropdown-toggle>\r\n                            <span class=caret></span>\r\n                        </button>\r\n                        <ul class=dropdown-menu role=menu style="left: inherit; right: 0px">\r\n                            <li><a href ng-click="changeSort(\'name\')"> 名称 </a></li>\r\n                            <li><a href ng-click="changeSort(\'size\')"> 大小 </a></li>\r\n                            <li><a href ng-click="changeSort(\'creationBy.name\')"> 创建者 </a></li>\r\n                            <li><a href ng-click="changeSort(\'updateDate\')"> 时间 </a></li>\r\n                        </ul>\r\n                    </div>\r\n                    <button ng-if=current class="btn btn-md btn-default" ng-click=toggleDetail() tooltip=切换详情 tooltip-placement=bottom>\r\n                        <i class="glyphicon glyphicon-list"></i>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="row wrapper-xs bg-light lter">\r\n            <div class="col-sm-10 col-xs-10 padder-sm">\r\n                <div id=filePicker class="btn btn-primary" ng-show="ie9 && checkPermission(\'upload\')"></div>\r\n                <button class="btn btn-primary" onclick="Util.openSelectFileDialog(\'#uploadFile\')" ng-if="!ie9 " ng-show="checkPermission(\'upload\')">\r\n                    <i class="glyphicon glyphicon-cloud-upload"></i> 上传\r\n                </button>\r\n                <button class="btn btn-primary" ng-show="checkPermission(\'create\')" ng-click=createDirectory()>\r\n                    <i class="glyphicon glyphicon-plus"></i> 新建\r\n                </button>\r\n                <button class="btn btn-default" ng-click=showAuthorizer() ng-show="selection.length == 1 && canEditPermission(selection[0])">\r\n                    <i class="fa fa-users"></i> 协作者\r\n                </button>\r\n                <button class="btn btn-default" ng-if="checkPermission(\'download\')" ng-click=download() ng-show="selection.length == 1">\r\n                    <i class="glyphicon glyphicon-cloud-download"></i> 下载\r\n                </button>\r\n                <button class="btn btn-default" ng-show="selection.length > 0" ng-click=sendFile(selection);>\r\n                    <i class="fa fa-paper-plane"></i> 发送\r\n                </button>\r\n                <button class="btn btn-default" ng-show="selection.length == 1 && !selection[0].favoriteId" ng-click=addFavorite(selection[0],$event)>\r\n                    <i class="fa fa-star"></i> 收藏\r\n                </button>\r\n                <button class="btn btn-default" ng-show="selection.length == 1 && selection[0].favoriteId" ng-click=removeFavorite(selection[0],$event)>\r\n                    <i class="fa fa-star-o"></i> 取消收藏\r\n                </button>\r\n                <button class="btn btn-default" ng-if="checkPermission(\'remove\')" ng-click=remove() ng-show="selection.length > 0 && lockedSelectionCount == 0">\r\n                    <i class="glyphicon glyphicon glyphicon-trash"></i> 删除\r\n                </button>\r\n                <div class=btn-group dropdown is-open=moreMenuOpen ng-show="selection.length > 0">\r\n                    <button type=button class="btn btn-default dropdown-toggle" dropdown-toggle>\r\n                        <i class="fa fa-angle-down"></i>&nbsp;更多\r\n                    </button>\r\n                    <ul class=dropdown-menu role=menu>\r\n                        <li ng-if="checkPermission(\'rename\')" ng-click=rename(); ng-show="selection.length == 1">\r\n                            <a href> <i class="glyphicon glyphicon-edit"></i>&nbsp;重命名</a>\r\n                        </li>\r\n                        <li ng-if="checkPermission(\'copy\')" ng-click=copy() ng-show="selection.length > 0">\r\n                            <a href> <i class="glyphicon glyphicon-copy"></i>&nbsp;复制</a>\r\n                        </li>\r\n                        <li ng-if="checkPermission(\'move\')" ng-show="selection.length > 0 && isNonLocked()" ng-click=move()>\r\n                            <a href> <i class="fa fa-share-square-o"></i>&nbsp;移动</a>\r\n                        </li>\r\n                        <li ng-if="checkPermission(\'lock\')" ng-click=lock() ng-show="selection.length == 1 && selection[0].type == \'file\' && selection[0].locked !== true">\r\n                            <a href> <i class="fa fa-lock"></i>&nbsp;锁定</a>\r\n                        </li>\r\n                        <li ng-if="checkPermission(\'lock\')" ng-click=unlock() ng-show="selection.length == 1 && selection[0].locked === true && selection[0].lockedBy.id == user.id">\r\n                            <a href> <i class="fa fa-unlock"></i>&nbsp;解锁</a>\r\n                        </li>\r\n                        <li ng-if="checkPermission(\'edit\')" ng-click=setTag(selection[0]) ng-show="selection.length == 1">\r\n                            <a href> <i class="fa fa-tag"></i>&nbsp;标签</a>\r\n                        </li>\r\n                        <li ng-if="checkPermission(\'upload\')" ng-click=uploadNewVersion(selection[0]) ng-show="selection.length == 1 && selection[0].type == \'file\'  && isNonLocked()">\r\n                            <a href> <i class="glyphicon glyphicon-cloud-upload"></i>&nbsp;上传新版本</a>\r\n                        </li>\r\n                        <li ng-show="selection.length == 1" ng-click=share()>\r\n                            <a href> <i class="fa fa-link"></i>&nbsp;链接分享 </a>\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n            </div>\r\n            <div class="col-sm-2 col-xs-2 padder-sm">\r\n                <div class="input-group-icon directory-search">\r\n                    <i class="glyphicon glyphicon glyphicon-search input-icon"></i>\r\n                    <input ng-model=condition class="form-control rounded input-sm" placeholder=\'搜索"{{driectoryName}}"\'>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="bg-light lter w-full h-full directory-container" ng-click=onContainerClick();>\r\n        <div class="table-responsive file-list no-padder h-full directory-content" ng-right-click=showContainerContextMenu($event) ng-if="mode== \'list\'" ng-show="files.length > 0 && !loading">\r\n            <table class="table b-b b-light lter file-table">\r\n                <thead>\r\n                <tr>\r\n                    <th width=50px><label class="i-checks i-checks-sm m-b-none" ng-show=!condition>\r\n                        <input type=checkbox ng-click=selectAll() ng-checked=isSelectAll><i></i>\r\n                    </label></th>\r\n                    <th ng-click="changeSort(\'name\')">名称 <i ng-show="sortField == \'name\'" ng-class="{\'fa-caret-up\' : !sortDesc,\'fa-caret-down\':sortDesc}" class=fa> </i>\r\n                    </th>\r\n                    <th ng-click="changeSort(\'size\')" width=120px>大小 <i ng-show="sortField == \'size\'" ng-class="{\'fa-caret-up\' : !sortDesc,\'fa-caret-down\':sortDesc}" class=fa> </i>\r\n                    </th>\r\n                    <th ng-click="changeSort(\'creationBy.name\')" width=200px>创建者\r\n                        <i ng-show="sortField == \'creationBy.name\'" ng-class="{\'fa-caret-up\' : !sortDesc,\'fa-caret-down\':sortDesc}" class=fa> </i>\r\n                    </th>\r\n                    <th ng-click="changeSort(\'updateDate\')" width=200px>修改时间 <i ng-show="sortField == \'updateDate\'" ng-class="{\'fa-caret-up\' : !sortDesc,\'fa-caret-down\':sortDesc}" class=fa> </i>\r\n                    </th>\r\n                    <th width=150px></th>\r\n                </tr>\r\n                </thead>\r\n                <tbody>\r\n                <tr ng-repeat="file in files|orderBy:sortFields:sortDesc | filter:{name:condition,tags:condition}" class="file-item hc-item" ng-class="{true:\'active\'}[file.selected]" valign=middle ng-right-click=showContextMenu(file,$event)>\r\n                    <td width=5%>\r\n                        <label class="i-checks i-checks-sm m-b-none">\r\n                            <input type=checkbox ng-checked=file.selected ng-click=select(file,null,$event);><i></i>\r\n                        </label>\r\n                    </td>\r\n                    <td ng-click=select(file,null) class=text-ellipsis>\r\n                        <div class=pos-rlt>\r\n                            <div class=file-icon-wrapper>\r\n                                <img class=file-icon ng-src={{getIcon(file)}}>\r\n                            </div>\r\n                            <div class="pos-abt file-locker bg-primary rounded text-white" ng-if="file.locked === true" tooltip-placement=right tooltip={{file.lockedBy.name}}在{{file.lockDate}}锁定>\r\n                                <i class="fa fa-lock"></i>\r\n                            </div>\r\n                            <a ng-click=open(file,$event); class=pos-rlt title={{file.name}}>\r\n                                {{file.name}}\r\n                            </a>\r\n                            <div class="file-tags clearfix" ng-show="showTags && file.tags">\r\n                                <div class=i-tag ng-repeat="tag in file.tags.split(\',\') track by $index">\r\n                                    <span>{{tag}}</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </td>\r\n                    <td ng-click=select(file,null,$event)>{{file.size | formatSize}}</td>\r\n                    <td ng-click=select(file,null,$event)>\r\n                        <img ng-if=file.creationBy ng-src="{{file.creationBy.avatar | resource}}" class=img-circle style=height:30px;float:left alt=...>\r\n                        <span class=m-l-xs>{{file.creationBy.name}}</span>\r\n                    </td>\r\n                    <td ng-click=select(file,null,$event)>{{file.updateDate}}</td>\r\n                    <td class=text-center valign=middle ng-click=select(file,null,$event)>\r\n                        <i class="file-option-icon glyphicon glyphicon-cloud-download" tooltip=下载 ng-click=download(file)></i>\r\n                        <i class="file-option-icon fa fa-paper-plane" ng-click=sendFile(file) tooltip=发送></i>\r\n                        <i class="file-option-icon fa fa-star" ng-if=file.favoriteId ng-click=removeFavorite(file,$event) tooltip=取消收藏></i>\r\n                        <i class="file-option-icon fa fa-star-o" ng-if=!file.favoriteId ng-click=addFavorite(file,$event) tooltip=收藏></i>\r\n                        <i class="file-option-icon fa fa-ellipsis-h" tooltip=更多 ng-click=showContextMenu(file,$event)></i>\r\n                    </td>\r\n                </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n        <div ng-if="mode == \'block\'" ng-show="files.length > 0 && !loading" class="h-full directory-content" style=padding:15px ng-right-click=showContainerContextMenu($event)>\r\n            <ul class=file-block-list>\r\n                <li class="file-block pos-rlt" ng-class="{true:\'active\'}[file.selected]" ng-click=select(file,null,$event) ng-dblclick=open(file); ng-right-click=showContextMenu(file,$event) ng-repeat="file in files|orderBy:sortField:sortDesc | filter:{name:condition}">\r\n                    <img class=file-icon ng-src={{getIcon(file)}}>\r\n                    <div class="pos-abt file-locker bg-primary rounded text-white" ng-if="file.locked === true" tooltip-placement=right tooltip={{file.lockedBy.name}}在{{file.lockeDate}}锁定>\r\n                        <i class="fa fa-lock"></i>\r\n                    </div>\r\n                    <div class="file-name text-ellipsis m-t-sm" title={{file.name}} tooltip-placement=bottom>\r\n                        {{file.name}}\r\n                    </div>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n        <div class="wrapper-xl text-center directory-content" ng-show="(files.length == 0 || !files) && !loading">\r\n            <i class="iconfont icon-empty"></i>\r\n            <p class=m-t-md>该文件夹中没有文件</p>\r\n            <button class="btn btn-primary" onclick="Util.openSelectFileDialog(\'#uploadFile\')" ng-show="checkPermission(\'upload\')">\r\n                <i class="glyphicon glyphicon-cloud-upload"></i>上传文件\r\n            </button>\r\n        </div>\r\n        <div ng-show="current && openDetail && !loading" class="h-full no-padder b-l directory-detail" style="overflow: auto">\r\n            <tabset justified=true class="tab-container file-tab h-full">\r\n                <tab heading=详情>\r\n                    <div class="wrapper-sm text-center b-b">\r\n                        <img ng-src={{getIcon(current)}} style=max-height:80px>\r\n                        <p class="m-t-xs font-bold m-b-none" style=word-break:break-all>{{current.name}}</p>\r\n                        <div class="text-2x m-t-sm">\r\n                            <i ng-if=current.favoriteId ng-click=removeFavorite(current,$event); class="fa fa-star hover" tooltip=取消收藏></i>\r\n                            <i ng-if=!current.favoriteId ng-click=addFavorite(current,$event); class="fa fa-star-o hover" tooltip=收藏></i>\r\n                            <i class="glyphicon glyphicon-cloud-download m-r-sm hover" ng-click=download(current,$event) ng-show="checkPermission(\'download\')" tooltip=下载></i>\r\n                            <i class="fa fa-ellipsis-h m-r-sm hover" tooltip=更多 ng-click=showDirectoryContextMenu(current,$event)></i>\r\n                        </div>\r\n                    </div>\r\n                    <div class="wrapper-sm clearfix" style="line-height: 30px">\r\n                        <div class="col-sm-3 font-bold no-padder text-right m-t-xs">创建者:</div>\r\n                        <div class="col-sm-9 m-t-xs">\r\n                            <img ng-src="{{current.creationBy.avatar | resource}}" class=img-circle style=height:30px;float:left alt=...>\r\n                            <span class=m-l-xs>{{current.creationBy.name}}</span>\r\n                        </div>\r\n                        <div class="col-sm-3 font-bold no-padder text-right m-t-xs">创建时间:</div>\r\n                        <div class="col-sm-9 m-t-xs">{{current.createDate}}</div>\r\n                        <div class="col-sm-12 m-t-xs">\r\n                            <div class=i-tag style=line-height:1.42857143 ng-repeat="tag in current.tags.split(\',\') track by $index">\r\n                                <span>{{tag}}</span>\r\n                            </div>\r\n                            <span ng-if=!current.tags class=text-muted>没有设置标签</span>\r\n                            <i class="fa fa-tag hover" ng-if="checkPermission(\'edit\')" tooltip=设置标签 ng-click=setTag(current)></i>\r\n                        </div>\r\n                        <div class="col-sm-3 font-bold no-padder text-right m-t-xs">备注：</div>\r\n                        <div class="col-sm-9 m-t-xs hover-container" ng-if="checkPermission(\'edit\')">\r\n                            <span class=hover tooltip=点击编辑备注 ng-show="!descEditing && current.description" ng-click="descEditing=true">\r\n                                {{current.description}}\r\n                            </span>\r\n                            <span class="text-muted hover" tooltip=点击编辑备注 ng-show="!descEditing && !current.description" ng-click="descEditing = true">\r\n                                没有备注\r\n                            </span>\r\n                            <textarea ng-show=descEditing ng-model=current.description ng-blur="updateDesc();descEditing=false;" class="form-control m-t-xs" rows=5></textarea>\r\n                        </div>\r\n                        <div class="col-sm-9 m-t-xs hover-container" ng-if="!checkPermission(\'edit\')">\r\n                            <span ng-show=current.description>{{current.description}}</span>\r\n                            <span class=text-muted ng-show=!current.description>没有备注</span>\r\n                        </div>\r\n                    </div>\r\n                </tab>\r\n                <tab ng-if=canShowAuthorizer(current);>\r\n                    <tab-heading>协作者({{authorizes.length + 1}})</tab-heading>\r\n                    <div class="m-t-sm m-b-sm text-center" ng-if=canEditPermission(current);>\r\n                        <button class="btn btn-primary btn-sm" ng-click=addAuthorize()>\r\n                            <i class="fa fa-user"></i>&nbsp;添加协作者\r\n                        </button>\r\n                    </div>\r\n                    <div class="row m-n">\r\n                        <div class="col-md-12 permission-item wrapper-sm hover-bg">\r\n                            <img ng-src="{{user.avatar | resource}}" class="img-circle pull-left" style=height:40px alt=...>\r\n                            <div class=inline>\r\n                                <div class=m-l-sm style="line-height: 25px">{{current.creationBy.name}}</div>\r\n                                <div class="m-l-sm text-xs text-muted" style="line-height: 10px">\r\n                                    创建者\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div class="col-md-12 permission-item wrapper-sm hover-bg" ng-repeat="authorize in authorizes | filter:{ownerType:2}">\r\n                            <button type=button class=close ng-if="!authorize.inherited && canEditPermission(current);" ng-click=removeAuthorize(authorize,$event)>\r\n                                <span aria-hidden=true>×</span>\r\n                            </button>\r\n                            <img src=asset/img/group.png class="img-circle pull-left" style=height:40px alt=...>\r\n                            <div class=inline>\r\n                                <div class=m-l-sm style="line-height: 25px">{{authorize.name}}</div>\r\n                                <div class="m-l-sm text-xs text-muted" style="line-height: 10px">\r\n                                    <div class=hover ng-if=canEditPermission(current); tooltip=点击修改权限 ng-click=showPermissionContextMenu(authorize,$event)>\r\n                                        {{authorize.permissionName}}<span ng-if=authorize.inherited>(继承)</span>&nbsp;&nbsp;\r\n                                        <span><i class="fa fa-angle-down"></i></span>\r\n                                    </div>\r\n                                    <div class=hover ng-if=!canEditPermission(current);>\r\n                                        {{authorize.permissionName}}<span ng-if=authorize.inherited>(继承)</span>&nbsp;&nbsp;\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div class="col-md-12 permission-item wrapper-sm hover-bg" ng-repeat="authorize in authorizes | filter:{ownerType:1} ">\r\n                            <button type=button class=close ng-if="!authorize.inherited && canEditPermission(current);" ng-click=removeAuthorize(authorize,$event)>\r\n                                <span aria-hidden=true>×</span>\r\n                            </button>\r\n                            <img ng-src="{{user.avatar | resource}}" class="img-circle pull-left" style=height:40px alt=...>\r\n                            <div class=inline>\r\n                                <div class=m-l-sm style="line-height: 25px">{{authorize.name}}</div>\r\n                                <div class="m-l-sm text-xs text-muted" style="line-height: 10px">\r\n                                    <div class=hover ng-if=canEditPermission(current); tooltip=点击修改权限 ng-click=showPermissionContextMenu(authorize,$event)>\r\n                                        {{authorize.permissionName}}<span ng-if=authorize.inherited>(继承)</span>&nbsp;&nbsp;\r\n                                        <span><i class="fa fa-angle-down"></i></span>\r\n                                    </div>\r\n                                    <div ng-if=!canEditPermission(current);>\r\n                                        {{authorize.permissionName}}<span ng-if=authorize.inherited>(继承)</span>&nbsp;&nbsp;\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </tab>\r\n                <tab class=h-full>\r\n                    <tab-heading>动态({{activities.length}})</tab-heading>\r\n                    <div class=text-center ng-if="activities.length == 0 || !activities">\r\n                        <i class="iconfont icon-empty" style="font-size: 90pt"></i>\r\n                        <div>暂时没有动态</div>\r\n                    </div>\r\n                    <div class=wrapper>\r\n                        <ul class=timeline>\r\n                            <li class=tl-item ng-repeat="act in activities">\r\n                                <div class="tl-wrap b-primary" style="margin-left: 0px">\r\n                                    <div class="tl-content panel padder b-a w-md w-auto-xs">\r\n                                        <span class="arrow left pull-up"></span>\r\n                                        <div class="text-lt m-b-sm">{{act.operateDate}}</div>\r\n                                        <div class="panel-body b-t pull-in b-light" style=padding:10px>\r\n                                            <div class=media>\r\n                                                <div class=media-left>\r\n                                                    <a href=#>\r\n                                                        <img class="media-object avatar" style=height:40px ng-src="{{act.operator.avatar | resource}}" alt=...>\r\n                                                    </a>\r\n                                                </div>\r\n                                                <div class=media-body>\r\n                                                    <p class="media-heading line-xs l-h">{{act.operator.name}}</p>\r\n                                                    <div ng-if="act.operation === \'create\'">\r\n                                                        <div class=text-muted>\r\n                                                            创建了文件夹\r\n                                                        </div>\r\n                                                        <div class=text-muted>\r\n                                                            <a ui-sref=directory({directory:act.document.id})>\r\n                                                                <img src=asset/img/public_folder.png style="height: 15px">\r\n                                                                <span style="line-height: 20px">{{act.document.name}}</span>\r\n                                                            </a>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'upload\'">\r\n                                                        <div class=text-muted>\r\n                                                            上传了文件\r\n                                                        </div>\r\n                                                        <div class="text-muted text-ellipsis">\r\n                                                            <a ng-click=open(act.document) tooltip={{act.document.name}}>\r\n                                                                <img ng-src={{getIcon(act.document)}} style="height: 15px">\r\n                                                                <span style="line-height: 20px">{{act.document.name}}</span>\r\n                                                            </a>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'lock\'">\r\n                                                        <div class=text-muted>\r\n                                                            锁定了文件\r\n                                                        </div>\r\n                                                        <div class="text-muted text-ellipsis">\r\n                                                            <a ng-click=open(act.document) tooltip={{act.document.name}}>\r\n                                                                <img ng-src={{getIcon(act.document)}} style="height: 15px">\r\n                                                                <span style="line-height: 20px">{{act.document.name}}</span>\r\n                                                            </a>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'unlock\'">\r\n                                                        <div class=text-muted>\r\n                                                            锁定了文件\r\n                                                        </div>\r\n                                                        <div class="text-muted text-ellipsis">\r\n                                                            <a ng-click=open(act.document) tooltip={{act.document.name}}>\r\n                                                                <img ng-src={{getIcon(act.document)}} style="height: 15px">\r\n                                                                <span style="line-height: 20px">{{act.document.name}}</span>\r\n                                                            </a>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'rename\'">\r\n                                                        <div class=text-muted>\r\n                                                            重命名了文件\r\n                                                        </div>\r\n                                                        <div class="text-muted text-ellipsis">\r\n                                                            <div class=m-t-xs>\r\n                                                                <a ng-click=open(act.document) tooltip={{act.document.name}}>\r\n                                                                    <img ng-src={{getIcon(act.document)}} style="height: 15px">\r\n                                                                    <span style="line-height: 20px">{{act.document.name}}</span>\r\n                                                                </a>\r\n                                                            </div>\r\n                                                            <div class=m-t-xs>原名：{{act.change.originalName}}</div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'remove\'">\r\n                                                        <div class=text-muted>\r\n                                                            删除了文件\r\n                                                        </div>\r\n                                                        <div class="text-muted text-ellipsis">\r\n                                                            <a ng-click=open(act.document) tooltip={{act.document.name}}>\r\n                                                                <img ng-src={{getIcon(act.document)}} style="height: 15px">\r\n                                                                <span style="line-height: 20px">{{act.document.name}}</span>\r\n                                                            </a>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'delete\'">\r\n                                                        <div class=text-muted>\r\n                                                            彻底删除了文件\r\n                                                        </div>\r\n                                                        <div class="text-muted text-ellipsis">\r\n                                                            <a ng-click=open(act.document) tooltip={{act.document.name}}>\r\n                                                                <img ng-src={{getIcon(act.document)}} style="height: 15px">\r\n                                                                <span style="line-height: 20px">{{act.document.name}}</span>\r\n                                                            </a>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'revert\'">\r\n                                                        <div class=text-muted>\r\n                                                            恢复了文件\r\n                                                        </div>\r\n                                                        <div class="text-muted text-ellipsis">\r\n                                                            <a ng-click=open(act.document) tooltip={{act.document.name}}>\r\n                                                                <img ng-src={{getIcon(act.document)}} style="height: 15px">\r\n                                                                <span style="line-height: 20px">{{act.document.name}}</span>\r\n                                                            </a>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'moveIn\'">\r\n                                                        <div class=text-muted>\r\n                                                            移入了文件\r\n                                                        </div>\r\n                                                        <div class="text-muted text-ellipsis">\r\n                                                            <a ng-click=open(act.document) tooltip={{act.document.name}}>\r\n                                                                <img ng-src={{getIcon(act.document)}} style="height: 15px">\r\n                                                                <span style="line-height: 20px">{{act.document.name}}</span>\r\n                                                            </a>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'moveOut\'">\r\n                                                        <div class=text-muted>\r\n                                                            移出了文件\r\n                                                        </div>\r\n                                                        <div class="text-muted text-ellipsis">\r\n                                                            <a ng-click=open(act.document) tooltip={{act.document.name}}>\r\n                                                                <img ng-src={{getIcon(act.document)}} style="height: 15px">\r\n                                                                <span style="line-height: 20px">{{act.document.name}}</span>\r\n                                                            </a>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'download\'">\r\n                                                        <div class=text-muted>\r\n                                                            下载了文件\r\n                                                        </div>\r\n                                                        <div class="text-muted text-ellipsis">\r\n                                                            <a ng-click=open(act.document) tooltip={{act.document.name}}>\r\n                                                                <img ng-src={{getIcon(act.document)}} style="height: 15px">\r\n                                                                <span style="line-height: 20px">{{act.document.name}}</span>\r\n                                                            </a>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'addReview\'">\r\n                                                        <div class=text-muted>\r\n                                                            评论了文件\r\n                                                        </div>\r\n                                                        <div class="text-muted text-ellipsis">\r\n                                                            <div class=m-t-xs>\r\n                                                                <a ng-click=open(act.document) tooltip={{act.document.name}}>\r\n                                                                    <img ng-src={{getIcon(act.document)}} style="height: 15px">\r\n                                                                    <span style="line-height: 20px">{{act.document.name}}</span>\r\n                                                                </a>\r\n                                                            </div>\r\n                                                            <div class=m-t-xs>\r\n                                                                {{act.content}}\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'removeReview\'">\r\n                                                        <div class=text-muted>\r\n                                                            删除了文件的评论\r\n                                                        </div>\r\n                                                        <div class="text-muted text-ellipsis">\r\n                                                            <div class=m-t-xs>\r\n                                                                <a ng-click=open(act.document) tooltip={{act.document.name}}>\r\n                                                                    <img ng-src={{getIcon(act.document)}} style="height: 15px">\r\n                                                                    <span style="line-height: 20px">{{act.document.name}}</span>\r\n                                                                </a>\r\n                                                            </div>\r\n                                                            <div class=m-t-xs>{{act.content}}</div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'setTags\'">\r\n                                                        <div class=text-muted>\r\n                                                            设置了文件的标签\r\n                                                        </div>\r\n                                                        <div class="text-muted text-ellipsis">\r\n                                                            <a ng-click=open(act.document) tooltip={{act.document.name}}>\r\n                                                                <img ng-src={{getIcon(act.document)}} style="height: 15px">\r\n                                                                <span style="line-height: 20px">{{act.document.name}}</span>\r\n                                                            </a>\r\n                                                            <div class=m-t-xs>{{act.tags.currentTags}}</div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'addAuthorize\'">\r\n                                                        <div class="text-muted text-ellipsis">\r\n                                                            添加了文件\r\n                                                            <div>\r\n                                                                <a ng-click=open(act.document) tooltip={{act.document.name}}>\r\n                                                                    <img ng-src={{getIcon(act.document)}} style="height: 15px">\r\n                                                                    <span style="line-height: 20px">{{act.document.name}}</span>\r\n                                                                </a>\r\n                                                            </div>\r\n                                                            <div class=m-t-xs>的协作者</div>\r\n                                                        </div>\r\n                                                        <div class=text-muted>\r\n                                                            <img ng-src="{{act.authorize.ownerAvatar  || \'asset/img/group.png\'}}" style="height: 20px">\r\n                                                            <span style="line-height: 20px">{{act.authorize.ownerName}}({{act.authorize.currentPermission}})</span>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'removeAuthorize\'">\r\n                                                        <div class="text-muted text-ellipsis">\r\n                                                            删除了文件\r\n                                                            <div>\r\n                                                                <a ng-click=open(act.document) tooltip={{act.document.name}}>\r\n                                                                    <img ng-src={{getIcon(act.document)}} style="height: 15px">\r\n                                                                    <span style="line-height: 20px">{{act.document.name}}</span>\r\n                                                                </a>\r\n                                                            </div>\r\n                                                            <div class=m-t-xs>的协作者</div>\r\n                                                        </div>\r\n                                                        <div class=text-muted>\r\n                                                            <img ng-src="{{act.authorize.ownerAvatar || \'asset/img/group.png\'}}" style="height: 20px">\r\n                                                            <span style="line-height: 20px">{{act.authorize.ownerName}}({{act.authorize.currentPermission}})</span>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'updateAuthorize\'">\r\n                                                        <div class="text-muted text-ellipsis">\r\n                                                            修改了文件\r\n                                                            <div>\r\n                                                                <a ng-click=open(act.document) tooltip={{act.document.name}}>\r\n                                                                    <img ng-src={{getIcon(act.document)}} style="height: 15px">\r\n                                                                    <span style="line-height: 20px">{{act.document.name}}</span>\r\n                                                                </a>\r\n                                                            </div>\r\n                                                            <p>协作者的权限</p>\r\n                                                        </div>\r\n                                                        <div class=text-muted>\r\n                                                            <div>\r\n                                                                <img ng-src="{{act.authorize.ownerAvatar  || \'asset/img/group.png\'}}" style="height: 20px">\r\n                                                                <span style="line-height: 20px">{{act.authorize.ownerName}}({{act.authorize.currentPermission}})</span>\r\n                                                            </div>\r\n                                                            <div class=m-t-xs>\r\n                                                                原权限：{{act.authorize.originalPermission}}\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'updateDesc\'">\r\n                                                        <div class="text-muted text-ellipsis">\r\n                                                            修改了文件\r\n                                                            <div>\r\n                                                                <a ng-click=open(act.document) tooltip={{act.document.name}}>\r\n                                                                    <img ng-src={{getIcon(act.document)}} style="height: 15px">\r\n                                                                    <span style="line-height: 20px">{{act.document.name}}</span>\r\n                                                                </a>\r\n                                                            </div>\r\n                                                            <p>的备注</p>\r\n                                                        </div>\r\n                                                        <div class=text-muted>\r\n                                                            <div class=m-t-xs>\r\n                                                                现备注：{{act.description.currentDescription}}\r\n                                                            </div>\r\n                                                            <div class=m-t-xs>\r\n                                                                原备注：{{act.description.originalDescription}}\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </li>\r\n                        </ul>\r\n                    </div>\r\n                </tab>\r\n            </tabset>\r\n        </div>\r\n        <div class="wrapper-xl text-center" style="flex: 1" ng-show=loading>\r\n            <img ng-src="{{\'asset/img/loading.gif\' | resource}}">\r\n            <p class=m-t-sm>正在加载</p>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class="wrapper-xl text-center" ng-show=error>\r\n    <i class="iconfont icon-error"></i>\r\n    <p class=m-t-md>加载文件夹失败：{{error}}</p>\r\n</div>\r\n<ul id=directoryOperationContextMenu class=dropdown-menu role=menu>\r\n    <li ng-show="selected.id != current.id" ng-click=open(selected)>\r\n        <a tabindex=-1 href="">\r\n            打开\r\n        </a>\r\n    </li>\r\n    <li>\r\n        <a tabindex=-1 href="" ng-click=download(selected)>\r\n            下载\r\n        </a>\r\n    </li>\r\n    <li ng-click=move(selected)>\r\n        <a tabindex=-1 href="">\r\n            移动\r\n        </a>\r\n    </li>\r\n    <li ng-click=copy(selected) ng-show="checkPermission(\'copy\')">\r\n        <a tabindex=-1 href="">\r\n            复制\r\n        </a>\r\n    </li>\r\n    <li ng-click=rename(selected) ng-show="checkPermission(\'rename\')">\r\n        <a tabindex=-1 href="">\r\n            重命名\r\n        </a>\r\n    </li>\r\n    <li ng-if="checkPermission(\'lock\')" ng-click=lock(selected) ng-show="selected.type == \'file\' && selected.locked !== true">\r\n        <a tabindex=-1 href="">\r\n            锁定\r\n        </a>\r\n    </li>\r\n    <li ng-if="checkPermission(\'lock\')" ng-click=unlock(selected) ng-show="selected.locked === true && selected.lockedBy.id == user.id">\r\n        <a tabindex=-1 href="">\r\n            解锁\r\n        </a>\r\n    </li>\r\n    <li ng-click=uploadNewVersion(selected) ng-show="selected.type == \'file\' && checkPermission(\'upload\')">\r\n        <a tabindex=-1 href="">\r\n            上传新版本\r\n        </a>\r\n    </li>\r\n    <li ng-click=remove(selected) ng-show="checkPermission(\'remove\')">\r\n        <a tabindex=-1 href="">\r\n            删除\r\n        </a>\r\n    </li>\r\n    <li ng-if="checkPermission(\'edit\')" ng-click=setTag(selected)>\r\n        <a href>设置标签</a>\r\n    </li>\r\n    <li ng-click=showAuthorizer(selected) ng-show=canEditPermission(selected)>\r\n        <a tabindex=-1 href="">\r\n            协作者\r\n        </a>\r\n    </li>\r\n    <li class=dropdown-submenu>\r\n        <a tabindex=-1 href="">\r\n            分享\r\n            <span class="pull-right m-r-n-md">\r\n\t       \t \t<i class="fa fa-fw fa-angle-right text"></i>\r\n\t      \t</span>\r\n        </a>\r\n        <ul class=dropdown-menu role=menu style=left:-100%>\r\n            <li ng-click=sendFile(selected)><a href> 发送给同事 </a></li>\r\n            <li ng-click=share(selected)>\r\n                <a href> 链接分享 </a>\r\n            </li>\r\n        </ul>\r\n    </li>\r\n</ul>\r\n\r\n<ul id=containerContextMenu class=dropdown-menu role=menu>\r\n    <li ng-click=createDirectory() ng-show="checkPermission(\'create\')">\r\n        <a tabindex=-1 href="">\r\n            新建\r\n        </a>\r\n    </li>\r\n    <li class=dropdown-submenu ng-show="supportWebkitDirectory && checkPermission(\'upload\') && checkPermission(\'create\')">\r\n        <a tabindex=-1 href="">\r\n            上传\r\n            <span class="pull-right m-r-n-md">\r\n\t       \t \t<i class="fa fa-fw fa-angle-right text"></i>\r\n\t      \t</span>\r\n        </a>\r\n        <ul class=dropdown-menu role=menu>\r\n            <li onclick="Util.openSelectFileDialog(\'#uploadFile\')">\r\n                <a tabindex=-1 href="">\r\n                    上传文件\r\n                </a>\r\n            </li>\r\n            <li onclick="Util.openSelectFileDialog(\'#uploadFile\')">\r\n                <a tabindex=-1 href="">\r\n                    上传文件夹\r\n                </a>\r\n            </li>\r\n        </ul>\r\n    </li>\r\n    <li onclick="Util.openSelectFileDialog(\'#uploadFile\')" ng-if="!supportWebkitDirectory || (checkPermission(\'upload\') && !checkPermission(\'create\'))">\r\n        <a tabindex=-1 href="">\r\n            上传\r\n        </a>\r\n    </li>\r\n\r\n    <li class=dropdown-submenu>\r\n        <a tabindex=-1 href="">\r\n            查看\r\n            <span class="pull-right m-r-n-md">\r\n\t       \t \t<i class="fa fa-fw fa-angle-right text"></i>\r\n\t      \t</span>\r\n        </a>\r\n        <ul class=dropdown-menu role=menu>\r\n            <li ng-click="switchMode(\'list\')">\r\n                <a tabindex=-1 href="">\r\n                    <i class=fa ng-class="{true:\'fa-dot-circle-o\',false:\'fa-circle-o\'}[mode == \'list\']"></i> 列表模式\r\n                </a>\r\n            </li>\r\n            <li ng-click="switchMode(\'block\')">\r\n                <a tabindex=-1 href="">\r\n                    <i class=fa ng-class="{true:\'fa-dot-circle-o\',false:\'fa-circle-o\'}[mode == \'block\']"></i> 图标模式\r\n                </a>\r\n            </li>\r\n        </ul>\r\n    </li>\r\n    <li class=dropdown-submenu>\r\n        <a tabindex=-1 href="">\r\n            排序\r\n            <span class="pull-right m-r-n-md">\r\n\t       \t \t<i class="fa fa-fw fa-angle-right text"></i>\r\n\t      \t</span>\r\n        </a>\r\n        <ul class=dropdown-menu role=menu>\r\n            <li ng-click="changeSort(\'name\')">\r\n                <a tabindex=-1 href="">\r\n                    <i class=fa ng-class="{true:\'fa-dot-circle-o\',false:\'fa-circle-o\'}[sortField == \'name\']"></i> 名称\r\n                </a>\r\n            </li>\r\n            <li ng-click="changeSort(\'size\')">\r\n                <a tabindex=-1 href="">\r\n                    <i class=fa ng-class="{true:\'fa-dot-circle-o\',false:\'fa-circle-o\'}[sortField == \'size\']"></i> 大小\r\n                </a>\r\n            </li>\r\n            <li ng-click="changeSort(\'creationBy.name\')">\r\n                <a tabindex=-1 href="">\r\n                    <i class=fa ng-class="{true:\'fa-dot-circle-o\',false:\'fa-circle-o\'}[sortField == \'creationBy.name\']"></i> 创建者\r\n                </a>\r\n            </li>\r\n            <li ng-click="changeSort(\'updateDate\')">\r\n                <a tabindex=-1 href="">\r\n                    <i class=fa ng-class="{true:\'fa-dot-circle-o\',false:\'fa-circle-o\'}[sortField == \'updateDate\']"></i> 时间\r\n                </a>\r\n            </li>\r\n        </ul>\r\n    </li>\r\n    <li role=separator class=divider></li>\r\n    <li ng-click=reload()>\r\n        <a tabindex=-1 href="">\r\n            刷新\r\n        </a>\r\n    </li>\r\n</ul>\r\n\r\n<ul id=permissionContextMenu class=dropdown-menu role=menu>\r\n    <li ng-repeat="permission in permissions" ng-click=updatePermission(permission,$event)>\r\n        <a tabindex=-1 href="">\r\n            {{permission.name}}\r\n        </a>\r\n    </li>\r\n</ul>'),t.put("asset/tpl/app/document.html",'<div class="wrapper-xl text-center" ng-show=loading>\r\n    <img ng-src="{{\'asset/img/loading.gif\' | resource}}">\r\n    <p class=m-t-sm>正在加载...</p>\r\n</div>\r\n<div class="wrapper-xl text-center" ng-show=error>\r\n    <i class="iconfont icon-error"></i>\r\n    <p class="">{{error}}</p>\r\n    <button class="btn btn-default" ng-click=close()>\r\n        <i class="glyphicon glyphicon-chevron-left"></i>返回\r\n    </button>\r\n</div>\r\n<div class="m-c h-full" ng-show="!loading && !error" style="overflow: hidden" ng-click=onContainerClick()>\r\n    <div class="modal-header pos-fix w-full wrapper-sm bg-primary text-white" style=z-index:99>\r\n        <div class="navbar-header pull-right fild-detail-toolbar">\r\n            <button class="pull-right hover" ng-click=close(); tooltip=关闭 tooltip-placement=bottom>\r\n                <i class="glyphicon glyphicon-remove"></i>\r\n            </button>\r\n            <button class="pull-right hover" ng-click="hiddenDetail = !hiddenDetail" tooltip=切换详情栏 tooltip-placement=bottom>\r\n                <i class="glyphicon glyphicon-align-justify"></i>\r\n            </button>\r\n            <button class="pull-right hover" ng-click=fullScreen(); ng-show=supportFullScreen tooltip=全屏 tooltip-placement=bottom>\r\n                <i class="glyphicon glyphicon-resize-full"></i>\r\n            </button>\r\n        </div>\r\n        <h4 class=modal-title style="line-height: 34px">\r\n            <img ng-src={{file.icon}} style="max-height: 30px;max-width: 30px; margin-top: -2px">\r\n            <span class=m-l-xs> {{current.name}}</span>\r\n        </h4>\r\n\r\n    </div>\r\n    <div class="modal-body h-full" style="padding: 55px 0px 0px 0px">\r\n        <div id=file-preview-container class="h-full no-padder bg-light" ng-class="{\'col-sm-12\':hiddenDetail,\'col-sm-9\':!hiddenDetail}">\r\n            <div ng-if="current.media == \'image\'" class="h-full text-center file-image-container">\r\n                <div class="file-image-wrapper w-full h-full wrapper-xl">\r\n                    <img ng-src={{geImageSrc(current)}} ng-class="{\'file-image-fill\':!full}" style=transform:rotate({{deg}}deg)>\r\n                </div>\r\n                <div class="file-image-tools b">\r\n                    <button class=hover tooltip=原始大小 ng-show=!full ng-click="full = !full">\r\n                        <i class="glyphicon glyphicon-resize-full"></i>\r\n                    </button>\r\n                    <button class=hover tooltip=自适应 ng-show=full ng-click="full = !full">\r\n                        <i class="glyphicon glyphicon-resize-small"></i>\r\n                    </button>\r\n                    <button class=hover tooltip=旋转 ng-click=rotate()>\r\n                        <i class="glyphicon glyphicon-repeat"></i>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n            <div ng-if="current.media == \'code\'" ui-codemirror=cmOption ng-model=raw class=h-full>\r\n            </div>\r\n            <div ng-if="current.media == \'pdf\'" class=h-full>\r\n                <iframe ng-src={{getPdfViewerUrl(current)}} width=100% height=100% frameborder=0 scrolling=yes></iframe>\r\n            </div>\r\n            <div ng-if="current.media == \'office\'" class=h-full>\r\n                <iframe ng-src={{getPreviewUrl(current)}} width=100% height=100% frameborder=0 scrolling=yes></iframe>\r\n            </div>\r\n            <div ng-if="current.media == \'unknow\'" class="h-full wrapper-xl text-center">\r\n                <img ng-src="{{\'asset/img/info.png\' | resource}}" style="height: 180px">\r\n                <p>该文件不支持在线预览，请下载后在本地打开</p>\r\n                <button class="btn btn-default" ng-click=download()>\r\n                    <i class="glyphicon glyphicon-cloud-download"></i> 下载\r\n                </button>\r\n            </div>\r\n        </div>\r\n        <div class="no-padder b-l h-full wrapper-sm" ng-class="{\'hidden\':hiddenDetail,\'col-sm-3\':!hiddenDetail}" style="overflow: auto">\r\n            <tabset justified=true class="tab-container file-tab">\r\n                <tab heading=详情>\r\n                    <div class="wrapper-sm text-center b-b">\r\n                        <img ng-src={{current.icon}} style=max-height:80px>\r\n                        <p class="m-t-xs font-bold m-b-none" style=word-break:break-all>{{current.name}}</p>\r\n                        <div class="text-2x m-t-sm">\r\n                            <i ng-if="checkPermission(\'lock\')" ng-show="current.current && current.locked !== true" ng-click=lock(); class="fa fa-lock hover" tooltip=锁定></i>\r\n                            <i ng-if="checkPermission(\'lock\')" ng-show="current.current && current.locked === true && current.lockedBy.id == user.id" class="fa fa-unlock-alt hover" tooltip=解锁 ng-click=unlock();></i>\r\n                            <i ng-if="favorited && current.current" ng-click=removeFavorite(); class="fa fa-star hover" tooltip=取消收藏></i>\r\n                            <i ng-if="!favorited && current.current" ng-click=addFavorite(); class="fa fa-star-o hover hover" tooltip=收藏></i>\r\n                            <i class="glyphicon glyphicon-cloud-download m-r-sm hover" ng-click=download() ng-show="checkPermission(\'download\')" tooltip=下载></i>\r\n                            <i class="fa fa-ellipsis-h m-r-sm hover" tooltip=更多 ng-click=showDocumentContextMenu(current,$event)></i>\r\n                        </div>\r\n\r\n                    </div>\r\n                    <div class="wrapper-sm clearfix" style="line-height: 30px">\r\n                        <div class="col-sm-4 font-bold text-right m-t-xs">文件大小:</div>\r\n                        <div class="col-sm-8 m-t-xs">{{current.size | formatSize}}</div>\r\n                        <div class="col-sm-4 font-bold text-right m-t-xs">创建者:</div>\r\n                        <div class="col-sm-8 m-t-xs">\r\n                            <img ng-src="{{current.creationBy.avatar | resource}}" class=img-circle style=height:30px;float:left alt=...>\r\n                            <span class=m-l-xs>{{current.creationBy.name}}</span>\r\n                        </div>\r\n                        <div class="col-sm-4 font-bold text-right m-t-xs">创建时间:</div>\r\n                        <div class="col-sm-8 m-t-xs">{{current.createDate}}</div>\r\n                        <div class="col-sm-4 font-bold text-right m-t-xs">标签:</div>\r\n                        <div class="col-sm-8 m-t-xs">\r\n                            <div class=i-tag style=line-height:1.42857143 ng-repeat="tag in current.tags.split(\',\') track by $index">\r\n                                <span>{{tag}}</span>\r\n                            </div>\r\n                            <span ng-if=!file.tags class=text-muted>没有设置标签</span>\r\n                            <i class="fa fa-tag hover" ng-if="checkPermission(\'edit\')" tooltip=设置标签 ng-click=setTag(current)></i>\r\n                        </div>\r\n                        <div class="col-sm-4 font-bold no-padder text-right m-t-xs">备注：</div>\r\n                        <div class="col-sm-8 m-t-xs hover-container" ng-if="checkPermission(\'edit\')">\r\n                            <span class=hover tooltip=点击编辑备注 ng-show="!descEditing && current.description" ng-click="descEditing=true">\r\n                                {{current.description}}\r\n                            </span>\r\n                            <span class="text-muted hover" tooltip=点击编辑备注 ng-show="!descEditing && !current.description" ng-click="descEditing = true">\r\n                                    没有备注\r\n                            </span>\r\n                            <textarea ng-show=descEditing ng-model=current.description ng-blur="updateDescription(current);descEditing=false;" class="form-control m-t-xs" rows=5></textarea>\r\n                        </div>\r\n                        <div class="col-sm-8 m-t-xs hover-container" ng-if="!checkPermission(\'edit\')">\r\n                            <span ng-show=current.description>{{current.description}}</span>\r\n                            <span class=text-muted ng-show=!current.description>没有备注</span>\r\n                        </div>\r\n                    </div>\r\n                </tab>\r\n                <tab>\r\n                    <tab-heading>\r\n                        评论({{reviews.length}})\r\n                    </tab-heading>\r\n                    <div class="wrapper-sm b-b">\r\n                        <form name=reviewForm>\r\n                            <textarea ng-model=reviewContent name=reviewContent class=form-control rows=3></textarea>\r\n                            <div class="text-right m-t-sm">\r\n                                <button class="btn btn-primary" ng-disabled=!reviewContent ng-click=addReview(reviewContent)>发表\r\n                                </button>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                    <div class="file-review b-b wrapper-sm hover-bg" ng-repeat="review in reviews">\r\n                        <a href title=删除评论 class=close ng-click=removeReview(review) ng-if="review.reviewer == user.id">×</a>\r\n                        <div class=file-review-head>\r\n                            <img ng-src="{{ review.avatar | resource }}" class=rounded>\r\n                            <div class=file-review-user>\r\n                                <div>{{review.name}}</div>\r\n                                <div class="text-muted text-sm">\r\n                                    <i class="fa fa-clock-o"></i> {{review.reviewDate}}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div class="m-t-xs file-review-content">\r\n                            {{review.content}}\r\n                        </div>\r\n                    </div>\r\n                </tab>\r\n                <tab heading="">\r\n                    <tab-heading>\r\n                        版本\r\n                    </tab-heading>\r\n                    <div class="wrapper-sm text-center">\r\n                        <i class="iconfont icon-info" style="font-size: 90pt"></i>\r\n                        <div>社区版不支持多版本</div>\r\n                    </div>\r\n                </tab>\r\n                <tab>\r\n                    <tab-heading>动态({{activities.length}})</tab-heading>\r\n                    <div class=text-center ng-if="activities.length == 0 || !activities">\r\n                        <i class="iconfont icon-empty" style="font-size: 90pt"></i>\r\n                        <div>暂时没有动态</div>\r\n                    </div>\r\n                    <div class=wrapper>\r\n                        <ul class=timeline>\r\n                            <li class=tl-item ng-repeat="act in activities">\r\n                                <div class="tl-wrap b-primary" style="margin-left: 0px">\r\n                                    <div class="tl-content panel padder b-a w-auto-xs">\r\n                                        <span class="arrow left pull-up"></span>\r\n                                        <div class="text-lt m-b-sm">{{act.operateDate}}</div>\r\n                                        <div class="panel-body b-t pull-in b-light" style=padding:10px>\r\n                                            <div class=media>\r\n                                                <div class=media-left>\r\n                                                    <a href=#>\r\n                                                        <img class="media-object avatar" style=height:40px ng-src="{{act.operator.avatar | resource}}" alt=...>\r\n                                                    </a>\r\n                                                </div>\r\n                                                <div class=media-body>\r\n                                                    <p class="media-heading line-xs l-h">{{act.operator.name}}</p>\r\n                                                    <div ng-if="act.operation === \'upload\'">\r\n                                                        <div class=text-muted>\r\n                                                            上传了该文件\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'lock\'">\r\n                                                        <div class=text-muted>\r\n                                                            锁定了该文件\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'unlock\'">\r\n                                                        <div class=text-muted>\r\n                                                            解锁了该文件\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'rename\'">\r\n                                                        <div class=text-muted>\r\n                                                            重命名了该文件\r\n                                                        </div>\r\n                                                        <div class="text-muted text-ellipsis">\r\n                                                            <div>修改签：{{act.change.originalName}}</div>\r\n                                                            <div>修改后：{{act.change.currentName}}</div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'remove\'">\r\n                                                        <div class=text-muted>\r\n                                                            删除了该文件\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'delete\'">\r\n                                                        <div class=text-muted>\r\n                                                            彻底删除了该文件\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'revert\'">\r\n                                                        <div class=text-muted>\r\n                                                            恢复了该文件\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'moveIn\'">\r\n                                                        <div class=text-muted>\r\n                                                            移入了该文件\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'moveOut\'">\r\n                                                        <div class=text-muted>\r\n                                                            移出了该文件\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'download\'">\r\n                                                        <div class=text-muted>\r\n                                                            下载了该文件\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'addReview\'">\r\n                                                        <div class=text-muted>\r\n                                                            评论了该文件\r\n                                                        </div>\r\n                                                        <div class="text-muted m-t-xs text-ellipsis">\r\n                                                            评论内容：{{act.content}}<p></p>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'removeReview\'">\r\n                                                        <div class=text-muted>\r\n                                                            删除了该文件的评论\r\n                                                        </div>\r\n                                                        <div class="text-muted m-t-xs text-ellipsis">\r\n                                                            评论内容：{{act.content}}<p></p>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'setTags\'">\r\n                                                        <div class=text-muted>\r\n                                                            设置了该文件的标签\r\n                                                        </div>\r\n                                                        <div class="text-muted m-t-xs text-ellipsis">\r\n                                                            {{act.tags.currentTags}}\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div ng-if="act.operation === \'updateDesc\'">\r\n                                                        <div class="text-muted text-ellipsis">\r\n                                                            修改了该文件的备注\r\n                                                        </div>\r\n                                                        <div class=text-muted>\r\n                                                            <div class=m-t-xs>\r\n                                                                现备注：{{act.description.currentDescription}}\r\n                                                            </div>\r\n                                                            <div class=m-t-xs>\r\n                                                                原备注：{{act.description.originalDescription}}\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </li>\r\n                        </ul>\r\n                    </div>\r\n                </tab>\r\n            </tabset>\r\n        </div>\r\n    </div>\r\n    <ul id=documentOperationContextMenu class=dropdown-menu role=menu>\r\n        <li ng-click=move(selected)>\r\n            <a tabindex=-1 href="">\r\n                移动\r\n            </a>\r\n        </li>\r\n        <li ng-click=copy(selected) ng-show="checkPermission(\'copy\')">\r\n            <a tabindex=-1 href="">\r\n                复制\r\n            </a>\r\n        </li>\r\n        <li ng-click=rename(selected) ng-show="checkPermission(\'edit\')">\r\n            <a tabindex=-1 href="">\r\n                重命名\r\n            </a>\r\n        </li>\r\n        <li ng-click=remove(selected) ng-show="checkPermission(\'remove\',selected)">\r\n            <a tabindex=-1 href="">\r\n                删除\r\n            </a>\r\n        </li>\r\n        <li class=dropdown-submenu>\r\n            <a tabindex=-1 href="">\r\n                分享\r\n                <span class="pull-right m-r-n-md">\r\n\t       \t \t<i class="fa fa-fw fa-angle-right text"></i>\r\n\t      \t</span>\r\n            </a>\r\n            <ul class=dropdown-menu role=menu style=left:-100%>\r\n                <li ng-click=sendFile(selected)><a href> 发送给同事 </a></li>\r\n                <li ng-click=share(selected)>\r\n                    <a href> 链接分享 </a>\r\n                </li>\r\n            </ul>\r\n        </li>\r\n    </ul>\r\n\r\n</div>\r\n'),t.put("asset/tpl/app/dropbox.html",'<div class=m-c>\r\n\t<div class=modal-header>\r\n\t\t<h4 class=modal-title>\r\n\t\t\t<i class="glyphicon glyphicon-cloud-upload"></i> 上传文件\r\n\t\t</h4>\r\n\t</div>\r\n\t<div class="modal-body no-padder">\r\n\t\t<div class="dropbox-list wrapper-sm">\r\n\t\t\t<div class=dropbox-item ng-repeat="file in files">\r\n\t\t\t\t<div class="dropbox-item-inner wrapper-xs">\r\n\t\t\t\t\t<div class=file-name>\r\n\t\t\t\t\t\t<img class=file-icon ng-src={{getIcon(file)}}>\r\n\t\t\t\t\t\t{{file.name}}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=file-size>\r\n\t\t\t\t\t\t{{file.size | formatSize}}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class="file-operation text-center">\r\n\t\t\t\t\t\t<i class="fa fa-remove hover" ng-click=remove(file);></i>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=clearfix></div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="wrapper-sm b-t">\r\n\t\t\t<form name=dropboxForm class="form-horizontal form-validation">\r\n\t\t\t\t<div class="form-group m-b-none">\r\n\t\t\t\t\t<label class="col-sm-2 control-label">上传到：</label>\r\n\t\t\t\t\t<div class=col-sm-10>\r\n\t\t\t\t\t\t<hc-combo-tree ng-model=directory tree-config=treeConfig on-before-load=setParam(node,params) text-field=fullName on-change=onChange(node);>\r\n\t\t\t\t\t</hc-combo-tree></div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=form-group ng-show=result>\r\n\t\t\t\t\t<div class="col-sm-12 m-t-md text-center">\r\n\t\t\t\t\t\t<div class="alert alert-danger m-b-none" role=alert>{{result.message}}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="alert alert-danger m-b-none" ng-show="allowed === false">\r\n\t\t\t\t\t企业文档根目录不允许上传文件\r\n\t\t\t\t</div>\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class=modal-footer>\r\n\t\t<button type=button class="btn btn-primary" ng-click=ok() ng-disabled="allowed === false">\r\n\t\t\t上传\r\n\t\t</button>\r\n\t\t<button type=button class="btn btn-default" ng-click=cancel()>取消</button>\r\n\t</div>\r\n</div>'),t.put("asset/tpl/app/favorites.html",'<div class=app-ctrl style="padding-top:90px;overflow: hidden" ng-show=!error>\r\n\t<div class="b-b app-title-fixed padder">\r\n\t\t<div class="row wrapper-xs b-b bg-light">\r\n\t\t\t<div class="col-sm-9 col-xs-9 padder-sm">\r\n          \t\t<span class="m-n directory-header text-md">\r\n          \t\t\t<i class="fa fa-star"></i>\r\n          \t\t\t收藏夹\r\n          \t\t</span>\r\n          \t\t<span class="text-sm m-l-xs" ng-show="files.length > 0">\r\n\t\t\t\t\t( <span ng-show="selection.length > 0">{{selection.length}} / </span>{{files.length}} )\r\n\t\t\t\t</span>\r\n\t\t\t</div>\r\n\t\t\t<div class="col-sm-3 col-xs-3 padder-sm">\r\n\t\t\t\t<div class=pull-right>\r\n\t\t\t\t\t<button class="btn btn-md btn-default" ng-click=switchMode()>\r\n\t\t\t\t\t\t<i class=fa ng-class="{ true:\'fa-list\',false:\'fa-th\'}[mode == \'list\']"></i>\r\n\t\t\t\t\t\t<span ng-show="mode == \'list\'">列表视图</span> \r\n\t\t\t\t\t\t<span ng-show="mode == \'block\'">图标视图</span>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<div class=btn-group dropdown is-open=openSortmenu>\r\n\t\t\t\t\t\t<button type=button class="btn btn-md btn-default" ng-click=changeDesc();>\r\n\t\t\t\t\t\t\t<i ng-class="{\'fa-long-arrow-down\' : sortDesc,\'fa-long-arrow-up\':!sortDesc}" class=fa></i> \r\n\t\t\t\t\t\t\t<span ng-show="sortField == \'name\'">名称</span>\r\n\t\t\t\t\t\t\t<span ng-show="sortField == \'size\'">大小</span>\r\n\t\t\t\t\t\t\t<span ng-show="sortField == \'creationBy.name\'">创建者</span>\r\n\t\t\t\t\t\t\t<span ng-show="sortField == \'updateDate\'">时间</span>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<button type=button class="btn btn-md btn-default dropdown-toggle" dropdown-toggle>\r\n\t\t\t\t\t\t\t<span class=caret></span>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<ul class=dropdown-menu role=menu style="left: inherit; right: 0px">\r\n\t\t\t\t\t\t\t<li><a href ng-click="changeSort(\'name\')"> 名称 </a></li>\r\n\t\t\t\t\t\t\t<li><a href ng-click="changeSort(\'size\')"> 大小 </a></li>\r\n\t\t\t\t\t\t\t<li><a href ng-click="changeSort(\'creationBy.name\')"> 创建者 </a></li>\r\n\t\t\t\t\t\t\t<li><a href ng-click="changeSort(\'updateDate\')"> 时间 </a></li>\r\n\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="row wrapper-xs bg-light lter">\r\n\t\t\t<div class="col-sm-10 col-xs-10 padder-sm">\r\n\t\t\t\t<button class="btn btn-md btn-default" ng-click=open(selection[0],$event) ng-show="selection.length == 1 && selection[0].type == \'file\'">\r\n\t\t\t\t\t\t<i class="glyphicon glyphicon-new-window"></i> 打开文件\r\n\t\t\t\t</button>\r\n\t\t\t\t<button class="btn btn-md btn-default" ng-click=openParent(selection[0],$event) ng-show="selection.length == 1 && selection[0].type == \'file\'">\r\n\t\t\t\t\t<i class="fa fa-folder-open"></i> 打开所在文件夹\r\n\t\t\t\t</button>\r\n\t\t\t\t<button class="btn btn-md btn-default" ng-click=open(selection[0],$event) ng-show="selection.length == 1 && selection[0].type == \'directory\'">\r\n\t\t\t\t\t<i class="fa fa-folder-open"></i> 打开文件夹\r\n\t\t\t\t</button>\r\n\t\t\t\t<button class="btn btn-md btn-default" ng-click=removeFavorite(); ng-show="selection.length > 0">\r\n\t\t\t\t\t<i class="glyphicon glyphicon-trash"></i> 删除收藏\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t\t<div class="col-sm-2 col-xs-2 text-right padder-sm">\r\n\t\t\t\t<div class="input-group-icon directory-search">\r\n\t\t\t\t\t<i class="glyphicon glyphicon-search input-icon"></i>\r\n\t\t\t\t\t<input ng-model=condition class="form-control input-sm rounded" placeholder=\'搜索"收藏夹"\'>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div>\r\n\t</div>\r\n\t<div class="bg-light lter app-inner" ng-click=onContainerClick();>\r\n\t\t<div class="table-responsive file-list" ng-if="mode== \'list\'" ng-show="files.length > 0 && !loading">\r\n\t\t\t<table class="table b-b b-light lter file-table">\r\n\t\t\t\t<thead>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<th width=5%><label class="i-checks i-checks-sm m-b-none" ng-show=!condition>\r\n\t\t\t\t\t\t\t\t<input type=checkbox ng-click=selectAll() ng-checked=isSelectAll><i></i>\r\n\t\t\t\t\t\t</label></th>\r\n\t\t\t\t\t\t<th ng-click="changeSort(\'name\')">名称 <i ng-show="sortField == \'name\'" ng-class="{\'fa-caret-up\' : !sortDesc,\'fa-caret-down\':sortDesc}" class=fa> </i>\r\n\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t<th width=20%>\r\n\t\t\t\t\t\t\t路径\r\n\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t<th ng-click="changeSort(\'size\')" width=120px>大小\r\n                            <i ng-show="sortField === \'size\'" ng-class="{\'fa-caret-up\' : !sortDesc,\'fa-caret-down\':sortDesc}" class=fa> </i>\r\n\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t<th ng-click="changeSort(\'creationBy.name\')" width=200px>创建者\r\n\t\t\t\t\t\t\t<i ng-show="sortField == \'creationBy.name\'" ng-class="{\'fa-caret-up\' : !sortDesc,\'fa-caret-down\':sortDesc}" class=fa> </i>\r\n\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t<th ng-click="changeSort(\'updateDate\')" width=200px>修改时间 <i ng-show="sortField == \'updateDate\'" ng-class="{\'fa-caret-up\' : !sortDesc,\'fa-caret-down\':sortDesc}" class=fa> </i>\r\n\t\t\t\t\t\t</th>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</thead>\r\n\t\t\t\t<tbody>\r\n\t\t\t\t\t<tr ng-repeat="file in files|orderBy:sortFields:sortDesc | filter:{name:condition}" class="file-item hc-item" ng-class="{true:\'active\'}[file.selected]" valign=middle ng-click=select(file)>\r\n\t\t\t\t\t\t<td width=5%>\r\n\t\t\t\t\t\t\t<label class="i-checks i-checks-sm m-b-none">\r\n\t\t\t\t\t\t\t\t<input type=checkbox ng-checked=file.selected ng-click=select(file);><i></i>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=text-ellipsis>\r\n\t\t\t\t\t\t\t<a ng-click=open(file,$event);>\r\n\t\t\t\t\t\t\t\t<div class=file-icon-wrapper>\r\n\t\t\t\t\t\t\t\t\t<img class=file-icon ng-src={{getIcon(file)}}>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t{{file.name}}\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</td>\r\n                        <td>\r\n                            <a ng-click=openParent(file,$event)>\r\n                                {{file.fullName.split(\'/\').slice(0,-1).join("/")}}\r\n                            </a>\r\n                        </td>\r\n\t\t\t\t\t\t<td>{{file.size | formatSize}}</td>\r\n\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t<img ng-if=file.creationBy ng-src="{{file.creationBy.avatar | resource}}" class=img-circle style=height:30px;float:left alt=...>\r\n\t\t\t\t\t\t\t<span class=m-l-xs>{{file.creationBy.name}}</span>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t<td>{{file.updateDate}}</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</tbody>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t\t<div ng-if="mode == \'block\'">\r\n\t\t\t<ul class=file-block-list>\r\n\t\t\t\t<li class=file-block ng-class="{true:\'active\'}[file.selected]" ng-click=select(file,null,$event) ng-dblclick=open(file,$event); ng-repeat="file in files|orderBy:sortField:sortDesc | filter:{name:condition}">\r\n\t\t\t\t\t<img class=file-icon ng-src={{getIcon(file)}}>\r\n\t\t\t\t\t<div class="file-name text-ellipsis m-t-sm" tooltip={{file.name}} tooltip-placement=bottom>{{file.name}}</div>\r\n\t\t\t\t</li>\r\n\t\t\t</ul>\r\n\t\t</div>\r\n\t\t<div class="wrapper-xl text-center" ng-show=loading>\r\n\t\t\t<img ng-src="{{\'asset/img/loading.gif\' | resource}}">\r\n\t\t\t<p class=m-t-sm>正在加载</p>\r\n\t\t</div>\r\n\t\t<div class="wrapper-xl text-center" ng-show="(files.length == 0 || !files) && !loading">\r\n            <i class="iconfont icon-empty"></i>\r\n\t\t\t<p class=m-t-md>收藏夹中没有文件</p>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n<div class="wrapper-xl text-center" ng-show=error>\r\n    <i class="iconfont icon-error"></i>\r\n    <p class=m-t-md>加载失败：{{error}}</p>\r\n</div>\r\n'),t.put("asset/tpl/app/file_send.html",'<div class=m-c>\r\n\t<div class=modal-header>\r\n\t\t<h4 class=modal-title>\r\n\t\t\t<i class="fa fa-paper-plane"></i> 发送文件\r\n\t\t</h4>\r\n\t</div>\r\n\t<div class="modal-body no-padder">\r\n\t\t<div class="dropbox-list wrapper-sm">\r\n\t\t\t<div class=dropbox-item ng-repeat="file in files">\r\n\t\t\t\t<div class="dropbox-item-inner wrapper-xs clearfix">\r\n\t\t\t\t\t<div class=file-name>\r\n\t\t\t\t\t\t<img class=file-icon ng-src={{getIcon(file)}}>\r\n\t\t\t\t\t\t{{file.name}}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div ng-if=file.size class=file-size>\r\n\t\t\t\t\t\t{{file.size | formatSize}}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div ng-if=!file.size class=file-size>\r\n\t\t\t\t\t\t&nbsp;\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class="file-operation text-center">\r\n\t\t\t\t\t\t<i class="fa fa-remove hover" ng-click=remove(file);></i>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="wrapper-sm b-t clearfix">\r\n\t\t<form class=form-horizontal>\r\n\t\t\t<div class=form-group>\r\n\t\t\t    <label class="col-sm-2 control-label">接收人:</label>\r\n\t\t\t    <div class=col-sm-10>\r\n\t\t\t   \t\t<div class="permission-user-selected wrapper-sm text-center inline hover-bg" ng-repeat="user in users">\r\n\t\t\t\t\t<button type=button class=close ng-click=removeReceiver(user)>\r\n\t\t\t\t\t\t<span aria-hidden=true>×</span>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<img ng-src="{{user.avatar | resource}}" class=img-circle style=height:35px alt=...>\r\n\t\t\t\t\t<div class="text-ellipsis m-t-xs text-sm">{{user.name}}</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<button class="btn btn-default btn-md btn-sm m-t-xs" ng-click=addReceiver();>\r\n\t\t\t\t\t\t<i class="fa fa-users"></i> 选择接收人\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t    </div>\r\n\t\t\t  </div>\r\n\t\t\t<div class=form-group>\r\n\t\t\t    <label class="col-sm-2 control-label">留言：</label>\r\n\t\t\t    <div class=col-sm-10>\r\n\t\t\t   \t\t<input class=form-control ng-model=content>\r\n\t\t\t    </div>\r\n\t\t\t  </div>\r\n\t\t\t  </form>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class=modal-footer>\r\n\t\t<button type=button class="btn btn-primary" ng-click=ok() ng-disabled="!users || users.length == 0 || !files || files.length == 0">\r\n\t\t\t<i class="fa fa-paper-plane"></i> 发送\r\n\t\t</button>\r\n\t\t<button type=button class="btn btn-default" ng-click=cancel()>取消</button>\r\n\t</div>\r\n</div>'),t.put("asset/tpl/app/messages.html",'<div class=app-ctrl style="padding-top:76px;overflow: hidden" ng-show=!error>\r\n    <div class="b-b app-title-fixed padder">\r\n        <div class="row wrapper-md bg-light lter">\r\n            <div class="col-sm-9 col-xs-9 padder-sm">\r\n          \t\t<span class="m-n directory-header h3">\r\n          \t\t\t<i class="glyphicon glyphicon-comment"></i>\r\n          \t\t\t消息通知\r\n          \t\t</span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="bg-white wrapper-md app-inner">\r\n        <div class=m-b ng-repeat="message in messages">\r\n            <a href class="pull-left thumb-sm avatar">\r\n                <img ng-src="{{message.sender.avatar | resource}}" alt=...>\r\n                <p class="m-t-xs text-xs text-ellipsis">{{message.sender.name}}</p>\r\n            </a>\r\n            <div class=clear>\r\n                <div class="pos-rlt wrapper-sm b bg-light r m-l-sm message">\r\n                    <span class="arrow left pull-up arrow-light"></span>\r\n                    <p class=m-b-xs ng-if=message.content>\r\n                        留言：{{message.content}}\r\n                    </p>\r\n                    <div class="message-file pos-rlt" ng-if=message.document>\r\n                        文件：\r\n                        <a ng-click=open(message.document) class="file-box wrapper-sm clearfix pos-rlt b bg-light lter" href="">\r\n                            <div class="file-icon text-center">\r\n                                <img class="" ng-src={{getIcon(message.document)}}>\r\n                            </div>\r\n                            <div class=file-content>\r\n                                <div class=file-name>{{message.document.name}}</div>\r\n                                <div class=file-size ng-if=message.document.size>{{message.document.size | formatSize}}\r\n                                </div>\r\n                                <div class=file-size ng-if=!message.document.size>&nbsp;</div>\r\n                            </div>\r\n                        </a>\r\n                    </div>\r\n\r\n                </div>\r\n                <small class="text-muted m-l-sm message-date"><i class="fa fa-ok text-success"></i>{{message.sendDate}}\r\n                </small>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="wrapper-xl text-center" ng-show=loading>\r\n        <img ng-src="{{\'asset/img/loading.gif\' | resource}}">\r\n        <p class=m-t-sm>正在加载</p>\r\n    </div>\r\n    <div class="wrapper-xl text-center" ng-show="(files.length == 0 || !files) && !loading">\r\n        <i class="iconfont icon-empty"></i>\r\n        <p class=m-t-md>没有未读消息</p>\r\n    </div>\r\n</div>\r\n<div class="wrapper-xl text-center" ng-show=error>\r\n    <i class="iconfont icon-error"></i>\r\n    <p class=m-t-md>{{error}}</p>\r\n</div>'),t.put("asset/tpl/app/move.html",'<div class=m-c>\r\n\t<div class=modal-header>\r\n\t\t<h4 class=modal-title>\r\n\t\t\t移动文件(夹)\r\n\t\t</h4>\r\n\t</div>\r\n\t<div class="modal-body no-padder">\r\n\t\t<div class=permission-user-body>\r\n\t\t\t<div class="col-sm-12 permission-user-part b-r wrapper-sm">\r\n\t\t\t\t<div class=wrapper-xs>\r\n\t\t\t\t\t选择要移动到的位置\r\n\t\t\t\t</div>\r\n\t\t\t\t<hc-tree tree-control=tree load-asyn=true leaf-icon="fa fa-folder" on-node-dbl-click=select(node); on-selection-change=setTarget(selection); on-before-load=setParam(node,params); load-url=/fs/folder></hc-tree>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="wrapper-sm b-t row m-l-none m-r-none" ng-show=target>\r\n\t\t\t<b>将移动到：</b><span>{{paths}}</span>\r\n\t\t</div>\r\n\t\t<div class="wrapper-sm b-t row m-l-none m-r-none" ng-show=isRepeat>\r\n\t\t\t所选的文件已经在该文件夹中，请选择其他文件夹。\r\n\t\t</div>\r\n\t</div>\r\n\t<div class=modal-footer>\r\n\t\t<button type=button class="btn btn-primary" ng-click=ok() ng-disabled=!target>\r\n\t\t\t确定\r\n\t\t</button>\r\n\t\t<button type=button class="btn btn-default" ng-click=close()>取消</button>\r\n\t</div>\r\n</div>'),t.put("asset/tpl/app/profile.html",'<div class=app-ctrl style="padding-top:76px;overflow: hidden" ng-show=!error>\r\n\t<div class="b-b app-title-fixed padder">\r\n\t\t<div class="row wrapper-md bg-light">\r\n\t\t\t<div class="col-sm-9 col-xs-9 padder-sm">\r\n          \t\t<span class="m-n directory-header h3">\r\n          \t\t\t<i class="fa fa-user"></i>\r\n          \t\t\t个人设置\r\n          \t\t</span>\r\n\t\t\t</div>\r\n\t\t\t<div class="col-sm-3 col-xs-3" style="text-align: right">\r\n\t\t\t\t<button class="btn btn-primary" ng-disabled="userSettingForm.$invalid || !userSettingForm.$dirty" ng-click=save()>保存</button>\r\n\t\t\t</div>\r\n\t</div>\r\n\t</div>\r\n\t<div class="bg-light wrapper-md lter app-inner">\r\n\t<form name=userSettingForm class="form-horizontal form-property form-validation">\r\n\t\t<div class="panel panel-default">\r\n\t\t<div class="panel-heading font-bold">个人信息</div>\r\n\t\t<div class=panel-body>\r\n\t\t\t\t<div class="form-group m-b-sm">\r\n\t\t\t\t\t<label class="col-sm-5 control-label">用户名</label>\r\n\t\t\t\t\t<div class="col-sm-7 control-label">\r\n\t\t\t\t\t\t{{user.username}}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="line line-dashed b-b line-lg"></div>\r\n\t\t\t\t<div class="form-group m-b-sm">\r\n\t\t\t\t\t<label class="col-sm-5 control-label">邮箱</label>\r\n\t\t\t\t\t<div class=col-sm-7>\r\n\t\t\t\t\t\t<input type=email name=name ng-model=user.email required class="form-control w-md">\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="line line-dashed b-b line-lg"></div>\r\n\t\t\t\t<div class=form-group>\r\n\t\t\t\t\t<label class="col-sm-5 control-label">姓名</label>\r\n\t\t\t\t\t<div class=col-sm-7>\r\n\t\t\t\t\t\t<input name=name ng-model=user.name required class="form-control w-md">\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="line line-dashed b-b line-lg"></div>\r\n\t\t\t\t<div class=form-group>\r\n\t\t\t\t\t<label class="col-sm-5 control-label">头像</label>\r\n\t\t\t\t\t<input id=avatarInput type=file class=hidden onchange=angular.element(this).scope().upload()> \r\n\t\t\t\t\t<div class="col-sm-7 m-b-sm">\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<img ng-src="{{user.avatar | resource}}" class="rounded w-xs m-b-sm avatar-img">\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<button class="btn btn-default" ng-click=selectAvatar() ng-disabled=uploading>\r\n\t\t\t\t\t\t\t<span ng-show=uploading>正在上传</span>\r\n\t\t\t\t\t\t\t<span ng-show=!uploading>选择头像</span>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t推荐尺寸240*240，大小不超过2MB\r\n\t\t\t\t\t\t<div class="alert alert-danger m-t-sm m-b-none w-md" ng-show="result.success === false" role=alert>{{result.message}}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="line line-dashed b-b line-lg"></div>\r\n\t\t\t\t<div class="form-group m-b-sm">\r\n\t\t\t\t\t<label class="col-sm-5 control-label">部门</label>\r\n\t\t\t\t\t<div class="col-sm-7 control-label">\r\n\t\t\t\t\t\t{{user.department.name}}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="line line-dashed b-b line-lg"></div>\r\n\t\t\t\t<div class=form-group>\r\n\t\t\t\t\t<label class="col-sm-5 control-label">个人空间</label>\r\n\t\t\t\t\t<div class="col-sm-7 control-label">\r\n\t\t\t\t\t\t<div class=m-b-xs>总共：{{space.quota | formatSize}}，已用：{{space.used | formatSize}}</div>\r\n\t\t\t\t\t\t <progressbar value=space.quatoPrecent type=white class="progress-xs m-b-none dker w-md"></progressbar>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class="panel panel-default">\r\n\t\t<div class="panel-heading font-bold">偏好设置</div>\r\n\t\t<div class=panel-body>\r\n\t\t\t\t<div class="form-group m-b-sm">\r\n\t\t\t\t\t<label class="col-sm-5 control-label">文件显示模式</label>\r\n\t\t\t\t\t<div class=col-sm-7>\r\n\t\t\t\t\t\t<label class="checkbox-inline i-checks"> \r\n\t\t\t\t\t\t\t<input type=radio name=mode value=list ng-checked="user.mode == \'list\'" ng-model=user.mode><i></i>\r\n\t\t\t\t\t\t\t列表模式\r\n\t\t\t\t\t\t</label> \r\n\t\t\t\t\t\t<label class="checkbox-inline i-checks"> \r\n\t\t\t\t\t\t\t<input type=radio name=mode value=block ng-checked="user.mode == \'block\'" ng-model=user.mode><i></i> \r\n\t\t\t\t\t\t\t图标模式\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="line line-dashed b-b line-lg"></div>\r\n\t\t\t\t<div class="form-group m-b-sm">\r\n\t\t\t\t\t<label class="col-sm-5 control-label">排序字段</label>\r\n\t\t\t\t\t<div class=col-sm-7>\r\n\t\t\t\t\t\t<label class="checkbox-inline i-checks"> \r\n\t\t\t\t\t\t\t<input type=radio name=sortField value=name ng-checked="user.sortField == \'name\'" ng-model=user.sortField><i></i>\r\n\t\t\t\t\t\t\t名称\r\n\t\t\t\t\t\t</label> \r\n\t\t\t\t\t\t<label class="checkbox-inline i-checks"> \r\n\t\t\t\t\t\t\t<input type=radio name=sortField value=size ng-checked="user.sortField == \'size\'" ng-model=user.sortField><i></i> \r\n\t\t\t\t\t\t\t大小\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<label class="checkbox-inline i-checks"> \r\n\t\t\t\t\t\t\t<input type=radio name=sortField value=updateDate ng-checked="user.sortField == \'updateDate\'" ng-model=user.sortField><i></i> \r\n\t\t\t\t\t\t\t时间\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<label class="checkbox-inline i-checks"> \r\n\t\t\t\t\t\t\t<input type=radio name=sortField value=creationBy.name ng-checked="user.sortField == \'creationBy.name\'" ng-model=user.sortField><i></i> \r\n\t\t\t\t\t\t\t创建者\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="line line-dashed b-b line-lg"></div>\r\n\t\t\t\t<div class="form-group m-b-sm">\r\n\t\t\t\t\t<label class="col-sm-5 control-label">排序模式</label>\r\n\t\t\t\t\t<div class=col-sm-7>\r\n\t\t\t\t\t\t<label class="checkbox-inline i-checks"> \r\n\t\t\t\t\t\t\t<input type=radio name=sortDesc value=false ng-checked="user.sortDesc !== true" ng-model=user.sortDesc><i></i>\r\n\t\t\t\t\t\t\t升序\r\n\t\t\t\t\t\t</label> \r\n\t\t\t\t\t\t<label class="checkbox-inline i-checks"> \r\n\t\t\t\t\t\t\t<input type=radio name=sortDesc value=true ng-checked="user.sortDesc === true" ng-model=user.sortDesc><i></i> \r\n\t\t\t\t\t\t\t降序\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\t</form>\r\n</div>\r\n</div>\r\n'),t.put("asset/tpl/app/recent.html",'<div class=app-ctrl style="padding-top:90px;overflow: hidden" ng-show=!error>\r\n\t<div class="b-b app-title-fixed padder">\r\n\t\t<div class="row wrapper-xs b-b bg-light">\r\n\t\t\t<div class="col-sm-9 col-xs-9 padder-sm">\r\n          \t\t<span class="m-n directory-header text-md">\r\n          \t\t\t<i class="fa fa-clock-o"></i>\r\n          \t\t\t最近打开\r\n          \t\t</span>\r\n          \t\t<span class="text-sm m-l-xs" ng-show="files.length > 0">\r\n\t\t\t\t\t( <span ng-show="selection.length > 0">{{selection.length}} / </span>{{files.length}} )\r\n\t\t\t\t</span>\r\n\t\t\t</div>\r\n\t\t\t<div class="col-sm-3 col-xs-3 padder-sm">\r\n\t\t\t\t<div class=pull-right>\r\n\t\t\t\t\t<button class="btn btn-md btn-default" ng-click=switchMode()>\r\n\t\t\t\t\t\t<i class=fa ng-class="{ true:\'fa-list\',false:\'fa-th\'}[mode == \'list\']"></i>\r\n\t\t\t\t\t\t<span ng-show="mode == \'list\'">列表视图</span> \r\n\t\t\t\t\t\t<span ng-show="mode == \'block\'">图标视图</span>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<div class=btn-group dropdown is-open=openSortmenu>\r\n\t\t\t\t\t\t<button type=button class="btn btn-md btn-default" ng-click=changeDesc();>\r\n\t\t\t\t\t\t\t<i ng-class="{\'fa-long-arrow-down\' : sortDesc,\'fa-long-arrow-up\':!sortDesc}" class=fa></i> \r\n\t\t\t\t\t\t\t<span ng-show="sortField == \'name\'">名称</span>\r\n\t\t\t\t\t\t\t<span ng-show="sortField == \'size\'">大小</span>\r\n\t\t\t\t\t\t\t<span ng-show="sortField == \'creationBy.name\'">创建者</span>\r\n\t\t\t\t\t\t\t<span ng-show="sortField == \'updateDate\'">时间</span>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<button type=button btn-md class="btn btn-md btn-default dropdown-toggle" dropdown-toggle>\r\n\t\t\t\t\t\t\t<span class=caret></span>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<ul class=dropdown-menu role=menu style="left: inherit; right: 0px">\r\n\t\t\t\t\t\t\t<li><a href ng-click="changeSort(\'name\')"> 名称 </a></li>\r\n\t\t\t\t\t\t\t<li><a href ng-click="changeSort(\'size\')"> 大小 </a></li>\r\n\t\t\t\t\t\t\t<li><a href ng-click="changeSort(\'creationBy.name\')"> 创建者 </a></li>\r\n\t\t\t\t\t\t\t<li><a href ng-click="changeSort(\'updateDate\')"> 时间 </a></li>\r\n\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="row wrapper-xs bg-light lter">\r\n\t\t\t<div class="col-sm-10 col-xs-10 padder-sm">\r\n\t\t\t\t<button class="btn btn-md btn-default" ng-click=open(selection[0],$event) ng-show="selection.length == 1 && selection[0].type == \'file\'">\r\n\t\t\t\t\t<i class="glyphicon glyphicon-new-window"></i> 打开文件\r\n\t\t\t\t</button>\r\n\t\t\t\t<button class="btn btn-md btn-default" ng-click=openParent(selection[0],$event) ng-show="selection.length == 1 && selection[0].type == \'file\'">\r\n\t\t\t\t\t<i class="fa fa-folder-open"></i> 打开所在文件夹\r\n\t\t\t\t</button>\r\n\t\t\t\t<button class="btn btn-md btn-default" ng-click=open(selection[0],$event) ng-show="selection.length == 1 && selection[0].type == \'directory\'">\r\n\t\t\t\t\t<i class="fa fa-folder-open"></i> 打开文件夹\r\n\t\t\t\t</button>\r\n\t\t\t\t<button class="btn btn-md btn-default" ng-click=removeRecent() ng-show="selection.length > 0">\r\n\t\t\t\t\t<i class="glyphicon glyphicon-trash"></i> 删除记录\r\n\t\t\t\t</button>\r\n\t\t\t\t<button class="btn btn-md btn-default" ng-click=clear() ng-show="files.length > 0">\r\n\t\t\t\t\t<i class="glyphicon glyphicon-trash"></i> 清空记录\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t\t<div class="col-sm-2 col-xs-2 text-right padder-sm">\r\n\t\t\t\t<div class="input-group-icon directory-search">\r\n\t\t\t\t\t<i class="glyphicon glyphicon-search input-icon"></i>\r\n\t\t\t\t\t<input ng-model=condition class="form-control input-sm rounded" placeholder=\'搜索"最近打开"\'>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class="bg-light lter app-inner" ng-click=onContainerClick();>\r\n\t\t<div class="table-responsive file-list" ng-if="mode== \'list\'" ng-show="files.length > 0 && !loading">\r\n\t\t\t<table class="table b-b b-light lter file-table">\r\n\t\t\t\t<thead>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<th width=5%><label class="i-checks i-checks-sm m-b-none" ng-show=!condition>\r\n\t\t\t\t\t\t\t\t<input type=checkbox ng-click=selectAll() ng-checked=isSelectAll><i></i>\r\n\t\t\t\t\t\t</label></th>\r\n\t\t\t\t\t\t<th ng-click="changeSort(\'name\')" width=40%>名称 <i ng-show="sortField == \'name\'" ng-class="{\'fa-caret-up\' : !sortDesc,\'fa-caret-down\':sortDesc}" class=fa> </i>\r\n\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t<th width=20%>\r\n\t\t\t\t\t\t\t路径\r\n\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t<th ng-click="changeSort(\'size\')" width=120px>大小 <i ng-show="sortField == \'size\'" ng-class="{\'fa-caret-up\' : !sortDesc,\'fa-caret-down\':sortDesc}" class=fa> </i>\r\n\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t<th ng-click="changeSort(\'creationBy.name\')" width=200px>创建者\r\n\t\t\t\t\t\t\t<i ng-show="sortField == \'creationBy.name\'" ng-class="{\'fa-caret-up\' : !sortDesc,\'fa-caret-down\':sortDesc}" class=fa> </i>\r\n\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t<th ng-click="changeSort(\'updateDate\')" width=200px>修改时间 <i ng-show="sortField == \'updateDate\'" ng-class="{\'fa-caret-up\' : !sortDesc,\'fa-caret-down\':sortDesc}" class=fa> </i>\r\n\t\t\t\t\t\t</th>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</thead>\r\n\t\t\t\t<tbody>\r\n\t\t\t\t\t<tr ng-repeat="file in files|orderBy:sortFields:sortDesc | filter:{name:condition}" class="file-item hc-item" ng-click=select(file) ng-class="{true:\'active\'}[file.selected]" valign=middle>\r\n\t\t\t\t\t\t<td width=5%>\r\n\t\t\t\t\t\t\t<label class="i-checks i-checks-sm m-b-none">\r\n\t\t\t\t\t\t\t\t<input type=checkbox ng-checked=file.selected ng-click=select(file,null,$event);><i></i>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=text-ellipsis>\r\n\t\t\t\t\t\t\t<a ng-click=open(file,$event);>\r\n\t\t\t\t\t\t\t\t<div class=file-icon-wrapper>\r\n\t\t\t\t\t\t\t\t\t<img class=file-icon ng-src={{getIcon(file)}}>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t{{file.name}}\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t<a ng-click=openParent(file,$event)>\r\n\t\t\t\t\t\t\t\t{{file.fullName.split(\'/\').slice(0,-1).join("/")}}\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t<td>{{file.size | formatSize}}</td>\r\n\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t<img ng-if=file.creationBy ng-src="{{file.creationBy.avatar | resource}}" class=img-circle style=height:30px;float:left alt=...>\r\n\t\t\t\t\t\t\t<span class=m-l-xs>{{file.creationBy.name}}</span>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t<td>{{file.updateDate}}</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</tbody>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t\t<div ng-if="mode == \'block\'">\r\n\t\t\t<ul class=file-block-list>\r\n\t\t\t\t<li class=file-block ng-class="{true:\'active\'}[file.selected]" ng-click=select(file,null,$event) ng-dblclick=open(file,$event); ng-repeat="file in files|orderBy:sortField:sortDesc | filter:{name:condition}">\r\n\t\t\t\t\t<img class=file-icon ng-src={{getIcon(file)}}>\r\n\t\t\t\t\t<div class="file-name text-ellipsis m-t-sm" tooltip={{file.name}} tooltip-placement=bottom>{{file.name}}</div>\r\n\t\t\t\t</li>\r\n\t\t\t</ul>\r\n\t\t</div>\r\n\t\t<div class="wrapper-xl text-center" ng-show=loading>\r\n\t\t\t<img ng-src="{{\'asset/img/loading.gif\' | resource}}">\r\n\t\t\t<p class=m-t-sm>正在加载</p>\r\n\t\t</div>\r\n\t\t<div class="wrapper-xl text-center" ng-show="(files.length == 0 || !files) && !loading">\r\n\t\t\t<i class="iconfont icon-empty"></i>\r\n\t\t\t<p class=m-t-md>最近没有打开文件</p>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n<div class="wrapper-xl text-center" ng-show=error>\r\n\t<i class="iconfont icon-error"></i>\r\n\t<p class=m-t-md>加载失败：{{error}}</p>\r\n</div>\r\n'),t.put("asset/tpl/app/recycle.html",'<div class=app-ctrl style="padding-top:90px;overflow: hidden" ng-show=!error>\r\n    <div class="b-b app-title-fixed padder">\r\n        <div class="row wrapper-xs b-b bg-light">\r\n            <div class="col-sm-9 col-xs-9 padder-sm">\r\n          \t\t<span class="m-n directory-header text-md">\r\n          \t\t\t<i class="glyphicon glyphicon-trash"></i>\r\n          \t\t\t回收站\r\n          \t\t</span>\r\n                <span class="text-sm m-l-xs" ng-show="files.length > 0">\r\n\t\t\t\t\t( <span ng-show="selection.length > 0">{{selection.length}} / </span>{{files.length}} )\r\n\t\t\t\t</span>\r\n            </div>\r\n            <div class="col-sm-3 col-xs-3 padder-sm">\r\n                <div class=pull-right>\r\n                    <button class="btn btn-md btn-default" ng-click=switchMode()>\r\n                        <i class=fa ng-class="{ true:\'fa-list\',false:\'fa-th\'}[mode == \'list\']"></i>\r\n                        <span ng-show="mode == \'list\'">列表视图</span>\r\n                        <span ng-show="mode == \'block\'">图标视图</span>\r\n                    </button>\r\n                    <div class=btn-group dropdown is-open=openSortmenu>\r\n                        <button type=button class="btn btn-md btn-default" ng-click=changeDesc();>\r\n                            <i ng-class="{\'fa-long-arrow-down\' : sortDesc,\'fa-long-arrow-up\':!sortDesc}" class=fa></i>\r\n                            <span ng-show="sortField == \'name\'">名称</span>\r\n                            <span ng-show="sortField == \'size\'">大小</span>\r\n                            \r\n                            <span ng-show="sortField == \'deleteBy.name\'">删除者</span>\r\n                            <span ng-show="sortField == \'updateDate\'">修改时间</span>\r\n                            <span ng-show="sortField == \'deleteDate\'">删除时间</span>\r\n                        </button>\r\n                        <button type=button class="btn btn-md btn-default dropdown-toggle" dropdown-toggle>\r\n                            <span class=caret></span>\r\n                        </button>\r\n                        <ul class=dropdown-menu role=menu style="left: inherit; right: 0px">\r\n                            <li><a href ng-click="changeSort(\'name\')"> 名称 </a></li>\r\n                            <li><a href ng-click="changeSort(\'size\')"> 大小 </a></li>\r\n                            \r\n                            <li><a href ng-click="changeSort(\'deleteBy.name\')"> 删除者 </a></li>\r\n                            <li><a href ng-click="changeSort(\'updateDate\')">修改时间 </a></li>\r\n                            <li><a href ng-click="changeSort(\'deleteDate\')">删除时间 </a></li>\r\n                        </ul>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="row wrapper-xs bg-light lter">\r\n            <div class="col-sm-10 col-xs-10 padder-sm">\r\n                <button class="btn btn-md btn-default" ng-click=revert() ng-show="selection.length > 0">\r\n                    <i class="fa fa-recycle"></i> 恢复文件\r\n                </button>\r\n                <button class="btn btn-md btn-default" ng-click=openParent(selection[0],$event) ng-show="selection.length == 1">\r\n                    <i class="glyphicon glyphicon-new-window"></i> 打开所在文件夹\r\n                </button>\r\n                <button class="btn btn-md btn-default" ng-click=destroy() ng-show="selection.length > 0">\r\n                    <i class="fa fa-trash"></i> 彻底删除\r\n                </button>\r\n                <button class="btn btn-md btn-default" ng-click=clear() ng-show="files.length > 0">\r\n                    <i class="fa fa-trash-o"></i> 清空回收站\r\n                </button>\r\n            </div>\r\n            <div class="col-sm-2 col-xs-2 text-right padder-sm">\r\n                <div class="input-group-icon directory-search">\r\n                    <i class="glyphicon glyphicon-search input-icon"></i>\r\n                    <input ng-model=condition class="form-control input-sm rounded" placeholder=\'搜索"回收站"\'>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="bg-light lter app-inner" ng-click=onContainerClick();>\r\n        <div class="table-responsive file-list" ng-if="mode== \'list\'" ng-show="files.length > 0 && !loading">\r\n            <table class="table b-b b-light lter file-table">\r\n                <thead>\r\n                <tr>\r\n                    <th width=5%><label class="i-checks i-checks-sm m-b-none" ng-show=!condition>\r\n                        <input type=checkbox ng-click=selectAll() ng-checked=isSelectAll><i></i>\r\n                    </label></th>\r\n                    <th ng-click="changeSort(\'name\')">名称 <i ng-show="sortField == \'name\'" ng-class="{\'fa-caret-up\' : !sortDesc,\'fa-caret-down\':sortDesc}" class=fa> </i>\r\n                    </th>\r\n                    <th width=20%>\r\n                        路径\r\n                    </th>\r\n                    <th ng-click="changeSort(\'size\')" width=120px>大小 <i ng-show="sortField == \'size\'" ng-class="{\'fa-caret-up\' : !sortDesc,\'fa-caret-down\':sortDesc}" class=fa> </i>\r\n                    </th>\r\n                    <th ng-click="changeSort(\'deleteBy.name\')" width=200px>删除者\r\n                        <i ng-show="sortField == \'deleteBy.name\'" ng-class="{\'fa-caret-up\' : !sortDesc,\'fa-caret-down\':sortDesc}" class=fa> </i>\r\n                    </th>\r\n                    <th ng-click="changeSort(\'deleteDate\')" width=200px>删除时间 <i ng-show="sortField == \'deleteDate\'" ng-class="{\'fa-caret-up\' : !sortDesc,\'fa-caret-down\':sortDesc}" class=fa> </i>\r\n                    </th>\r\n                </tr>\r\n                </thead>\r\n                <tbody>\r\n                <tr ng-repeat="file in files|orderBy:sortFields:sortDesc | filter:{name:condition}" class="file-item hc-item" ng-class="{true:\'active\'}[file.selected]" valign=middle ng-click=select(file)>\r\n                    <td width=5%>\r\n                        <label class="i-checks i-checks-sm m-b-none">\r\n                            <input type=checkbox ng-checked=file.selected ng-click=select(file);><i></i>\r\n                        </label>\r\n                    </td>\r\n                    <td class=text-ellipsis>\r\n                        <a ng-click=open(file,$event);>\r\n                            <div class=file-icon-wrapper>\r\n                                <img class=file-icon ng-src={{getIcon(file)}}>\r\n                            </div>\r\n                            {{file.name}}\r\n                        </a>\r\n                    </td>\r\n                    <td>\r\n                        <a ng-click=openParent(file,$event)>\r\n                            {{file.fullName.split(\'/\').slice(0,-1).join("/")}}\r\n                        </a>\r\n                    </td>\r\n                    <td>{{file.size | formatSize}}</td>\r\n                    <td>\r\n                        <img ng-if=file.creationBy ng-src="{{file.deleteBy.avatar | resource}}" class=img-circle style=height:30px;float:left alt=...>\r\n                        <span class=m-l-xs>{{file.deleteBy.name}}</span>\r\n                    </td>\r\n                    <td>{{file.deleteDate}}</td>\r\n                </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n        <div ng-if="mode == \'block\'">\r\n            <ul class=file-block-list>\r\n                <li class=file-block ng-class="{true:\'active\'}[file.selected]" ng-click=select(file,null,$event) ng-dblclick=open(file,$event); ng-repeat="file in files|orderBy:sortField:sortDesc | filter:{name:condition}">\r\n                    <img class=file-icon ng-src={{getIcon(file)}}>\r\n                    <div class="file-name text-ellipsis m-t-sm" tooltip={{file.name}} tooltip-placement=bottom>\r\n                        {{file.name}}\r\n                    </div>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n        <div class="wrapper-xl text-center" ng-show=loading>\r\n            <img ng-src="{{\'asset/img/loading.gif\' | resource}}">\r\n            <p class=m-t-sm>正在加载</p>\r\n        </div>\r\n        <div class="wrapper-xl text-center" ng-show="(files.length == 0 || !files) && !loading">\r\n            <i class="iconfont icon-empty"></i>\r\n            <p class=m-t-md>回收站中没有文件</p>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class="wrapper-xl text-center" ng-show=error>\r\n    <i class="iconfont icon-error"></i>\r\n    <p class=m-t-md>加载回收站失败：{{error}}</p>\r\n</div>\r\n'),t.put("asset/tpl/app/search.html",'<div class=app-ctrl style="padding-top:90px;overflow: hidden;padding-bottom: 42px" ng-show=!error>\r\n\t<div class="b-b app-title-fixed padder">\r\n\t\t<div class="row wrapper-xs b-b bg-light">\r\n\t\t\t<div class="col-sm-9 col-xs-9 padder-sm">\r\n          \t\t<span class="m-n directory-header text-md">\r\n          \t\t\t<i class="fa fa-search"></i>\r\n          \t\t\t"{{keyword}}" - 搜索结果\r\n          \t\t</span>\r\n          \t\t<span class="text-sm m-l-xs" ng-show="result.records.length > 0">\r\n\t\t\t\t\t( <span ng-show="selection.length > 0">{{selection.length}} / </span>{{files.length}} )\r\n\t\t\t\t</span>\r\n\t\t\t</div>\r\n\t\t\t<div class="col-sm-3 col-xs-3 padder-sm">\r\n\t\t\t\t<div class=pull-right>\r\n\t\t\t\t\t<button class="btn btn-md btn-default" ng-click=switchMode()>\r\n\t\t\t\t\t\t<i class=fa ng-class="{ true:\'fa-list\',false:\'fa-th\'}[mode == \'list\']"></i>\r\n\t\t\t\t\t\t<span ng-show="mode == \'list\'">列表视图</span> \r\n\t\t\t\t\t\t<span ng-show="mode == \'block\'">图标视图</span>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<div class=btn-group dropdown is-open=openSortmenu>\r\n\t\t\t\t\t\t<button type=button class="btn btn-md btn-default" ng-click=changeDesc();>\r\n\t\t\t\t\t\t\t<i ng-class="{\'fa-long-arrow-down\' : sortDesc,\'fa-long-arrow-up\':!sortDesc}" class=fa></i> \r\n\t\t\t\t\t\t\t<span ng-show="sortField == \'name\'">名称</span>\r\n\t\t\t\t\t\t\t<span ng-show="sortField == \'size\'">大小</span>\r\n\t\t\t\t\t\t\t<span ng-show="sortField == \'creationBy.name\'">创建者</span>\r\n\t\t\t\t\t\t\t<span ng-show="sortField == \'updateDate\'">时间</span>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<button type=button btn-md class="btn btn-md btn-default dropdown-toggle" dropdown-toggle>\r\n\t\t\t\t\t\t\t<span class=caret></span>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<ul class=dropdown-menu role=menu style="left: inherit; right: 0px">\r\n\t\t\t\t\t\t\t<li><a href ng-click="changeSort(\'name\')"> 名称 </a></li>\r\n\t\t\t\t\t\t\t<li><a href ng-click="changeSort(\'size\')"> 大小 </a></li>\r\n\t\t\t\t\t\t\t<li><a href ng-click="changeSort(\'creationBy.name\')"> 创建者 </a></li>\r\n\t\t\t\t\t\t\t<li><a href ng-click="changeSort(\'updateDate\')"> 时间 </a></li>\r\n\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="row wrapper-xs bg-light lter">\r\n\t\t\t<div class="col-sm-10 col-xs-10 padder-sm">\r\n\t\t\t\t<button class="btn btn-md btn-default" ng-click=open(selection[0],$event) ng-show="selection.length == 1 ">\r\n\t\t\t\t\t<i class="glyphicon glyphicon-new-window"></i> 打开文件\r\n\t\t\t\t</button>\r\n\t\t\t\t<button class="btn btn-md btn-default" ng-click=openParent(selection[0],$event) ng-show="selection.length == 1 ">\r\n\t\t\t\t\t<i class="fa fa-folder-open"></i> 打开所在文件夹\r\n\t\t\t\t</button>\r\n\t\t\t\t<button class="btn btn-md btn-default" ng-click=download() ng-show="selection.length > 0 ">\r\n\t\t\t\t\t<i class="glyphicon glyphicon-cloud-download"></i> 下载\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t\t<div class="col-sm-2 col-xs-2 text-right padder-sm">\r\n\t\t\t\t<div class="input-group-icon directory-search">\r\n\t\t\t\t\t<i class="glyphicon glyphicon-search input-icon"></i>\r\n\t\t\t\t\t<input ng-model=condition class="form-control input-sm rounded" placeholder=在结果中搜索>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class="bg-white app-inner">\r\n\t\t<div class="table-responsive file-list" ng-if="mode== \'list\'" ng-show="result.records.length > 0 && !loading">\r\n\t\t\t<table class="table b-b b-light lter file-table">\r\n\t\t\t\t<thead>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<th width=5%><label class="i-checks i-checks-sm m-b-none" ng-show=!condition>\r\n\t\t\t\t\t\t<input type=checkbox ng-click=selectAll() ng-checked=isSelectAll><i></i>\r\n\t\t\t\t\t</label></th>\r\n\t\t\t\t\t<th ng-click="changeSort(\'name\')">名称 <i ng-show="sortField == \'name\'" ng-class="{\'fa-caret-up\' : !sortDesc,\'fa-caret-down\':sortDesc}" class=fa> </i>\r\n\t\t\t\t\t</th>\r\n                    <th width=20%>\r\n                        路径\r\n                    </th>\r\n\t\t\t\t\t<th ng-click="changeSort(\'size\')" width=120px>大小 <i ng-show="sortField == \'size\'" ng-class="{\'fa-caret-up\' : !sortDesc,\'fa-caret-down\':sortDesc}" class=fa> </i>\r\n\t\t\t\t\t</th>\r\n\t\t\t\t\t<th ng-click="changeSort(\'creationBy.name\')" width=200px>创建者\r\n\t\t\t\t\t\t<i ng-show="sortField == \'creationBy.name\'" ng-class="{\'fa-caret-up\' : !sortDesc,\'fa-caret-down\':sortDesc}" class=fa> </i>\r\n\t\t\t\t\t</th>\r\n\t\t\t\t\t<th ng-click="changeSort(\'updateDate\')" width=200px>修改时间 <i ng-show="sortField == \'updateDate\'" ng-class="{\'fa-caret-up\' : !sortDesc,\'fa-caret-down\':sortDesc}" class=fa> </i>\r\n\t\t\t\t\t</th>\r\n\t\t\t\t</tr>\r\n\t\t\t\t</thead>\r\n\t\t\t\t<tbody>\r\n\t\t\t\t<tr ng-repeat="file in result.records | orderBy:sortFields:sortDesc | filter:{name:condition}" class="file-item hc-item" ng-class="{true:\'active\'}[file.selected]" valign=middle ng-click=select(file)>\r\n\t\t\t\t\t<td width=5%>\r\n\t\t\t\t\t\t<label class="i-checks i-checks-sm m-b-none">\r\n\t\t\t\t\t\t\t<input type=checkbox ng-checked=file.selected ng-click=select(file);><i></i>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td class=text-ellipsis>\r\n\t\t\t\t\t\t<a ng-click=open(file,$event);>\r\n\t\t\t\t\t\t\t<div class=file-icon-wrapper>\r\n\t\t\t\t\t\t\t\t<img class=file-icon ng-src={{getIcon(file)}}>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{{file.name}}\r\n\t\t\t\t\t\t</a>\r\n\t\t\t\t\t</td>\r\n                    <td>\r\n                        <a ng-click=openParent(file,$event)>\r\n                            {{file.fullName.split(\'/\').slice(0,-1).join("/")}}\r\n                        </a>\r\n                    </td>\r\n\t\t\t\t\t<td>{{file.size | formatSize}}</td>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<img ng-if=file.creationBy ng-src="{{file.creationBy.avatar | resource}}" class=img-circle style=height:30px;float:left alt=...>\r\n\t\t\t\t\t\t<span class=m-l-xs>{{file.creationBy.name}}</span>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td>{{file.updateDate}}</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t</tbody>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t\t<div ng-if="mode == \'block\'">\r\n\t\t\t<ul class=file-block-list>\r\n\t\t\t\t<li class=file-block ng-class="{true:\'active\'}[file.selected]" ng-click=select(file,null,$event) ng-dblclick=open(file,$event); ng-repeat="file in result.records|orderBy:sortField:sortDesc | filter:{name:condition}">\r\n\t\t\t\t\t<img class=file-icon ng-src={{getIcon(file)}}>\r\n\t\t\t\t\t<div class="file-name text-ellipsis m-t-sm" tooltip={{file.name}} tooltip-placement=bottom>{{file.name}}</div>\r\n\t\t\t\t</li>\r\n\t\t\t</ul>\r\n\t\t</div>\r\n\t\t<div class="wrapper-xl text-center" ng-show=loading>\r\n\t\t\t<img ng-src="{{\'asset/img/loading.gif\' | resource}}">\r\n\t\t\t<p class=m-t-sm>正在加载</p>\r\n\t\t</div>\r\n\t\t<div class="wrapper-xl text-center" ng-show="(result.records.length == 0 || !result.records) && !loading">\r\n            <i class="iconfont icon-empty"></i>\r\n\t\t\t<p class=m-t-md>没有搜索到与关键词匹配的文件</p>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class="pos-abt w-full b-t" style=bottom:0px ng-show="!error && result.total > 0 && !loading">\r\n\t\t\t\t<div class="col-sm-6 wrapper-xs">\r\n\t\t\t\t   <button class="btn btn-sm btn-link" ng-click=loadPage(1) ng-disabled="pagination.page == 1">\r\n\t\t\t\t\t\t<i class="fa fa-fast-backward"></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button class="btn btn-sm btn-link" ng-click="loadPage(pagination.page - 1)" ng-disabled="pagination.page == 1">\r\n\t\t\t\t\t\t<i class="fa fa-backward"></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<input class="inline form-control input-sm" style="width: 30px" ng-model-options="{ updateOn: \'blur\' }" ng-change=onPageChange(); ng-model=pagination.page>\r\n\t\t\t\t\t/\r\n\t\t\t\t\t<span>{{pagination.pages}}</span>\r\n\t\t\t\t\t<button class="btn btn-sm btn-link" ng-click="loadPage(pagination.page + 1)" ng-disabled="pagination.page == pagination.pages">\r\n\t\t\t\t\t\t<i class="fa fa-forward"></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button class="btn btn-sm btn-link" ng-click=loadPage(pagination.pages) ng-disabled="pagination.page == pagination.pages">\r\n\t\t\t\t\t\t<i class="fa fa-fast-forward"></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="col-sm-6 wrapper-xs text-right">\r\n\t\t\t\t\t<div style="line-height: 30px">共{{result.total}}条数据，每页显示\r\n\t\t\t\t\t<select class="form-control input-sm inline" style=width:65px ng-change=reload() ng-model=pagination.size>\r\n\t\t\t\t\t\t<option value=20>20</option>\r\n\t\t\t\t\t\t<option value=50>50</option>\r\n\t\t\t\t\t\t<option value=100>100</option>\r\n\t\t\t\t\t\t<option value=200>200</option>\r\n\t\t\t\t\t</select>\r\n\t\t\t\t\t条</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=clearfix></div>\r\n\t\t\t</div>\r\n</div>\r\n<div class="wrapper-xl text-center" ng-show=error>\r\n    <i class="iconfont icon-error"></i>\r\n    <p class=m-t-md>搜索文件失败：{{error}}</p>\r\n</div>\r\n'),t.put("asset/tpl/app/share.html",'<div class=m-c>\r\n\t<div class=modal-header>\r\n\t\t<button type=button class=close ng-click=close();>\r\n\t\t\t<span aria-hidden=true>×</span>\r\n\t\t</button>\r\n\t\t<h4 class=modal-title style="line-height: 34px">\r\n\t\t\t<i class="fa fa-share-alt"></i>\r\n\t\t\t分享文件\r\n\t\t</h4>\r\n\t</div>\r\n\t<div class=modal-body>\r\n\t\t<div class=row>\r\n\t\t\t<div class=col-sm-12>\r\n\t\t\t\t<form name=shareForm class="form-horizontal form-validation">\r\n\t\t\t        <div class=form-group>\r\n\t\t\t\t\t\t<label class="col-sm-2 control-label" style=padding-left:5px;padding-right:5px>分享链接：</label>\r\n\t\t\t\t\t\t<div class=col-sm-10>\r\n\t\t\t\t\t\t\t<div class=input-group>\r\n\t\t\t\t\t\t\t\t<span class=input-group-addon><i class="fa fa-link"></i></span>\r\n\t\t\t\t\t\t\t\t<textarea type=text name=link id=shareLink ng-model=link class=form-control readonly></textarea>\r\n\t\t\t\t\t\t\t\t<span class=input-group-btn>\r\n\t\t\t\t\t          </span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=form-group>\r\n\t\t\t\t\t\t<label class="col-sm-2 control-label" style=padding-left:5px;padding-right:5px>访问密码：</label>\r\n\t\t\t\t\t\t<div class=col-sm-10>\r\n\t\t\t\t\t\t\t<div class=input-group>\r\n\t\t\t\t\t\t\t\t<span class=input-group-addon><i class="glyphicon glyphicon-lock"></i></span>\r\n\t\t\t\t\t\t\t\t<input name=code ng-model=share.password class=form-control>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=form-group>\r\n\t\t\t\t\t\t<label class="col-sm-2 control-label" style=padding-left:5px;padding-right:5px>到期时间：</label>\r\n\t\t\t\t\t\t<div class=col-sm-10>\r\n\t\t\t\t\t\t\t<div class=input-group>\r\n\t\t\t\t\t\t\t\t<span class=input-group-addon><i class="fa fa-calendar"></i></span>\r\n\t\t\t\t\t            <input class=form-control ng-click="opened = true" date-format=YYYY-MM-DD ng-model=share.dueDate datepicker-popup=yyyy-MM-dd is-open=opened datepicker-options="{formatYear: \'yyyy\',class:\'datepicker\',showWeeks:false}" close-text=关闭 current-text=今天 clear-text=清除>\r\n\t\t\t\t\t        </div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class="alert alert-warning m-b-none">\r\n\t\t\t\t\t\t<p style="text-indent: 2em"><b>说明：</b>分享个人文档任何用户可以通过密码（如果有设置）进行访问，分享企业文档除密码之外（如果有设置）必须用户拥有权限才能访问。</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\t\r\n\t<div class=modal-footer>\r\n\t\t<button type=button class="btn btn-primary" ng-click=update() ng-disabled="!shareForm.$dirty || saving">\r\n\t\t\t<span ng-show=!saving>提交</span>\r\n\t\t\t<span ng-show=saving>正在提交...</span>\r\n\t\t</button>\r\n\t\t<button type=button class="btn btn-primary" ng-click=remove() ng-disabled="deleting || !share">\r\n\t\t\t<span ng-show=!deleting>删除分享</span>\r\n\t\t\t<span ng-show=deleting>正在删除...</span>\r\n\t\t</button>\r\n\t\t<button class="btn btn-default" type=button ng-click=copy();> <i class="fa fa-copy"></i> 复制链接 </button>\r\n\t\t<button type=button class="btn btn-default" ng-click=close()>关闭</button>\r\n\t</div>\r\n</div>'),t.put("asset/tpl/app/shares.html",'<div class="wrapper-xl text-center">\r\n\t<i class="iconfont icon-info"></i>\r\n\t<p class=m-t-md>非常抱歉，社区版暂不支持此功能</p>\r\n</div>\r\n'),t.put("asset/tpl/app/tags.html",'<div class=m-c>\r\n\t<div class=modal-header>\r\n\t\t<h4 class=modal-title>\r\n\t\t\t<i class="fa fa-tags"></i> 设置标签\r\n\t\t\t\t\t<button type=button class=close ng-click=cancel();>×</button>\r\n\t\t</h4>\r\n\t</div>\r\n\t<div class="modal-body no-padder">\r\n\t\t<div class="wrapper-md clearfix" ng-show="tags.length > 0">\r\n\t\t\t<div class="i-tag i-tag-close" ng-repeat="tag in tags track by $index">\r\n\t\t\t\t<span>{{tag}}</span>\r\n\t\t\t\t<a href=javascript:void(0); class=close ng-click=remove(tag)>×</a>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="wrapper-md text-center" ng-show="tags.length == 0">\r\n\t\t\t没有设置标签\r\n\t\t</div>\r\n\t\t<div class="wrapper-md b-t">\r\n\t\t\t<form name=tagForm class="form-horizontal form-validation">\r\n\t\t\t\t<div class=input-group>\r\n\t\t\t\t  <span class=input-group-addon>添加标签</span>\r\n\t\t          <input class=form-control ng-model=tag placeholder=标签长度200个字内>\r\n\t\t          <div class=input-group-btn>\r\n\t\t            <button type=button class="btn btn-default" ng-diabled=tag ng-click=add();>\r\n\t\t            \t<i class="glyphicon glyphicon-ok"></i>\r\n\t\t            </button>\r\n\t\t          </div>\r\n\t\t        </div>\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("asset/tpl/app/user_select.html",'<div class=m-c>\r\n\t<div class=modal-header>\r\n\t\t<div class="pull-right col-md-6 no-padder">\r\n\t\t\t<div class=input-group>\r\n\t\t          <input class=form-control ng-model=condition placeholder=搜索:用户名/姓名/拼音>\r\n\t\t          <div class=input-group-btn>\r\n\t\t            <button type=button class="btn btn-default" ng-show=condition ng-click=clear();>\r\n\t\t            \t<i class="glyphicon glyphicon-remove"></i>\r\n\t\t            </button>\r\n\t\t            <button type=button class="btn btn-default" ng-click=search();>\r\n\t\t\t\t\t\t<i class="glyphicon glyphicon-search"></i>\r\n\t\t\t\t\t</button>\r\n\t\t          </div>\r\n\t\t        </div>\r\n\t\t</div>\r\n\t\t<h4 class=modal-title style="line-height: 34px">\r\n\t\t\t<i class="fa fa-user"></i>\r\n\t\t\t选择同事\r\n\t\t</h4>\r\n\t\t\r\n\t</div>\r\n\t<div class="modal-body no-padder">\r\n\t\t<div class=permission-user-body ng-show=!searching>\r\n\t\t\t<div class="col-sm-6 permission-user-part b-r wrapper-sm">\r\n\t\t\t\t<hc-tree tree-control=tree load-asyn=true on-init=onTreeInit() open-folder-icon="fa fa-users" folder-icon="fa fa-users" leaf-icon="fa fa-users" on-selection-change=loadUser(selection); load-url=/department/list></hc-tree>\r\n\t\t\t</div>\r\n\t\t\t<div class="col-sm-6 permission-user-part wrapper-sm">\r\n\t\t\t\t<div class="wrapper-xl text-center" ng-show=loading>\r\n\t\t\t\t\t<img src=asset/img/loading.gif>\r\n\t\t\t\t\t<p class=m-t-sm>正在加载</p>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div ng-repeat="user in users" class="wrapper-xs hover-bg" ng-show=!loading ng-click=select(user);>\r\n\t\t\t\t\t<img ng-src="{{user.avatar | resource}}" class=img-circle style=height:30px alt=...>\r\n\t\t\t\t\t<span class=m-l-sm style="line-height: 30px">{{user.name}}</span>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t\t<div class="permission-user-body wrapper-sm" ng-show=searching>\r\n\t\t\t\t<div class="col-md-4 wrapper-xs hover-bg" ng-repeat="user in result" ng-click=select(user);>\r\n\t\t\t\t\t<img ng-src="{{user.avatar | resource}}" class="img-circle pull-left" style=height:50px alt=...>\r\n\t\t\t\t\t<div class=inline>\r\n\t\t\t\t\t\t<span class=m-l-sm style="line-height: 30px">{{user.name}}</span>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<span class=m-l-sm style="line-height: 20px;font-size:12px;color:#bbb">{{user.department.name}}</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t    <div class=col-sm-12 ng-show="result.length == 0">\r\n\t\t\t    \t<div class="wrapper-xs text-center">\r\n\t\t\t\t\t\t<i class="iconfont icon-empty"></i>\r\n\t\t\t\t\t\t<p class=m-t-sm>没有搜索到用户</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="col-sm-12 permission-user-part" ng-show=loading>\r\n\t\t\t\t\t<div class="wrapper-xl text-center">\r\n\t\t\t\t\t<img ng-src="{{\'asset/img/loading.gif\' | resource}}">\r\n\t\t\t\t\t<p class=m-t-sm>正在加载</p>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="wrapper-sm b-t" ng-hide="selected.length == 0">\r\n\t\t\t<div class="permission-user-selected wrapper-sm text-center inline hover-bg" ng-repeat="user in selected">\r\n\t\t\t\t<button type=button class=close ng-click=remove(user)>\r\n\t\t\t\t\t<span aria-hidden=true>×</span>\r\n\t\t\t\t</button>\r\n\t\t\t\t<img ng-src="{{user.avatar | resource}}" class=img-circle style=height:35px alt=...>\r\n\t\t\t\t<div class="text-ellipsis m-t-xs" style="font-size: 12px">{{user.name}}</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class=modal-footer>\r\n\t\t<button type=button class="btn btn-primary" ng-click=ok() style="margin-left: 5px" ng-disabled="selected.length == 0">\r\n\t\t\t确定\r\n\t\t</button>\r\n\t\t<button type=button class="btn btn-default" ng-click=close()>取消</button>\r\n\t</div>\r\n</div>')}]);